!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof window?window.XMPP=e():"undefined"!=typeof global?global.XMPP=e():"undefined"!=typeof self&&(self.XMPP=e())}(function(){var e;return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,t,n){n.Message=e("./lib/stanza/message"),n.Presence=e("./lib/stanza/presence"),n.Iq=e("./lib/stanza/iq"),n.Client=e("./lib/client"),n.crypto=e("crypto"),n.createClient=function(t){var r=new n.Client(t);return r.use(e("./lib/plugins/disco")),r.use(e("./lib/plugins/chatstates")),r.use(e("./lib/plugins/delayed")),r.use(e("./lib/plugins/forwarding")),r.use(e("./lib/plugins/carbons")),r.use(e("./lib/plugins/time")),r.use(e("./lib/plugins/mam")),r.use(e("./lib/plugins/receipts")),r.use(e("./lib/plugins/idle")),r.use(e("./lib/plugins/correction")),r.use(e("./lib/plugins/attention")),r.use(e("./lib/plugins/version")),r.use(e("./lib/plugins/invisible")),r.use(e("./lib/plugins/muc")),r.use(e("./lib/plugins/pubsub")),r.use(e("./lib/plugins/avatar")),r.use(e("./lib/plugins/private")),r.use(e("./lib/plugins/bookmarks")),r.use(e("./lib/plugins/jingle")),r.use(e("./lib/plugins/json")),r.use(e("./lib/plugins/hashes")),r}},{"./lib/client":2,"./lib/plugins/attention":4,"./lib/plugins/avatar":5,"./lib/plugins/bookmarks":6,"./lib/plugins/carbons":7,"./lib/plugins/chatstates":8,"./lib/plugins/correction":9,"./lib/plugins/delayed":10,"./lib/plugins/disco":11,"./lib/plugins/forwarding":12,"./lib/plugins/hashes":13,"./lib/plugins/idle":14,"./lib/plugins/invisible":15,"./lib/plugins/jingle":16,"./lib/plugins/json":17,"./lib/plugins/mam":18,"./lib/plugins/muc":19,"./lib/plugins/private":20,"./lib/plugins/pubsub":21,"./lib/plugins/receipts":22,"./lib/plugins/time":23,"./lib/plugins/version":24,"./lib/stanza/iq":38,"./lib/stanza/message":42,"./lib/stanza/presence":44,crypto:72}],2:[function(e,t){function n(e){var t=this;r.call(this),e=e||{},this.config=i.extend({useStreamManagement:!0,transport:"websocket"},e),this.jid=new p,this._idPrefix=s.v4(),this._idCount=0,this.timeoutMonitor=null,this.negotiatedFeatures={},this.featureOrder=["sasl","streamManagement","bind","streamManagement","session"],this.features={},this.transport=new d,this.transport.on("*",function(e,n){t.emit(e,n)}),this.on("streamFeatures",function(e){var n=[function(t){t(null,e)}],r=["setup"];t.featureOrder.forEach(function(i){e._extensions[i]&&!t.negotiatedFeatures[i]&&(n.push(function(e,n){!t.negotiatedFeatures[i]&&t.features[i]?t.features[i](e,n):n(null,e)}),r.push(i))}),o.waterfall(n,function(e){"restart"===e?t.transport.restart():"disconnect"===e&&t.disconnect()})}),this.features.sasl=function(e,n){var r=m.create(e.sasl.mechanisms);t.on("sasl:success","sasl",function(){t.negotiatedFeatures.sasl=!0,t.releaseGroup("sasl"),t.emit("auth:success"),n("restart")}),t.on("sasl:challenge","sasl",function(e){r.challenge(e.value),t.send(new u.Response({value:r.response(t.getCredentials())})),r.cache&&(i.each(r.cache,function(e,n){t.config.credentials[n]=btoa(e)}),t.emit("credentials:update",t.config.credentials)),n()}),t.on("sasl:failure","sasl",function(){t.releaseGroup("sasl"),t.emit("auth:failed"),n("disconnect")}),t.on("sasl:abort","sasl",function(){t.releaseGroup("sasl"),t.emit("auth:failed"),n("disconnect")});var o={mechanism:r.name};r.clientFirst&&(o.value=r.response(t.getCredentials())),t.send(new u.Auth(o))},this.features.bind=function(e,n){t.sendIq({type:"set",bind:{resource:t.config.resource}},function(r,i){t.negotiatedFeatures.bind=!0,t.emit("session:bound",i.bind.jid),t.jid=new p(i.bind.jid),e._extensions.session||(t.sessionStarted=!0,t.emit("session:started",i.bind.jid)),n(null,e)})},this.features.session=function(e,n){t.sendIq({type:"set",session:{}},function(){t.negotiatedFeatures.session=!0,t.sessionStarted=!0,t.emit("session:started",t.jid),n(null,e)})},this.features.streamManagement=function(e,n){return t.config.useStreamManagement?(t.on("stream:management:enabled","sm",function(r){t.transport.sm.enabled(r),t.negotiatedFeatures.streamManagement=!0,t.on("stream:management:ack","connection",function(e){t.transport.sm.process(e)}),t.on("stream:management:request","connection",function(){t.transport.sm.ack()}),t.releaseGroup("sm"),n(null,e)}),t.on("stream:management:resumed","sm",function(r){t.transport.sm.enabled(r),t.negotiatedFeatures.streamManagement=!0,t.negotiatedFeatures.bind=!0,t.sessionStarted=!0,t.on("stream:management:ack","connection",function(e){t.transport.sm.process(e)}),t.on("stream:management:request","connection",function(){t.transport.sm.ack()}),t.releaseGroup("sm"),n(null,e)}),t.on("stream:management:failed","sm",function(){t.transport.sm.failed(),t.emit("session:end"),t.releaseGroup("session"),t.releaseGroup("sm"),n(null,e)}),t.transport.sm.id?t.transport.sm.id&&t.transport.sm.allowResume?t.transport.resume():n(null,e):t.negotiatedFeatures.bind?t.transport.sm.enable():n(null,e),void 0):n(null,e)},this.on("disconnected",function(){t.sessionStarted=!1,t.negotiatedFeatures.sasl=!1,t.negotiatedFeatures.streamManagement=!1,t.negotiatedFeatures.bind=!1,t.negotiatedFeatures.session=!1,t.releaseGroup("connection")}),this.on("iq:set:roster",function(e){t.emit("roster:update",e),t.sendIq({id:e.id,type:"result"})}),this.on("iq",function(e){var n=e.type,r=Object.keys(e._extensions),o=e.xml.childNodes,s=0;if(i.each(o,function(e){1===e.nodeType&&(s+=1)}),"get"===e.type||"set"===e.type){if(1!=s)return t.sendIq(e.errorReply({error:{type:"modify",condition:"bad-request"}}));if(!r.length)return t.sendIq(e.errorReply({error:{type:"cancel",condition:"feature-not-implemented"}}));var a="iq:"+n+":"+r[0];t.callbacks[a]?t.emit(a,e):t.sendIq(e.errorReply({error:{type:"cancel",condition:"feature-not-implemented"}}))}}),this.on("message",function(e){Object.keys(e.$body).length&&("chat"===e.type||"normal"===e.type?t.emit("chat",e):"groupchat"===e.type&&t.emit("groupchat",e))}),this.on("presence",function(e){var n=e.type||"available";t.emit(n,e)})}var r=e("wildemitter"),i=e("underscore"),o=e("async"),s=e("node-uuid"),a=e("paddle"),u=e("./stanza/sasl"),c=e("./stanza/message"),l=e("./stanza/presence"),f=e("./stanza/iq"),p=e("./jid"),d=e("./websocket"),h=e("hostmeta"),m=e("saslmechanisms");m=new m,m.use(e("sasl-external")),m.use(e("sasl-scram-sha-1")),m.use(e("sasl-digest-md5")),m.use(e("sasl-plain")),m.use(e("sasl-anonymous")),e("./stanza/stream"),e("./stanza/sm"),e("./stanza/roster"),e("./stanza/error"),e("./stanza/streamError"),e("./stanza/streamFeatures"),e("./stanza/bind"),e("./stanza/session"),n.prototype=Object.create(r.prototype,{constructor:{value:n}}),n.prototype.__defineGetter__("stream",function(){return this.transport?this.transport.stream:void 0}),n.prototype.use=function(e){e(this)},n.prototype.nextId=function(){return this._idPrefix+"-"+(this._idCount++).toString(16)},n.prototype.discoverBindings=function(e,t){h(e,function(e,n){if(e)return t(e,[]);var r=[],i=n.links||[];i.forEach(function(e){e.href&&"urn:xmpp:altconnect:websocket"===e.rel&&r.push(e.href)}),t(!1,r)})},n.prototype.getCredentials=function(){var e=this.config.credentials||{},t=new p(this.config.jid),n=e.username||t.local,r=e.server||t.domain,o={username:n,password:this.config.password,server:r,host:r,realm:r,serviceType:"xmpp",serviceName:r},s=i.extend(o,e),a=["saltedPassword","clientKey","serverKey"];return a.forEach(function(e){s[e]&&(s[e]=atob(s[e]))}),s},n.prototype.connect=function(e){var t=this;return i.extend(t.config,e||{}),t.timeoutMonitor||(t.timeoutMonitor=new a.Paddle(t.config.timeout||15),t.timeoutMonitor.start()),t.config.wsURL?t.transport.connect(t.config):(t.discoverBindings(t.config.server,function(e,n){!e&&n.length?(t.config.wsURL=n[0],t.transport.connect(t.config)):t.disconnect()}),void 0)},n.prototype.disconnect=function(){this.timeoutMonitor&&(this.timeoutMonitor.stop(),this.timeoutMonitor=null),this.sessionStarted&&(this.emit("session:end"),this.releaseGroup("session")),this.sessionStarted=!1,this.releaseGroup("connection"),this.transport&&this.transport.disconnect()},n.prototype.send=function(e){this.transport.send(e)},n.prototype.sendMessage=function(e){e=e||{},e.id||(e.id=this.nextId());var t=new c(e);return this.emit("message:sent",t),this.send(t),e.id},n.prototype.sendPresence=function(e){return e=e||{},e.id||(e.id=this.nextId()),this.send(new l(e)),e.id},n.prototype.sendIq=function(e,t){var n=this;e=e||{},t=t||function(){},e.id||(e.id=this.nextId());var r=!1,i=function(e,n){r||(r=!0,t(e,n))};if("get"===e.type||"set"===e.type){var o=this.timeoutMonitor.insure(function(){i({type:"error",error:{condition:"timeout"}},null)}),s=new p(e.to),a={};a[""]=!0,a[s.full]=!0,a[s.bare]=!0,a[s.domain]=!0,a[n.jid.bare]=!0,a[n.jid.domain]=!0;var u=function(t){var r=t.from;a[r.full]&&(o.check_in(),n.off("id:"+e.id,u),t._extensions.error?i(t,null):i(null,t))};this.on("id:"+e.id,"session",u)}return e.toJSON||(e=new f(e)),this.send(e),e.id},n.prototype.getRoster=function(e){var t=this;e=e||function(){},this.sendIq({type:"get",roster:{ver:t.config.rosterVer}},function(n,r){return n?e(n):("result"===r.type&&r.roster.ver&&(t.config.rosterVer=r.roster.ver,t.emit("roster:ver",r.roster.ver)),e(null,r),void 0)})},n.prototype.updateRosterItem=function(e,t){this.sendIq({type:"set",roster:{items:[e]}},t)},n.prototype.removeRosterItem=function(e,t){this.updateRosterItem({jid:e,subscription:"remove"},t)},n.prototype.subscribe=function(e){this.sendPresence({type:"subscribe",to:e})},n.prototype.unsubscribe=function(e){this.sendPresence({type:"unsubscribe",to:e})},n.prototype.acceptSubscription=function(e){this.sendPresence({type:"subscribed",to:e})},n.prototype.denySubscription=function(e){this.sendPresence({type:"unsubscribed",to:e})},n.prototype.JID=function(e){return new p(e)},t.exports=n},{"./jid":3,"./stanza/bind":27,"./stanza/error":35,"./stanza/iq":38,"./stanza/message":42,"./stanza/presence":44,"./stanza/roster":48,"./stanza/sasl":51,"./stanza/session":52,"./stanza/sm":53,"./stanza/stream":54,"./stanza/streamError":55,"./stanza/streamFeatures":56,"./websocket":61,async:62,hostmeta:77,"node-uuid":105,paddle:106,"sasl-anonymous":108,"sasl-digest-md5":110,"sasl-external":112,"sasl-plain":114,"sasl-scram-sha-1":116,saslmechanisms:118,underscore:119,wildemitter:120}],3:[function(e,t){function n(e){e=e||"","string"==typeof e?(this.jid=e,this.parts={}):(this.jid=e.jid,this.parts=e.parts)}n.prototype={constructor:{value:n},toString:function(){return this.jid},get full(){return this.jid},get bare(){if(this.parts.bare)return this.parts.bare;var e=this.jid.indexOf("/");return this.parts.bare=e>0?this.jid.slice(0,e):this.jid,this.parts.bare},get resource(){if(this.parts.resource)return this.parts.resource;var e=this.jid.indexOf("/");return this.parts.resource=e>0?this.jid.slice(e+1):"",this.parts.resource},get local(){if(this.parts.local)return this.parts.local;var e=this.bare,t=e.indexOf("@");return this.parts.local=t>0?e.slice(0,t):e,this.parts.local},get domain(){if(this.parts.domain)return this.parts.domain;var e=this.bare,t=e.indexOf("@");return this.parts.domain=t>0?e.slice(t+1):e,this.parts.domain}},t.exports=n},{}],4:[function(e,t){t.exports=function(e){e.disco.addFeature("urn:xmpp:attention:0"),e.getAttention=function(t,n){n=n||{},n.to=t,n.type="headline",n.attention=!0,e.sendMessage(n)},e.on("message",function(t){t._extensions._attention&&e.emit("attention",t)})}},{}],5:[function(e,t){e("../stanza/avatar"),t.exports=function(e){e.disco.addFeature("urn:xmpp:avatar:metadata+notify"),e.on("pubsubEvent",function(t){t.event._extensions.updated&&"urn:xmpp:avatar:metadata"===t.event.updated.node&&e.emit("avatar",{jid:t.from,avatars:t.event.updated.published[0].avatars})}),e.publishAvatar=function(t,n,r){e.publish("","urn:xmpp:avatar:data",{id:t,avatarData:n},r)},e.useAvatars=function(t,n){e.publish("","urn:xmpp:avatar:metadata",{id:"current",avatars:t},n)},e.getAvatar=function(t,n,r){e.getItem(t,"urn:xmpp:avatar:data",n,r)}}},{"../stanza/avatar":26}],6:[function(e,t){e("../stanza/bookmarks"),t.exports=function(e){e.getBookmarks=function(e){this.getPrivateData({bookmarks:{}},e)},e.setBookmarks=function(e,t){this.setPrivateData({bookmarks:e},t)}}},{"../stanza/bookmarks":28}],7:[function(e,t){e("../stanza/carbons"),t.exports=function(e){e.disco.addFeature("urn:xmpp:carbons:2"),e.enableCarbons=function(e){this.sendIq({type:"set",enableCarbons:!0},e)},e.disableCarbons=function(e){this.sendIq({type:"set",disableCarbons:!0},e)},e.on("message",function(t){return t._extensions.carbonSent?e.emit("carbon:sent",t):t._extensions.carbonReceived?e.emit("carbon:received",t):void 0})}},{"../stanza/carbons":30}],8:[function(e,t){e("../stanza/chatstates"),t.exports=function(e){e.disco.addFeature("http://jabber.org/protocol/chatstates"),e.on("message",function(t){t.chatState&&e.emit("chatState",{to:t.to,from:t.from,chatState:t.chatState})})}},{"../stanza/chatstates":31}],9:[function(e,t){t.exports=function(e){e.disco.addFeature("urn:xmpp:message-correct:0"),e.on("message",function(t){t.replace&&(e.emit("replace",t),e.emit("replace:"+t.id,t))})}},{}],10:[function(e,t){e("../stanza/delayed"),t.exports=function(e){e.disco.addFeature("urn:xmpp:delay")}},{"../stanza/delayed":33}],11:[function(e,t){function n(e,t,n){"sha-1"===t&&(t="sha1");var i=r(e,t);return i&&i==n}function r(e,t){var n="",r=e.features.sort(),i=[],u={},c=[];o.forEach(e.identities,function(e){i.push([e.category||"",e.type||"",e.lang||"",e.name||""].join("/"))});var l=i.length,f=r.length;if(i=o.unique(i,!0),r=o.unique(r,!0),f!=r.length||l!=i.length)return!1;n+=i.join("<")+"<",n+=r.join("<")+"<";var p=!1;if(o.forEach(e.extensions,function(e){for(var t=e.fields,n=0,r=t.length;r>n;n++)if("FORM_TYPE"==t[n].name&&"hidden"==t[n].type){var i=t[n].value;return u[i]?(p=!0,void 0):(u[i]=e,c.push(i),void 0)}}),p)return!1;c.sort(),o.forEach(c,function(e){var t=u[e],r={},i=[];n+="<"+e,o.forEach(t.fields,function(e){var t=e.name;if("FORM_TYPE"!=t){var n=e.value||"";"object"!=typeof n&&(n=n.split("\n")),r[t]=n.sort(),i.push(t)}}),i.sort(),o.forEach(i,function(e){n+="<"+e,o.forEach(r[e],function(e){n+="<"+e})})}),"sha-1"===t&&(t="sha1");var d=s.createHash(t).update(a.encode(n)).digest("base64"),h=4-d.length%4;4===h&&(h=0);for(var m=0;h>m;m++)d+="=";return d}function i(){this.features={},this.identities={},this.extensions={},this.items={},this.caps={}}var o=e("underscore"),s=e("crypto");e("../stanza/disco"),e("../stanza/caps");var a={encode:function(e){return unescape(encodeURIComponent(e))},decode:function(e){return decodeURIComponent(escape(e))}};i.prototype={constructor:{value:i},addFeature:function(e,t){t=t||"",this.features[t]||(this.features[t]=[]),this.features[t].push(e)},addIdentity:function(e,t){t=t||"",this.identities[t]||(this.identities[t]=[]),this.identities[t].push(e)},addItem:function(e,t){t=t||"",this.items[t]||(this.items[t]=[]),this.items[t].push(e)},addExtension:function(e,t){t=t||"",this.extensions[t]||(this.extensions[t]=[]),this.extensions[t].push(e)}},t.exports=function(e){e.disco=new i(e),e.disco.addFeature("http://jabber.org/protocol/disco#info"),e.disco.addIdentity({category:"client",type:"web"}),e.getDiscoInfo=function(e,t,n){this.sendIq({to:e,type:"get",discoInfo:{node:t}},n)},e.getDiscoItems=function(e,t,n){this.sendIq({to:e,type:"get",discoItems:{node:t}},n)},e.updateCaps=function(){var t=this.config.capsNode||"https://stanza.io",n=JSON.parse(JSON.stringify({identities:this.disco.identities[""],features:this.disco.features[""],extensions:this.disco.extensions[""]})),i=r(n,"sha-1");return this.disco.caps={node:t,hash:"sha-1",ver:i},t=t+"#"+i,this.disco.features[t]=n.features,this.disco.identities[t]=n.identities,this.disco.extensions[t]=n.extensions,e.getCurrentCaps()},e.getCurrentCaps=function(){var t=e.disco.caps;if(!t.ver)return{ver:null,discoInfo:null};var n=t.node+"#"+t.ver;return{ver:t.ver,discoInfo:{identities:e.disco.identities[n],features:e.disco.features[n],extensions:e.disco.extensions[n]}}},e.on("presence",function(t){t._extensions.caps&&e.emit("disco:caps",t)}),e.on("iq:get:discoInfo",function(t){var n=t.discoInfo.node,r=t.discoInfo.node;n===e.disco.caps.node+"#"+e.disco.caps.ver&&(r=n,n=""),e.sendIq(t.resultReply({discoInfo:{node:r,identities:e.disco.identities[n]||[],features:e.disco.features[n]||[],extensions:e.disco.extensions[n]||[]}}))}),e.on("iq:get:discoItems",function(t){var n=t.discoInfo.node;e.sendIq(t.resultReply({discoItems:{node:n,items:e.disco.items[n]||[]}}))}),e.verifyVerString=n,e.generateVerString=r}},{"../stanza/caps":29,"../stanza/disco":34,crypto:72,underscore:119}],12:[function(e,t){e("../stanza/forwarded"),t.exports=function(e){e.disco.addFeature("urn:xmpp:forward:0")}},{"../stanza/forwarded":36}],13:[function(e,t){t.exports=function(e){e.disco.addFeature("urn:xmpp:hashes:1"),e.disco.addFeature("urn:xmpp:hash-function-text-names:md5"),e.disco.addFeature("urn:xmpp:hash-function-text-names:sha-1"),e.disco.addFeature("urn:xmpp:hash-function-text-names:sha-256")}},{}],14:[function(e,t){t.exports=function(e){e.disco.addFeature("urn:xmpp:idle:0")}},{}],15:[function(e,t){e("../stanza/visibility"),t.exports=function(e){e.goInvisible=function(){this.sendIq({type:"set",invisible:!0})},e.goVisible=function(){this.sendIq({type:"set",visible:!0})}}},{"../stanza/visibility":60}],16:[function(e,t){var n=e("jingle");e("../stanza/jingle"),e("../stanza/rtp"),e("../stanza/iceUdp"),t.exports=function(e){var t=e.jingle=new n;t.capabilities.forEach(function(t){e.disco.addFeature(t)});var r=["outgoing","incoming","accepted","terminated","ringing","mute","unmute","hold","resumed"];r.forEach(function(n){t.on(n,function(t,r){e.emit("jingle:"+n,t,r)})}),t.on("localStream",function(t){e.emit("jingle:localstream:added",t)}),t.on("localStreamStopped",function(){e.emit("jingle:localstream:removed")}),t.on("peerStreamAdded",function(t){e.emit("jingle:remotestream:added",t)}),t.on("peerStreamRemoved",function(t){e.emit("jingle:remotestream:removed",t)}),t.on("send",function(t){e.sendIq(t)}),e.on("iq:set:jingle",function(e){e=e.toJSON(),t.process(e)}),e.on("unavailable",function(e){var n=e.from.full;t.endPeerSessions(n)}),e.call=function(n){n=n.full||n;var r=t.createMediaSession(n);return e.sendPresence({to:n}),r.start(),r}}},{"../stanza/iceUdp":37,"../stanza/jingle":39,"../stanza/rtp":50,jingle:80}],17:[function(e,t){e("../stanza/json"),t.exports=function(e){e.disco.addFeature("urn:xmpp:json:tmp")}},{"../stanza/json":40}],18:[function(e,t){e("../stanza/mam"),t.exports=function(e){e.disco.addFeature("urn:xmpp:mam:tmp"),e.getHistory=function(e,t){var n=this,r=this.nextId();e=e||{},e.queryid=r;var i=[];this.on("mam:"+r,"session",function(e){i.push(e)}),t=t||function(){},this.sendIq({type:"get",id:r,mamQuery:e},function(e,o){e?t(e):(n.off("mam:"+r),o.mamQuery.results=i,t(null,o))})},e.getHistoryPreferences=function(t){e.sendIq({type:"get",mamPrefs:{}},t)},e.setHistoryPreferences=function(t,n){e.sendIq({type:"set",mamPrefs:t},n)},e.on("message",function(t){t._extensions.mam&&e.emit("mam:"+t.mam.queryid,t)})}},{"../stanza/mam":41}],19:[function(e,t){e("../stanza/muc"),t.exports=function(e){e.joinRoom=function(e,t,n){n=n||{},n.to=e+"/"+t,n.caps=this.disco.caps,n.joinMuc=n.joinMuc||{},this.sendPresence(n)},e.leaveRoom=function(e,t,n){n=n||{},n.to=e+"/"+t,n.type="unavailable",this.sendPresence(n)}}},{"../stanza/muc":43}],20:[function(e,t){e("../stanza/private"),t.exports=function(e){e.getPrivateData=function(e,t){this.sendIq({type:"get",privateStorage:e},t)},e.setPrivateData=function(e,t){this.sendIq({type:"set",privateStorage:e},t)}}},{"../stanza/private":45}],21:[function(e,t){e("../stanza/pubsub"),t.exports=function(e){e.on("message",function(t){t._extensions.event&&e.emit("pubsubEvent",t)}),e.subscribeToNode=function(t,n,r){e.sendIq({type:"set",to:t,pubsub:{subscribe:{node:n.node,jid:n.jid||e.jid}}},r)},e.unsubscribeFromNode=function(t,n,r){e.sendIq({type:"set",to:t,pubsub:{unsubscribe:{node:n.node,jid:n.jid||e.jid.split("/")[0]}}},r)},e.publish=function(t,n,r,i){e.sendIq({type:"set",to:t,pubsub:{publish:{node:n,item:r}}},i)},e.getItem=function(t,n,r,i){e.sendIq({type:"get",to:t,pubsub:{retrieve:{node:n,item:r}}},i)},e.getItems=function(t,n,r,i){r=r||{},r.node=n,e.sendIq({type:"get",to:t,pubsub:{retrieve:{node:n,max:r.max},rsm:r.rsm}},i)},e.retract=function(t,n,r,i,o){e.sendIq({type:"set",to:t,pubsub:{retract:{node:n,notify:i,id:r}}},o)},e.purgeNode=function(t,n,r){e.sendIq({type:"set",to:t,pubsubOwner:{purge:n}},r)},e.deleteNode=function(t,n,r){e.sendIq({type:"set",to:t,pubsubOwner:{del:n}},r)},e.createNode=function(t,n,r,i){var o={type:"set",to:t,pubsubOwner:{create:n}};r&&(o.pubsubOwner.config={form:r}),e.sendIq(o,i)}}},{"../stanza/pubsub":46}],22:[function(e,t){e("../stanza/receipts"),t.exports=function(e){e.disco.addFeature("urn:xmpp:receipts"),e.on("message",function(t){var n={normal:!0,chat:!0,headline:!0};n[t.type]&&t.requestReceipt&&!t._extensions.receipt&&e.sendMessage({to:t.from,receipt:{id:t.id},id:t.id}),t._extensions.receipt&&e.emit("receipt:"+t.receipt.id)})}},{"../stanza/receipts":47}],23:[function(e,t){e("../stanza/time"),t.exports=function(e){e.disco.addFeature("urn:xmpp:time"),e.getTime=function(e,t){this.sendIq({to:e,type:"get",time:!0},t)},e.on("iq:get:time",function(t){var n=new Date;e.sendIq(t.resultReply({time:{utc:n,tzo:n.getTimezoneOffset()}}))})}},{"../stanza/time":57}],24:[function(e,t){e("../stanza/version"),t.exports=function(e){e.disco.addFeature("jabber:iq:version"),e.on("iq:get:version",function(t){e.sendIq(t.resultReply({version:e.config.version||{name:"stanza.io"}}))}),e.getSoftwareVersion=function(e,t){this.sendIq({to:e,type:"get",version:{}},t)}}},{"../stanza/version":59}],25:[function(e,t){function n(e,t){return(e%t+t)%t}function r(e){this.conn=e,this.id=!1,this.allowResume=!0,this.started=!1,this.lastAck=0,this.handled=0,this.windowSize=1,this.unacked=[],this.pendingAck=!1}var i=e("./stanza/sm"),o=Math.pow(2,32);r.prototype={constructor:{value:r},enable:function(){var e=new i.Enable;e.resume=this.allowResume,this.conn.send(e),this.handled=0,this.started=!0},resume:function(){var e=new i.Resume({h:this.handled,previd:this.id});this.conn.send(e),this.started=!0},enabled:function(e){this.id=e.id},resumed:function(e){this.id=e.id,e.h&&this.process(e,!0)},failed:function(){this.started=!1,this.id=!1,this.lastAck=0,this.handled=0,this.unacked=[]},ack:function(){this.conn.send(new i.Ack({h:this.handled}))},request:function(){this.pendingAck=!0,this.conn.send(new i.Request)},process:function(e,t){var r=this,i=n(e.h-this.lastAck,o);this.pendingAck=!1;for(var s=0;i>s&&this.unacked.length>0;s++)this.conn.emit("stanza:acked",this.unacked.shift());if(this.lastAck=e.h,t){var a=this.unacked;this.unacked=[],a.forEach(function(e){r.conn.send(e)})}this.unacked.length>=this.windowSize&&this.request()},track:function(e){var t=e._name,n={message:!0,presence:!0,iq:!0};this.started&&n[t]&&(this.unacked.push(e),!this.pendingAck&&this.unacked.length>=this.windowSize&&this.request())},handle:function(){this.started&&(this.handled=n(this.handled+1,o))}},t.exports=r},{"./stanza/sm":53}],26:[function(e,t){var n=e("underscore"),r=e("jxt"),i=e("./pubsub").Item,o=e("./pubsub").EventItem,s=t.exports=r.define({name:"avatar",namespace:"urn:xmpp:avatar:metadata",element:"info",fields:{id:r.attribute("id"),bytes:r.attribute("bytes"),height:r.attribute("height"),width:r.attribute("width"),type:r.attribute("type","image/png"),url:r.attribute("url")}}),a={get:function(){var e=r.find(this.xml,"urn:xmpp:avatar:metadata","metadata"),t=[];if(e.length){var i=r.find(e[0],"urn:xmpp:avatar:metadata","info");n.forEach(i,function(e){t.push(new s({},e))})}return t},set:function(e){var t=r.findOrCreate(this.xml,"urn:xmpp:avatar:metadata","metadata");r.setAttribute(t,"xmlns","urn:xmpp:avatar:metadata"),n.forEach(e,function(e){var n=new s(e);t.appendChild(n.xml)})}};r.add(i,"avatars",a),r.add(o,"avatars",a),r.add(i,"avatarData",r.subText("urn:xmpp:avatar:data","data")),r.add(o,"avatarData",r.subText("urn:xmpp:avatar:data","data"))},{"./pubsub":46,jxt:98,underscore:119}],27:[function(e,t){var n=e("jxt"),r=e("./iq"),i=e("./streamFeatures"),o=e("./util"),s="urn:ietf:params:xml:ns:xmpp-bind",a=t.exports=n.define({name:"bind",namespace:s,element:"bind",fields:{resource:n.subText(s,"resource"),jid:o.jidSub(s,"jid")}});n.extend(r,a),n.extend(i,a)},{"./iq":38,"./streamFeatures":56,"./util":58,jxt:98}],28:[function(e,t){var n=e("jxt"),r=e("./util"),i=e("./private"),o=n.define({name:"conference",namespace:"storage:bookmarks",element:"conference",fields:{name:n.attribute("name"),autoJoin:n.boolAttribute("autojoin"),jid:r.jidAttribute("jid"),nick:n.subText("storage:bookmarks","nick")}}),s=t.exports=n.define({name:"bookmarks",namespace:"storage:bookmarks",element:"storage"});n.extend(i,s),n.extend(s,o,"conferences")},{"./private":45,"./util":58,jxt:98}],29:[function(e,t){var n=e("jxt"),r=e("./presence"),i=e("./streamFeatures"),o=t.exports=n.define({name:"caps",namespace:"http://jabber.org/protocol/caps",element:"c",fields:{ver:n.attribute("ver"),node:n.attribute("node"),hash:n.attribute("hash"),ext:n.attribute("ext")}});n.extend(r,o),n.extend(i,o)},{"./presence":44,"./streamFeatures":56,jxt:98}],30:[function(e,t,n){var r=e("jxt"),i=e("./message"),o=e("./iq"),s=e("./forwarded");n.Sent=r.define({name:"carbonSent",eventName:"carbon:sent",namespace:"urn:xmpp:carbons:2",element:"sent"}),n.Received=r.define({name:"carbonReceived",eventName:"carbon:received",namespace:"urn:xmpp:carbons:2",element:"received"}),n.Private=r.define({name:"carbonPrivate",eventName:"carbon:private",namespace:"urn:xmpp:carbons:2",element:"private"}),n.Enable=r.define({name:"enableCarbons",namespace:"urn:xmpp:carbons:2",element:"enable"}),n.Disable=r.define({name:"disableCarbons",namespace:"urn:xmpp:carbons:2",element:"disable"}),r.extend(n.Sent,s),r.extend(n.Received,s),r.extend(i,n.Sent),r.extend(i,n.Received),r.extend(i,n.Private),r.extend(o,n.Enable),r.extend(o,n.Disable)},{"./forwarded":36,"./iq":38,"./message":42,jxt:98}],31:[function(e){var t=e("jxt"),n=e("./message"),r="http://jabber.org/protocol/chatstates",i=t.define({name:"chatStateActive",eventName:"chat:active",namespace:r,element:"active"}),o=t.define({name:"chatStateComposing",eventName:"chat:composing",namespace:r,element:"composing"}),s=t.define({name:"chatStatePaused",eventName:"chat:paused",namespace:r,element:"paused"}),a=t.define({name:"chatStateInactive",eventName:"chat:inactive",namespace:r,element:"inactive"}),u=t.define({name:"chatStateGone",eventName:"chat:gone",namespace:r,element:"gone"});t.extend(n,i),t.extend(n,o),t.extend(n,s),t.extend(n,a),t.extend(n,u),t.add(n,"chatState",{get:function(){for(var e=this,t=["Active","Composing","Paused","Inactive","Gone"],n=0;n<t.length;n++)if(e._extensions["chatState"+t[n]])return t[n].toLowerCase();return""},set:function(e){var t=this,n=["Active","Composing","Paused","Inactive","Gone"];n.forEach(function(e){t._extensions["chatState"+e]&&(t.xml.removeChild(t._extensions["chatState"+e].xml),delete t._extensions["chatState"+e])}),e&&this["chatState"+e.charAt(0).toUpperCase()+e.slice(1)]}})},{"./message":42,jxt:98}],32:[function(e,t,n){e("underscore");var r=e("jxt");e("./util");var i=e("./message");n.DataForm=r.define({name:"form",namespace:"jabber:x:data",element:"x",fields:{title:r.subText("jabber:x:data","title"),instructions:r.multiSubText("jabber:x:data","instructions"),type:r.attribute("type","form")}}),n.Field=r.define({name:"field",namespace:"jabber:x:data",element:"field",init:function(e){this._type=e.type||this.type},fields:{type:{get:function(){return r.getAttribute(this.xml,"type","text-single")},set:function(e){this._type=e,r.setAttribute(this.xml,"type",e)}},name:r.attribute("var"),desc:r.subText("desc"),required:r.boolSub("jabber:x:data","required"),label:r.attribute("label"),value:{get:function(){var e=r.getMultiSubText(this.xml,this._NS,"value");return"boolean"===this._type?"1"===e[0]||"true"===e[0]:e.length>1?"text-multi"===this._type?e.join("\n"):e:e[0]},set:function(e){"boolean"===this._type?r.setSubText(this.xml,this._NS,"value",e?"1":"0"):("text-multi"===this._type&&(e=e.split("\n")),r.setMultiSubText(this.xml,this._NS,"value",e))}},options:{get:function(){var e=this;return r.getMultiSubText(this.xml,this._NS,"option",function(t){return r.getSubText(t,e._NS,"value")})},set:function(e){var t=this;r.setMultiSubText(this.xml,this._NS,"option",e,function(e){var n=document.createElementNS(t._NS,"option"),r=document.createElementNS(t._NS,"value");n.appendChild(r),r.textContent=e,t.xml.appendChild(n)})}}}}),r.extend(i,n.DataForm)},{"./message":42,"./util":58,jxt:98,underscore:119}],33:[function(e,t){var n=e("jxt"),r=e("./message"),i=e("./presence"),o=e("./util"),s=t.exports=n.define({name:"delay",namespace:"urn:xmpp:delay",element:"delay",fields:{from:o.jidAttribute("from"),stamp:n.dateAttribute("stamp"),reason:n.text()}});n.extend(r,s),n.extend(i,s)},{"./message":42,"./presence":44,"./util":58,jxt:98}],34:[function(e,t,n){e("underscore");var r=e("jxt"),i=e("../jid"),o=e("./iq"),s=e("./rsm"),a=e("./dataforms").DataForm;n.DiscoInfo=r.define({name:"discoInfo",namespace:"http://jabber.org/protocol/disco#info",element:"query",fields:{node:r.attribute("node"),identities:{get:function(){var e=[],t=r.find(this.xml,this._NS,"identity");return t.forEach(function(t){e.push({category:r.getAttribute(t,"category"),type:r.getAttribute(t,"type"),lang:t.getAttributeNS(r.XML_NS,"lang"),name:r.getAttribute(t,"name")})}),e},set:function(e){var t=this,n=r.find(this.xml,this._NS,"identity");n.forEach(function(e){t.xml.removeChild(e)}),e.forEach(function(e){var n=document.createElementNS(t._NS,"identity");r.setAttribute(n,"category",e.category),r.setAttribute(n,"type",e.type),r.setAttribute(n,"name",e.name),e.lang&&n.setAttributeNS(r.XML_NS,"lang",e.lang),t.xml.appendChild(n)})}},features:{get:function(){var e=[],t=r.find(this.xml,this._NS,"feature");return t.forEach(function(t){e.push(t.getAttribute("var"))}),e},set:function(e){var t=this,n=r.find(this.xml,this._NS,"feature");n.forEach(function(e){t.xml.removeChild(e)}),e.forEach(function(e){var n=document.createElementNS(t._NS,"feature");n.setAttribute("var",e),t.xml.appendChild(n)})}}}}),n.DiscoItems=r.define({name:"discoItems",namespace:"http://jabber.org/protocol/disco#items",element:"query",fields:{node:r.attribute("node"),items:{get:function(){var e=[],t=r.find(this.xml,this._NS,"item");return t.forEach(function(t){e.push({jid:new i(r.getAttribute(t,"jid")),node:r.getAttribute(t,"node"),name:r.getAttribute(t,"name")})}),e},set:function(e){var t=this,n=r.find(this.xml,this._NS,"item");n.forEach(function(e){t.xml.removeChild(e)}),e.forEach(function(e){var n=document.createElementNS(t._NS,"item");r.setAttribute(n,"jid",e.jid.toString()),r.setAttribute(n,"node",e.node),r.setAttribute(n,"name",e.name),t.xml.appendChild(n)})}}}}),r.extend(o,n.DiscoInfo),r.extend(o,n.DiscoItems),r.extend(n.DiscoItems,s),r.extend(n.DiscoInfo,a,"extensions")},{"../jid":3,"./dataforms":32,"./iq":38,"./rsm":49,jxt:98,underscore:119}],35:[function(e,t){e("underscore");var n=e("jxt"),r=e("./util"),i=e("./message"),o=e("./presence"),s=e("./iq"),a="urn:ietf:params:xml:ns:xmpp-stanzas",u=["bad-request","conflict","feature-not-implemented","forbidden","gone","internal-server-error","item-not-found","jid-malformed","not-acceptable","not-allowed","not-authorized","payment-required","recipient-unavailable","redirect","registration-required","remote-server-not-found","remote-server-timeout","resource-constraint","service-unavailable","subscription-required","undefined-condition","unexpected-request"],c=t.exports=n.define({name:"error",namespace:"jabber:client",element:"error",fields:{lang:{get:function(){return(this.parent||{}).lang||""
}},condition:{get:function(){var e=this,t=[];return u.forEach(function(r){var i=n.find(e.xml,a,r);i.length&&t.push(i[0].tagName)}),t[0]||""},set:function(e){var t=this;if(u.forEach(function(e){var r=n.find(t.xml,a,e);r.length&&t.xml.removeChild(r[0])}),e){var r=document.createElementNS(a,e);r.setAttribute("xmlns",a),this.xml.appendChild(r)}}},gone:{get:function(){return n.getSubText(this.xml,a,"gone")},set:function(e){this.condition="gone",n.setSubText(this.xml,a,"gone",e)}},redirect:{get:function(){return n.getSubText(this.xml,a,"redirect")},set:function(e){this.condition="redirect",n.setSubText(this.xml,a,"redirect",e)}},code:n.attribute("code"),type:n.attribute("type"),by:r.jidAttribute("by"),$text:{get:function(){return n.getSubLangText(this.xml,a,"text",this.lang)}},text:{get:function(){var e=this.$text;return e[this.lang]||""},set:function(e){n.setSubLangText(this.xml,a,"text",e,this.lang)}}}});n.extend(i,c),n.extend(o,c),n.extend(s,c)},{"./iq":38,"./message":42,"./presence":44,"./util":58,jxt:98,underscore:119}],36:[function(e,t){var n=e("jxt"),r=e("./message"),i=e("./presence"),o=e("./iq"),s=e("./delayed"),a=t.exports=n.define({name:"forwarded",eventName:"forward",namespace:"urn:xmpp:forward:0",element:"forwarded"});n.extend(r,a),n.extend(a,r),n.extend(a,i),n.extend(a,o),n.extend(a,s)},{"./delayed":33,"./iq":38,"./message":42,"./presence":44,jxt:98}],37:[function(e,t,n){e("underscore");var r=e("jxt");e("./util");var i=e("./jingle"),o="urn:xmpp:jingle:transports:ice-udp:1";n.ICEUDP=r.define({name:"_iceUdp",namespace:o,element:"transport",fields:{transType:{value:"iceUdp"},pwd:r.attribute("pwd"),ufrag:r.attribute("ufrag")}}),n.RemoteCandidate=r.define({name:"remoteCandidate",namespace:o,element:"remote-candidate",fields:{component:r.attribute("component"),ip:r.attribute("ip"),port:r.attribute("port")}}),n.Candidate=r.define({name:"_iceUdpCandidate",namespace:o,element:"candidate",fields:{component:r.attribute("component"),foundation:r.attribute("foundation"),generation:r.attribute("generation"),id:r.attribute("id"),ip:r.attribute("ip"),network:r.attribute("network"),port:r.attribute("port"),priority:r.attribute("priority"),protocol:r.attribute("protocol"),relAddr:r.attribute("rel-addr"),relPort:r.attribute("rel-port"),type:r.attribute("type")}}),n.Fingerprint=r.define({name:"_iceFingerprint",namespace:"urn:xmpp:tmp:jingle:apps:dtls:0",element:"fingerprint",fields:{hash:r.attribute("hash"),value:r.text(),required:r.boolAttribute("required")}}),r.extend(i.Content,n.ICEUDP),r.extend(n.ICEUDP,n.Candidate,"candidates"),r.extend(n.ICEUDP,n.RemoteCandidate),r.extend(n.ICEUDP,n.Fingerprint,"fingerprints")},{"./jingle":39,"./util":58,jxt:98,underscore:119}],38:[function(e,t){var n=e("jxt"),r=e("./util"),i=t.exports=n.define({name:"iq",namespace:"jabber:client",element:"iq",topLevel:!0,fields:{lang:n.langAttribute(),id:n.attribute("id"),to:r.jidAttribute("to"),from:r.jidAttribute("from"),type:n.attribute("type")}});i.prototype.resultReply=function(e){return e.to=this.from,e.id=this.id,e.type="result",new i(e)},i.prototype.errorReply=function(e){return e.to=this.from,e.id=this.id,e.type="error",new i(e)}},{"./util":58,jxt:98}],39:[function(e,t,n){e("underscore");var r=e("jxt");e("./util");var i=e("./iq"),o=e("./error"),s="urn:xmpp:jingle:1",a="urn:xmpp:jingle:errors:1",u=["out-of-order","tie-break","unknown-session","unsupported-info"],c=["alternative-session","busy","cancel","connectivity-error","decline","expired","failed-application","failed-transport","general-error","gone","incompatible-parameters","media-error","security-error","success","timeout","unsupported-applications","unsupported-transports"];n.Jingle=r.define({name:"jingle",namespace:s,element:"jingle",fields:{action:r.attribute("action"),initiator:r.attribute("initiator"),responder:r.attribute("responder"),sid:r.attribute("sid")}}),n.Content=r.define({name:"_jingleContent",namespace:s,element:"content",fields:{creator:r.attribute("creator"),disposition:r.attribute("disposition","session"),name:r.attribute("name"),senders:r.attribute("senders","both"),description:{get:function(){for(var e=["_rtp"],t=0;t<e.length;t++)if(this._extensions[e[t]])return this._extensions[e[t]]},set:function(e){var t="_"+e.descType;this[t]=e}},transport:{get:function(){for(var e=["_iceUdp"],t=0;t<e.length;t++)if(this._extensions[e[t]])return this._extensions[e[t]]},set:function(e){var t="_"+e.transType;this[t]=e}}}}),n.Reason=r.define({name:"reason",namespace:s,element:"reason",fields:{condition:{get:function(){var e=this,t=[];return c.forEach(function(n){var i=r.find(e.xml,s,n);i.length&&t.push(i[0].tagName)}),t[0]||""},set:function(e){var t=this;if(c.forEach(function(e){var n=r.find(t.xml,s,e);n.length&&t.xml.removeChild(n[0])}),e){var n=document.createElementNS(s,e);this.xml.appendChild(n)}}},alternativeSession:{get:function(){return r.getSubText(this.xml,s,"alternative-session")},set:function(e){this.condition="alternative-session",r.setSubText(this.xml,s,"alternative-session",e)}},text:r.subText(s,"text")}}),r.add(o,"jingleCondition",{get:function(){var e=this,t=[];return u.forEach(function(n){var i=r.find(e.xml,a,n);i.length&&t.push(i[0].tagName)}),t[0]||""},set:function(e){var t=this;if(u.forEach(function(e){var n=r.find(t.xml,a,e);n.length&&t.xml.removeChild(n[0])}),e){var n=document.createElementNS(a,e);this.xml.appendChild(n)}}}),r.extend(i,n.Jingle),r.extend(n.Jingle,n.Content,"contents"),r.extend(n.Jingle,n.Reason)},{"./error":35,"./iq":38,"./util":58,jxt:98,underscore:119}],40:[function(e,t){var n=e("jxt"),r=e("./message"),i=e("./pubsub").Item,o=e("./pubsub").EventItem,s=t.exports={get:function(){var e=n.getSubText(this.xml,"urn:xmpp:json:0","json");return e?JSON.parse(e):void 0},set:function(e){e=JSON.stringify(e),e&&n.setSubText(this.xml,"urn:xmpp:json:0","json",e)}};n.add(r,"json",s),n.add(i,"json",s),n.add(o,"json",s)},{"./message":42,"./pubsub":46,jxt:98}],41:[function(e,t,n){var r=e("jxt"),i=e("./util"),o=e("./message"),s=e("./iq"),a=e("./forwarded"),u=e("./rsm"),c=e("../jid");n.MAMQuery=r.define({name:"mamQuery",namespace:"urn:xmpp:mam:tmp",element:"query",fields:{queryid:r.attribute("queryid"),start:r.dateSub("urn:xmpp:mam:tmp","start"),end:r.dateSub("urn:xmpp:mam:tmp","end"),"with":i.jidSub("urn:xmpp:mam:tmp","with")}}),n.Result=r.define({name:"mam",eventName:"mam:result",namespace:"urn:xmpp:mam:tmp",element:"result",fields:{queryid:r.attribute("queryid"),id:r.attribute("id")}}),n.Archived=r.define({name:"mamArchived",namespace:"urn:xmpp:mam:tmp",element:"archived",fields:{by:i.jidAttribute("by"),id:r.attribute("id")}}),n.Prefs=r.define({name:"mamPrefs",namespace:"urn:xmpp:mam:tmp",element:"prefs",fields:{defaultCondition:r.attribute("default"),always:{get:function(){var e=[],t=r.find(this.xml,this._NS,"always");if(0===t.length)return e;t=t[0];var n=r.getMultiSubText(t,this._NS,"jid");return n.forEach(function(t){e.push(new c(t.textContent))}),e},set:function(e){if(e.length>0){var t=r.find(this.xml,this._NS,"always");r.setMultiSubText(t,this._NS,"jid",e)}}},never:{get:function(){var e=[],t=r.find(this.xml,this._NS,"always");if(0===t.length)return e;t=t[0];var n=r.getMultiSubText(t,this._NS,"jid");return n.forEach(function(t){e.push(new c(t.textContent))}),e},set:function(e){if(e.length>0){var t=r.find(this.xml,this._NS,"never");r.setMultiSubText(t,this._NS,"jid",e)}}}}}),r.extend(o,n.Archived,"archived"),r.extend(s,n.MAMQuery),r.extend(s,n.Prefs),r.extend(o,n.Result),r.extend(n.Result,a),r.extend(n.MAMQuery,u)},{"../jid":3,"./forwarded":36,"./iq":38,"./message":42,"./rsm":49,"./util":58,jxt:98}],42:[function(e,t){e("underscore");var n=e("jxt"),r=e("./util");t.exports=n.define({name:"message",namespace:"jabber:client",element:"message",topLevel:!0,fields:{lang:n.langAttribute(),id:n.attribute("id"),to:r.jidAttribute("to"),from:r.jidAttribute("from"),type:n.attribute("type","normal"),thread:n.subText("jabber:client","thread"),parentThread:n.subAttribute("jabber:client","thread","parent"),$body:{get:function(){return n.getSubLangText(this.xml,this._NS,"body",this.lang)}},body:{get:function(){var e=this.$body;return e[this.lang]||""},set:function(e){n.setSubLangText(this.xml,this._NS,"body",e,this.lang)}},attention:n.boolSub("urn:xmpp:attention:0","attention"),replace:n.subAttribute("urn:xmpp:message-correct:0","replace","id")}})},{"./util":58,jxt:98,underscore:119}],43:[function(e,t,n){var r=e("jxt");e("./message");var i=e("./presence");e("./iq");var o="http://jabber.org/protocol/muc";n.MUCJoin=r.define({name:"joinMuc",namespace:o,element:"x",fields:{password:r.subText(o,"password"),history:{get:function(){var e={},t=r.find(this.xml,this._NS,"history");if(!t.length)return{};t=t[0];var n=t.getAttribute("maxchars")||"",i=t.getAttribute("maxstanas")||"",o=t.getAttribute("seconds")||"",s=t.getAttribute("since")||"";n&&(e.maxchars=parseInt(n,10)),i&&(e.maxstanzas=parseInt(i,10)),o&&(e.seconds=parseInt(o,10)),s&&(e.since=new Date(s))},set:function(e){var t=r.find(this.xml,this._NS,"history");if(t.length)for(var n=0;n<t.length;n++)this.xml.removeChild(t[n]);var i=document.createElementNS(this._NS,"history");this.xml.appendChild(i),e.maxchars&&i.setAttribute(""+e.maxchars),e.maxstanzas&&i.setAttribute(""+e.maxstanzas),e.seconds&&i.setAttribute(""+e.seconds),e.since&&i.setAttribute(e.since.toISOString())}}}}),r.extend(i,n.MUCJoin)},{"./iq":38,"./message":42,"./presence":44,jxt:98}],44:[function(e,t){e("underscore");var n=e("jxt"),r=e("./util");t.exports=n.define({name:"presence",namespace:"jabber:client",element:"presence",topLevel:!0,fields:{lang:n.langAttribute(),id:n.attribute("id"),to:r.jidAttribute("to"),from:r.jidAttribute("from"),priority:n.subText("jabber:client","priority","0"),show:n.subText("jabber:client","show"),type:{get:function(){return n.getAttribute(this.xml,"type","available")},set:function(e){"available"===e&&(e=!1),n.setAttribute(this.xml,"type",e)}},$status:{get:function(){return n.getSubLangText(this.xml,this._NS,"status",this.lang)}},status:{get:function(){var e=this.$status;return e[this.lang]||""},set:function(e){n.setSubLangText(this.xml,this._NS,"status",e,this.lang)}},idleSince:n.dateSubAttribute("urn:xmpp:idle:1","idle","since"),decloak:n.subAttribute("urn:xmpp:decloak:0","decloak","reason")}})},{"./util":58,jxt:98,underscore:119}],45:[function(e,t){var n=e("jxt"),r=e("./iq"),i=t.exports=n.define({name:"privateStorage",namespace:"jabber:iq:private",element:"query"});n.extend(r,i)},{"./iq":38,jxt:98}],46:[function(e,t,n){var r=e("underscore"),i=e("jxt"),o=e("./util"),s=e("./iq"),a=e("./message"),u=e("./dataforms").DataForm,c=e("./rsm");e("../jid");var l="http://jabber.org/protocol/pubsub",f="http://jabber.org/protocol/pubsub#owner",p="http://jabber.org/protocol/pubsub#event";n.Pubsub=i.define({name:"pubsub",namespace:"http://jabber.org/protocol/pubsub",element:"pubsub",fields:{publishOptions:{get:function(){var e=i.find(this.xml,this._NS,"publish-options");return e.length&&e[0].childNodes.length?new u({},e[0].childNodes[0]):void 0},set:function(e){var t=i.findOrCreate(this.xml,this._NS,"publish-options");if(e){var n=new u(e);t.appendChild(n.xml)}}}}}),n.PubsubOwner=i.define({name:"pubsubOwner",namespace:f,element:"pubsub",fields:{create:i.subAttribute(f,"create","node"),purge:i.subAttribute(f,"purge","node"),del:i.subAttribute(f,"delete","node"),redirect:{get:function(){var e=i.find(this.xml,this._NS,"delete");return e.length?i.getSubAttribute(e[0],this._NS,"redirect","uri"):""},set:function(e){var t=i.findOrCreate(this.xml,this._NS,"delete");i.setSubAttribute(t,this._NS,"redirect","uri",e)}}}}),n.Configure=i.define({name:"config",namespace:f,element:"configure",fields:{node:i.attribute("node")}}),n.Event=i.define({name:"event",namespace:p,element:"event"}),n.Subscribe=i.define({name:"subscribe",namespace:l,element:"subscribe",fields:{node:i.attribute("node"),jid:o.jidAttribute("jid")}}),n.Subscription=i.define({name:"subscription",namespace:l,element:"subscription",fields:{node:i.attribute("node"),jid:o.jidAttribute("jid"),subid:i.attribute("subid"),type:i.attribute("subscription")}}),n.Unsubscribe=i.define({name:"unsubscribe",namespace:l,element:"unsubscribe",fields:{node:i.attribute("node"),jid:o.jidAttribute("jid")}}),n.Publish=i.define({name:"publish",namespace:l,element:"publish",fields:{node:i.attribute("node")}}),n.Retract=i.define({name:"retract",namespace:l,element:"retract",fields:{node:i.attribute("node"),notify:i.boolAttribute("notify"),id:i.subAttribute(l,"item","id")}}),n.Retrieve=i.define({name:"retrieve",namespace:l,element:"items",fields:{node:i.attribute("node"),max:i.attribute("max_items")}}),n.Item=i.define({name:"item",namespace:l,element:"item",fields:{id:i.attribute("id")}}),n.EventItems=i.define({name:"updated",namespace:p,element:"items",fields:{node:i.attribute("node"),retracted:{get:function(){var e=[],t=i.find(this.xml,this._NS,"retract");return r.forEach(t,function(t){e.push(t.getAttribute("id"))}),e},set:function(e){var t=this;r.forEach(e,function(e){var n=document.createElementNS(t._NS,"retract");n.setAttribute("id",e),this.xml.appendChild(n)})}}}}),n.EventItem=i.define({name:"eventItem",namespace:p,element:"item",fields:{id:i.attribute("id"),node:i.attribute("node"),publisher:o.jidAttribute("publisher")}}),i.extend(n.Pubsub,n.Subscribe),i.extend(n.Pubsub,n.Unsubscribe),i.extend(n.Pubsub,n.Publish),i.extend(n.Pubsub,n.Retrieve),i.extend(n.Pubsub,n.Subscription),i.extend(n.PubsubOwner,n.Configure),i.extend(n.Publish,n.Item,"items"),i.extend(n.Retrieve,n.Item,"items"),i.extend(n.Configure,u),i.extend(n.Pubsub,c),i.extend(n.Event,n.EventItems),i.extend(n.EventItems,n.EventItem,"published"),i.extend(a,n.Event),i.extend(s,n.Pubsub),i.extend(s,n.PubsubOwner)},{"../jid":3,"./dataforms":32,"./iq":38,"./message":42,"./rsm":49,"./util":58,jxt:98,underscore:119}],47:[function(e,t){var n=e("jxt"),r=e("./message");n.add(r,"requestReceipt",n.boolSub("urn:xmpp:receipts","request"));var i=t.exports=n.define({name:"receipt",namespace:"urn:xmpp:receipts",element:"receipt",fields:{id:n.attribute("id")}});n.extend(r,i)},{"./message":42,jxt:98}],48:[function(e,t){e("underscore");var n=e("jxt"),r=e("./iq"),i=e("../jid"),o=t.exports=n.define({name:"roster",namespace:"jabber:iq:roster",element:"query",fields:{ver:{get:function(){return n.getAttribute(this.xml,"ver")},set:function(e){var t=""===e;n.setAttribute(this.xml,"ver",e,t)}},items:{get:function(){var e=this,t=n.find(this.xml,this._NS,"item");if(!t.length)return[];var r=[];return t.forEach(function(t){var o={jid:new i(n.getAttribute(t,"jid","")),name:n.getAttribute(t,"name",void 0),subscription:n.getAttribute(t,"subscription","none"),ask:n.getAttribute(t,"ask",void 0),groups:[]},s=n.find(t,e._NS,"group");s.forEach(function(e){o.groups.push(e.textContent)}),r.push(o)}),r},set:function(e){var t=this;e.forEach(function(e){var r=document.createElementNS(t._NS,"item");n.setAttribute(r,"jid",e.jid.toString()),n.setAttribute(r,"name",e.name),n.setAttribute(r,"subscription",e.subscription),n.setAttribute(r,"ask",e.ask),(e.groups||[]).forEach(function(e){var n=document.createElementNS(t._NS,"group");n.textContent=e,r.appendChild(n)}),t.xml.appendChild(r)})}}}});n.extend(r,o)},{"../jid":3,"./iq":38,jxt:98,underscore:119}],49:[function(e,t){var n=e("jxt");e("./util");var r="http://jabber.org/protocol/rsm";t.exports=n.define({name:"rsm",namespace:r,element:"set",fields:{after:n.subText(r,"after"),before:{get:function(){return n.getSubText(this.xml,this._NS,"before")},set:function(e){e===!0?n.findOrCreate(this.xml,this._NS,"before"):n.setSubText(this.xml,this._NS,"before",e)}},count:n.numberSub(r,"count"),first:n.subText(r,"first"),firstIndex:n.subAttribute(r,"first","index"),index:n.subText(r,"index"),last:n.subText(r,"last"),max:n.subText(r,"max")}})},{"./util":58,jxt:98}],50:[function(e,t,n){e("underscore");var r=e("jxt");e("./util");var i=e("./jingle"),o="urn:xmpp:jingle:apps:rtp:1",s="urn:xmpp:jingle:apps:rtp:rtcp-fb:0",a="urn:xmpp:jingle:apps:rtp:rtp-hdrext:0",u="urn:xmpp:jingle:apps:rtp:info:1",c={get:function(){var e=r.find(this.xml,s,"rtcp-fb"),t=[];return e.forEach(function(e){t.push({type:r.getAttribute(e,"type"),subtype:r.getAttribute(e,"subtype")})}),e=r.find(this.xml,s,"rtcp-fb-trr-int"),e.forEach(function(e){t.push({type:r.getAttribute(e,"type"),value:r.getAttribute(e,"value")})}),t},set:function(e){var t=this,n=r.find(this.xml,s,"rtcp-fb");n.forEach(function(e){t.xml.removeChild(e)}),n=r.find(this.xml,s,"rtcp-fb-trr-int"),n.forEach(function(e){t.xml.removeChild(e)}),e.forEach(function(e){var n;"trr-int"===e.type?(n=r.createElement(s,"rtcp-fb-trr-int",o),r.setAttribute(n,"type",e.type),r.setAttribute(n,"value",e.value)):(n=r.createElement(s,"rtcp-fb",o),r.setAttribute(n,"type",e.type),r.setAttribute(n,"subtype",e.subtype)),t.xml.appendChild(n)})}};n.RTP=r.define({name:"_rtp",namespace:o,element:"description",fields:{descType:{value:"rtp"},media:r.attribute("media"),ssrc:r.attribute("ssrc"),bandwidth:r.subText(o,"bandwidth"),bandwidthType:r.subAttribute(o,"bandwidth","type"),mux:r.boolSub(o,"rtcp-mux"),encryption:{get:function(){var e=r.find(this.xml,o,"encryption");if(!e.length)return[];e=e[0];var t=this,i=r.find(e,o,"crypto"),s=[];return i.forEach(function(e){s.push(new n.Crypto({},e,t).toJSON())}),s},set:function(e){var t=r.find(this.xml,o,"encryption");if(t.length&&this.xml.removeChild(t),e.length){r.setBoolSubAttribute(this.xml,o,"encryption","required",!0),t=r.find(this.xml,o,"encryption")[0];var i=this;e.forEach(function(e){var r=new n.Crypto(e,null,i);t.appendChild(r.xml)})}}},feedback:c,headerExtensions:{get:function(){var e=r.find(this.xml,a,"rtp-hdrext"),t=[];return e.forEach(function(e){t.push({id:r.getAttribute(e,"id"),uri:r.getAttribute(e,"uri"),senders:r.getAttribute(e,"senders")})}),t},set:function(e){var t=this,n=r.find(this.xml,a,"rtp-hdrext");n.forEach(function(e){t.xml.removeChild(e)}),e.forEach(function(e){var n=r.createElement(a,"rtp-hdrext",o);r.setAttribute(n,"id",e.id),r.setAttribute(n,"uri",e.uri),r.setAttribute(n,"senders",e.senders),t.xml.appendChild(n)})}}}}),n.PayloadType=r.define({name:"_payloadType",namespace:o,element:"payload-type",fields:{channels:r.attribute("channels"),clockrate:r.attribute("clockrate"),id:r.attribute("id"),maxptime:r.attribute("maxptime"),name:r.attribute("name"),ptime:r.attribute("ptime"),feedback:c,parameters:{get:function(){var e=[],t=r.find(this.xml,o,"parameter");return t.forEach(function(t){e.push({key:r.getAttribute(t,"name"),value:r.getAttribute(t,"value")})}),e},set:function(e){var t=this;e.forEach(function(e){var n=r.createElement(o,"parameter");r.setAttribute(n,"name",e.key),r.setAttribute(n,"value",e.value),t.xml.appendChild(n)})}}}}),n.Crypto=r.define({name:"crypto",namespace:o,element:"crypto",fields:{cipherSuite:r.attribute("crypto-suite"),keyParams:r.attribute("key-params"),sessionParams:r.attribute("session-params"),tag:r.attribute("tag")}}),n.Bundle=r.define({name:"_group",namespace:"urn:ietf:rfc:5888",element:"group",fields:{semantics:r.attribute("semantics"),contents:{get:function(){return r.getMultiSubText(this.xml,this._NS,"content",function(e){return r.getAttribute(e,"name")})},set:function(e){var t=this;r.setMultiSubText(this.xml,this._NS,"content",e,function(e){var n=r.createElement(t._NS,"content",t._NS);r.setAttribute(n,"name",e),t.xml.appendChild(n)})}}}}),n.SSRC=r.define({name:"_ssrc",namespace:"http://estos.de/ns/ssrc",element:"ssrc",fields:{ssrc:r.attribute("ssrc"),cname:r.attribute("cname"),msid:r.attribute("msid"),mslabel:r.attribute("mslabel"),label:r.attribute("label")}}),n.Mute=r.define({name:"mute",namespace:u,element:"mute",fields:{creator:r.attribute("creator"),name:r.attribute("name")}}),n.Unmute=r.define({name:"unmute",namespace:u,element:"unmute",fields:{creator:r.attribute("creator"),name:r.attribute("name")}}),r.extend(i.Content,n.RTP),r.extend(n.RTP,n.PayloadType,"payloads"),r.extend(n.RTP,n.SSRC,"ssrcs"),r.extend(i.Jingle,n.Mute),r.extend(i.Jingle,n.Unmute),r.extend(i.Jingle,n.Bundle,"groupings"),r.add(i.Jingle,"ringing",r.boolSub(u,"ringing")),r.add(i.Jingle,"hold",r.boolSub(u,"hold")),r.add(i.Jingle,"active",r.boolSub(u,"active"))},{"./jingle":39,"./util":58,jxt:98,underscore:119}],51:[function(e,t,n){e("underscore");var r=e("jxt");e("./util");var i=e("./streamFeatures"),o="urn:ietf:params:xml:ns:xmpp-sasl",s=["aborted","account-disabled","credentials-expired","encryption-required","incorrect-encoding","invalid-authzid","invalid-mechanism","malformed-request","mechanism-too-weak","not-authorized","temporary-auth-failure"];n.Mechanisms=r.define({name:"sasl",namespace:o,element:"mechanisms",fields:{mechanisms:r.multiSubText(o,"mechanism")}}),n.Auth=r.define({name:"saslAuth",eventName:"sasl:auth",namespace:o,element:"auth",topLevel:!0,fields:{value:r.b64Text(),mechanism:r.attribute("mechanism")}}),n.Challenge=r.define({name:"saslChallenge",eventName:"sasl:challenge",namespace:o,element:"challenge",topLevel:!0,fields:{value:r.b64Text()}}),n.Response=r.define({name:"saslResponse",eventName:"sasl:response",namespace:o,element:"response",topLevel:!0,fields:{value:r.b64Text()}}),n.Abort=r.define({name:"saslAbort",eventName:"sasl:abort",namespace:o,element:"abort",topLevel:!0}),n.Success=r.define({name:"saslSuccess",eventName:"sasl:success",namespace:o,element:"success",topLevel:!0,fields:{value:r.b64Text()}}),n.Failure=r.define({name:"saslFailure",eventName:"sasl:failure",namespace:o,element:"failure",topLevel:!0,fields:{lang:{get:function(){return this._lang||""},set:function(e){this._lang=e}},condition:{get:function(){var e=this,t=[];return s.forEach(function(n){var i=r.find(e.xml,o,n);i.length&&t.push(i[0].tagName)}),t[0]||""},set:function(e){var t=this;if(this._CONDITIONS.forEach(function(e){var n=r.find(t.xml,o,e);n.length&&t.xml.removeChild(n[0])}),e){var n=r.createElementNS(o,e);n.setAttribute("xmlns",o),this.xml.appendChild(n)}}},$text:{get:function(){return r.getSubLangText(this.xml,o,"text",this.lang)}},text:{get:function(){var e=this.$text;return e[this.lang]||""},set:function(e){r.setSubLangText(this.xml,o,"text",e,this.lang)}}}}),r.extend(i,n.Mechanisms)},{"./streamFeatures":56,"./util":58,jxt:98,underscore:119}],52:[function(e,t){var n=e("jxt"),r=e("./iq"),i=e("./streamFeatures"),o=t.exports=n.define({name:"session",namespace:"urn:ietf:params:xml:ns:xmpp-session",element:"session"});n.extend(i,o),n.extend(r,o)},{"./iq":38,"./streamFeatures":56,jxt:98}],53:[function(e,t,n){var r=e("jxt");e("./util");var i=e("./streamFeatures"),o="urn:xmpp:sm:3";n.SMFeature=r.define({name:"streamManagement",namespace:o,element:"sm"}),n.Enable=r.define({name:"smEnable",eventName:"stream:management:enable",namespace:o,element:"enable",topLevel:!0,fields:{resume:r.boolAttribute("resume")}}),n.Enabled=r.define({name:"smEnabled",eventName:"stream:management:enabled",namespace:o,element:"enabled",topLevel:!0,fields:{id:r.attribute("id"),resume:r.boolAttribute("resume")}}),n.Resume=r.define({name:"smResume",eventName:"stream:management:resume",namespace:o,element:"resume",topLevel:!0,fields:{h:r.numberAttribute("h"),previd:r.attribute("previd")}}),n.Resumed=r.define({name:"smResumed",eventName:"stream:management:resumed",namespace:o,element:"resumed",topLevel:!0,fields:{h:r.numberAttribute("h"),previd:r.attribute("previd")}}),n.Failed=r.define({name:"smFailed",eventName:"stream:management:failed",namespace:o,element:"failed",topLevel:!0}),n.Ack=r.define({name:"smAck",eventName:"stream:management:ack",namespace:o,element:"a",topLevel:!0,fields:{h:r.numberAttribute("h")}}),n.Request=r.define({name:"smRequest",eventName:"stream:management:request",namespace:o,element:"r",topLevel:!0}),r.extend(i,n.SMFeature)},{"./streamFeatures":56,"./util":58,jxt:98}],54:[function(e,t){var n=e("jxt"),r=e("./util");t.exports=n.define({name:"stream",namespace:"http://etherx.jabber.org/streams",element:"stream",fields:{lang:{get:function(){return this.xml.getAttributeNS(n.XML_NS,"lang")||""},set:function(e){this.xml.setAttributeNS(n.XML_NS,"lang",e)}},id:n.attribute("id"),version:n.attribute("version","1.0"),to:r.jidAttribute("to"),from:r.jidAttribute("from")}})},{"./util":58,jxt:98}],55:[function(e,t){e("underscore");var n=e("jxt"),r="urn:ietf:params:xml:ns:xmpp-streams",i=["bad-format","bad-namespace-prefix","conflict","connection-timeout","host-gone","host-unknown","improper-addressing","internal-server-error","invalid-from","invalid-namespace","invalid-xml","not-authorized","not-well-formed","policy-violation","remote-connection-failed","reset","resource-constraint","restricted-xml","see-other-host","system-shutdown","undefined-condition","unsupported-encoding","unsupported-feature","unsupported-stanza-type","unsupported-version"];t.exports=n.define({name:"streamError",namespace:"http://etherx.jabber.org/streams",element:"error",topLevel:!0,fields:{lang:{get:function(){return this._lang||""},set:function(e){this._lang=e}},condition:{get:function(){var e=this,t=[];return i.forEach(function(i){var o=n.find(e.xml,r,i);o.length&&t.push(o[0].tagName)}),t[0]||""},set:function(e){var t=this;if(this._CONDITIONS.forEach(function(e){var i=n.find(t.xml,r,e);i.length&&t.xml.removeChild(i[0])}),e){var i=n.createElementNS(r,e);i.setAttribute("xmlns",r),this.xml.appendChild(i)}}},seeOtherHost:{get:function(){return n.getSubText(this.xml,r,"see-other-host")},set:function(e){this.condition="see-other-host",n.setSubText(this.xml,r,"see-other-host",e)}},$text:{get:function(){return n.getSubLangText(this.xml,r,"text",this.lang)}},text:{get:function(){var e=this.$text;return e[this.lang]||""},set:function(e){n.setSubLangText(this.xml,r,"text",e,this.lang)}}}})},{jxt:98,underscore:119}],56:[function(e,t){var n=e("jxt"),r=t.exports=n.define({name:"streamFeatures",namespace:"http://etherx.jabber.org/streams",element:"features",topLevel:!0,fields:{features:{get:function(){return this._extensions}}}}),i=n.define({name:"rosterVersioning",namespace:"urn:xmpp:features:rosterver",element:"ver"}),o=n.define({name:"subscriptionPreApproval",namespace:"urn:xmpp:features:pre-approval",element:"sub"});n.extend(r,i),n.extend(r,o)},{jxt:98}],57:[function(e,t){var n=e("jxt");e("./util");var r=e("./iq"),i=t.exports=n.define({name:"time",namespace:"urn:xmpp:time",element:"time",fields:{utc:n.dateSub("urn:xmpp:time","utc"),tzo:{get:function(){var e,t,r,i=-1,o=n.getSubText(this.xml,this._NS,"tzo");return o?("-"===o.charAt(0)&&(i=1,o=o.slice(1)),e=o.split(":"),t=parseInt(e[0],10),r=parseInt(e[1],10),(60*t+r)*i):0},set:function(e){var t,r,i="-";"number"==typeof e?(0>e&&(e=-e,i="+"),t=e/60,r=e%60,i+=(10>t?"0":"")+t+":"+(10>r?"0":"")+r):i=e,n.setSubText(this.xml,this._NS,"tzo",i)}}}});n.extend(r,i)},{"./iq":38,"./util":58,jxt:98}],58:[function(e,t,n){var r=e("jxt"),i=e("../jid");n.jidAttribute=r.field(function(e,t){return new i(r.getAttribute(e,t))},function(e,t,n){r.setAttribute(e,t,(n||"").toString())}),n.jidSub=r.field(function(e,t,n){return new i(r.getSubText(e,t,n))},function(e,t,n,i){r.setSubText(e,t,n,(i||"").toString())})},{"../jid":3,jxt:98}],59:[function(e,t){var n=e("jxt"),r=e("./iq"),i="jabber:iq:version",o=t.exports=n.define({name:"version",namespace:i,element:"query",fields:{name:n.subText(i,"name"),version:n.subText(i,"version"),os:n.subText(i,"os")}});n.extend(r,o)},{"./iq":38,jxt:98}],60:[function(e){var t=e("jxt"),n=e("./iq");t.add(n,"visible",t.boolSub("urn:xmpp:invisible:0","visible")),t.add(n,"invisible",t.boolSub("urn:xmpp:invisible:0","invisible"))},{"./iq":38,jxt:98}],61:[function(e,t){function n(){function e(e){var t=[n.streamStart,e,n.streamEnd].join("");return t}function t(e){for(var t=n.parser.parseFromString(e,"application/xml").childNodes,r=0;r<t.length;r++)if(1===t[r].nodeType)return t[r]}var n=this;i.call(this),n.sm=new a(n),n.sendQueue=o.queue(function(e,t){n.conn&&(n.emit("raw:outgoing",e),n.sm.track(e),"string"!=typeof e&&(e=e.toString()),n.conn.send(e)),t()},1),n.on("connected",function(){n.send(["<stream:stream",'xmlns:stream="http://etherx.jabber.org/streams"','xmlns="jabber:client"','version="'+(n.config.version||"1.0")+'"','xml:lang="'+(n.config.lang||"en")+'"','to="'+n.config.server+'">'].join(" "))}),n.on("raw:incoming",function(i){var o,a;if(i=i.trim(),i=i.replace(/^(\s*<\?.*\?>\s*)*/,""),""!==i){if(i.match(n.streamEnd))return n.disconnect();if(n.hasStream)try{o=new s({},t(e(i)))}catch(u){return n.disconnect()}else{var c=i.match(/^<(\S+:)?(\S+) /);n.streamStart=i,n.streamEnd="</"+(c[1]||"")+c[2]+">",a=!1;try{o=new s({},t(i+n.streamEnd))}catch(u){try{o=new s({},t(i)),a=!0}catch(l){return n.disconnect()}}n.hasStream=!0,n.stream=o,n.emit("stream:start",o)}r.each(o._extensions,function(e){e.lang||(e.lang=n.stream.lang),("message"===e._name||"presence"===e._name||"iq"===e._name)&&(n.sm.handle(e),n.emit("stanza",e)),n.emit(e._eventname||e._name,e),n.emit("stream:data",e),e.id&&n.emit("id:"+e.id,e)}),a&&n.emit("stream:end")}})}var r=e("underscore"),i=e("wildemitter"),o=e("async"),s=e("./stanza/stream");e("./stanza/message"),e("./stanza/presence"),e("./stanza/iq");var a=e("./sm");e("node-uuid"),n.prototype=Object.create(i.prototype,{constructor:{value:n}}),n.prototype.connect=function(e){var t=this;t.config=e,t.hasStream=!1,t.streamStart='<stream:stream xmlns:stream="http://etherx.jabber.org/streams">',t.streamEnd="</stream:stream>",t.parser=new DOMParser,t.serializer=new XMLSerializer,t.conn=new WebSocket(e.wsURL,"xmpp"),t.conn.onerror=function(e){return e.preventDefault(),t.emit("disconnected",t),!1},t.conn.onclose=function(){t.emit("disconnected",t)},t.conn.onopen=function(){t.sm.started=!1,t.emit("connected",t)},t.conn.onmessage=function(e){t.emit("raw:incoming",e.data)}},n.prototype.disconnect=function(){this.conn&&(this.hasStream&&(this.conn.send("</stream:stream>"),this.emit("raw:outgoing","</stream:stream>"),this.emit("stream:end")),this.hasStream=!1,this.conn.close(),this.stream=void 0,this.conn=void 0,this.sm.failed())},n.prototype.restart=function(){var e=this;e.hasStream=!1,e.send(["<stream:stream",'xmlns:stream="http://etherx.jabber.org/streams"','xmlns="jabber:client"','version="'+(e.config.version||"1.0")+'"','xml:lang="'+(e.config.lang||"en")+'"','to="'+e.config.server+'">'].join(" "))},n.prototype.send=function(e){this.sendQueue.push(e)},t.exports=n},{"./sm":25,"./stanza/iq":38,"./stanza/message":42,"./stanza/presence":44,"./stanza/stream":54,async:62,"node-uuid":105,underscore:119,wildemitter:120}],62:[function(t,n){var r=t("__browserify_process");!function(){function t(e){var t=!1;return function(){if(t)throw new Error("Callback was already called.");t=!0,e.apply(i,arguments)}}var i,o,s={};i=this,null!=i&&(o=i.async),s.noConflict=function(){return i.async=o,s};var a=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n+=1)t(e[n],n,e)},u=function(e,t){if(e.map)return e.map(t);var n=[];return a(e,function(e,r,i){n.push(t(e,r,i))}),n},c=function(e,t,n){return e.reduce?e.reduce(t,n):(a(e,function(e,r,i){n=t(n,e,r,i)}),n)},l=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};"undefined"!=typeof r&&r.nextTick?(s.nextTick=r.nextTick,s.setImmediate="undefined"!=typeof setImmediate?setImmediate:s.nextTick):"function"==typeof setImmediate?(s.nextTick=function(e){setImmediate(e)},s.setImmediate=s.nextTick):(s.nextTick=function(e){setTimeout(e,0)},s.setImmediate=s.nextTick),s.each=function(e,n,r){if(r=r||function(){},!e.length)return r();var i=0;a(e,function(o){n(o,t(function(t){t?(r(t),r=function(){}):(i+=1,i>=e.length&&r(null))}))})},s.forEach=s.each,s.eachSeries=function(e,t,n){if(n=n||function(){},!e.length)return n();var r=0,i=function(){t(e[r],function(t){t?(n(t),n=function(){}):(r+=1,r>=e.length?n(null):i())})};i()},s.forEachSeries=s.eachSeries,s.eachLimit=function(e,t,n,r){var i=f(t);i.apply(null,[e,n,r])},s.forEachLimit=s.eachLimit;var f=function(e){return function(t,n,r){if(r=r||function(){},!t.length||0>=e)return r();var i=0,o=0,s=0;!function a(){if(i>=t.length)return r();for(;e>s&&o<t.length;)o+=1,s+=1,n(t[o-1],function(e){e?(r(e),r=function(){}):(i+=1,s-=1,i>=t.length?r():a())
})}()}},p=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[s.each].concat(t))}},d=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[f(e)].concat(n))}},h=function(e){return function(){var t=Array.prototype.slice.call(arguments);return e.apply(null,[s.eachSeries].concat(t))}},m=function(e,t,n,r){var i=[];t=u(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n,r){i[e.index]=r,t(n)})},function(e){r(e,i)})};s.map=p(m),s.mapSeries=h(m),s.mapLimit=function(e,t,n,r){return g(t)(e,n,r)};var g=function(e){return d(e,m)};s.reduce=function(e,t,n,r){s.eachSeries(e,function(e,r){n(t,e,function(e,n){t=n,r(e)})},function(e){r(e,t)})},s.inject=s.reduce,s.foldl=s.reduce,s.reduceRight=function(e,t,n,r){var i=u(e,function(e){return e}).reverse();s.reduce(i,t,n,r)},s.foldr=s.reduceRight;var b=function(e,t,n,r){var i=[];t=u(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n&&i.push(e),t()})},function(){r(u(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};s.filter=p(b),s.filterSeries=h(b),s.select=s.filter,s.selectSeries=s.filterSeries;var v=function(e,t,n,r){var i=[];t=u(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n||i.push(e),t()})},function(){r(u(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};s.reject=p(v),s.rejectSeries=h(v);var y=function(e,t,n,r){e(t,function(e,t){n(e,function(n){n?(r(e),r=function(){}):t()})},function(){r()})};s.detect=p(y),s.detectSeries=h(y),s.some=function(e,t,n){s.each(e,function(e,r){t(e,function(e){e&&(n(!0),n=function(){}),r()})},function(){n(!1)})},s.any=s.some,s.every=function(e,t,n){s.each(e,function(e,r){t(e,function(e){e||(n(!1),n=function(){}),r()})},function(){n(!0)})},s.all=s.every,s.sortBy=function(e,t,n){s.map(e,function(e,n){t(e,function(t,r){t?n(t):n(null,{value:e,criteria:r})})},function(e,t){if(e)return n(e);var r=function(e,t){var n=e.criteria,r=t.criteria;return r>n?-1:n>r?1:0};n(null,u(t.sort(r),function(e){return e.value}))})},s.auto=function(e,t){t=t||function(){};var n=l(e);if(!n.length)return t(null);var r={},i=[],o=function(e){i.unshift(e)},u=function(e){for(var t=0;t<i.length;t+=1)if(i[t]===e)return i.splice(t,1),void 0},f=function(){a(i.slice(0),function(e){e()})};o(function(){l(r).length===n.length&&(t(null,r),t=function(){})}),a(n,function(n){var i=e[n]instanceof Function?[e[n]]:e[n],p=function(e){var i=Array.prototype.slice.call(arguments,1);if(i.length<=1&&(i=i[0]),e){var o={};a(l(r),function(e){o[e]=r[e]}),o[n]=i,t(e,o),t=function(){}}else r[n]=i,s.setImmediate(f)},d=i.slice(0,Math.abs(i.length-1))||[],h=function(){return c(d,function(e,t){return e&&r.hasOwnProperty(t)},!0)&&!r.hasOwnProperty(n)};if(h())i[i.length-1](p,r);else{var m=function(){h()&&(u(m),i[i.length-1](p,r))};o(m)}})},s.waterfall=function(e,t){if(t=t||function(){},e.constructor!==Array){var n=new Error("First argument to waterfall must be an array of functions");return t(n)}if(!e.length)return t();var r=function(e){return function(n){if(n)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),o=e.next();o?i.push(r(o)):i.push(t),s.setImmediate(function(){e.apply(null,i)})}}};r(s.iterator(e))()};var x=function(e,t,n){if(n=n||function(){},t.constructor===Array)e.map(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.each(l(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}};s.parallel=function(e,t){x({map:s.map,each:s.each},e,t)},s.parallelLimit=function(e,t,n){x({map:g(t),each:f(t)},e,n)},s.series=function(e,t){if(t=t||function(){},e.constructor===Array)s.mapSeries(e,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},t);else{var n={};s.eachSeries(l(e),function(t,r){e[t](function(e){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),n[t]=i,r(e)})},function(e){t(e,n)})}},s.iterator=function(e){var t=function(n){var r=function(){return e.length&&e[n].apply(null,arguments),r.next()};return r.next=function(){return n<e.length-1?t(n+1):null},r};return t(0)},s.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var w=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]),t(e)})},function(e){r(e,i)})};s.concat=p(w),s.concatSeries=h(w),s.whilst=function(e,t,n){e()?t(function(r){return r?n(r):(s.whilst(e,t,n),void 0)}):n()},s.doWhilst=function(e,t,n){e(function(r){return r?n(r):(t()?s.doWhilst(e,t,n):n(),void 0)})},s.until=function(e,t,n){e()?n():t(function(r){return r?n(r):(s.until(e,t,n),void 0)})},s.doUntil=function(e,t,n){e(function(r){return r?n(r):(t()?n():s.doUntil(e,t,n),void 0)})},s.queue=function(e,n){function r(e,t,r,i){t.constructor!==Array&&(t=[t]),a(t,function(t){var o={data:t,callback:"function"==typeof i?i:null};r?e.tasks.unshift(o):e.tasks.push(o),e.saturated&&e.tasks.length===n&&e.saturated(),s.setImmediate(e.process)})}void 0===n&&(n=1);var i=0,o={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,push:function(e,t){r(o,e,!1,t)},unshift:function(e,t){r(o,e,!0,t)},process:function(){if(i<o.concurrency&&o.tasks.length){var n=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),i+=1;var r=function(){i-=1,n.callback&&n.callback.apply(n,arguments),o.drain&&0===o.tasks.length+i&&o.drain(),o.process()},s=t(r);e(n.data,s)}},length:function(){return o.tasks.length},running:function(){return i}};return o},s.cargo=function(e,t){var n=!1,r=[],i={tasks:r,payload:t,saturated:null,empty:null,drain:null,push:function(e,n){e.constructor!==Array&&(e=[e]),a(e,function(e){r.push({data:e,callback:"function"==typeof n?n:null}),i.saturated&&r.length===t&&i.saturated()}),s.setImmediate(i.process)},process:function o(){if(!n){if(0===r.length)return i.drain&&i.drain(),void 0;var s="number"==typeof t?r.splice(0,t):r.splice(0),c=u(s,function(e){return e.data});i.empty&&i.empty(),n=!0,e(c,function(){n=!1;var e=arguments;a(s,function(t){t.callback&&t.callback.apply(null,e)}),o()})}},length:function(){return r.length},running:function(){return n}};return i};var S=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[e]&&a(n,function(t){console[e](t)}))}]))}};s.log=S("log"),s.dir=S("dir"),s.memoize=function(e,t){var n={},r={};t=t||function(e){return e};var i=function(){var i=Array.prototype.slice.call(arguments),o=i.pop(),s=t.apply(null,i);s in n?o.apply(null,n[s]):s in r?r[s].push(o):(r[s]=[o],e.apply(null,i.concat([function(){n[s]=arguments;var e=r[s];delete r[s];for(var t=0,i=e.length;i>t;t++)e[t].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=e,i},s.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},s.times=function(e,t,n){for(var r=[],i=0;e>i;i++)r.push(i);return s.map(r,t,n)},s.timesSeries=function(e,t,n){for(var r=[],i=0;e>i;i++)r.push(i);return s.mapSeries(r,t,n)},s.compose=function(){var e=Array.prototype.reverse.call(arguments);return function(){var t=this,n=Array.prototype.slice.call(arguments),r=n.pop();s.reduce(e,n,function(e,n,r){n.apply(t,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);r(e,t)}]))},function(e,n){r.apply(t,[e].concat(n))})}};var j=function(e,t){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return e(t,function(e,t){e.apply(n,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};s.applyEach=p(j),s.applyEachSeries=h(j),s.forever=function(e,t){function n(r){if(r){if(t)return t(r);throw r}e(n)}n()},"undefined"!=typeof e&&e.amd?e([],function(){return s}):"undefined"!=typeof n&&n.exports?n.exports=s:i.async=s}()},{__browserify_process:71}],63:[function(e,t,n){function r(e){return"[object Array]"===c.call(e)}function i(e,t){var n;if(null===e)n={__proto__:null};else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var r=function(){};r.prototype=e,n=new r,n.__proto__=e}return"undefined"!=typeof t&&Object.defineProperties&&Object.defineProperties(n,t),n}function o(e){return"object"!=typeof e&&"function"!=typeof e||null===e}function s(e){if(o(e))throw new TypeError("Object.keys called on a non-object");var t=[];for(var n in e)l.call(e,n)&&t.push(n);return t}function a(e){if(o(e))throw new TypeError("Object.getOwnPropertyNames called on a non-object");var t=s(e);return n.isArray(e)&&-1===n.indexOf(e,"length")&&t.push("length"),t}function u(e,t){return{value:e[t]}}var c=Object.prototype.toString,l=Object.prototype.hasOwnProperty;n.isArray="function"==typeof Array.isArray?Array.isArray:r,n.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1},n.filter=function(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n},n.forEach=function(e,t,n){if(e.forEach)return e.forEach(t,n);for(var r=0;r<e.length;r++)t.call(n,e[r],r,e)},n.map=function(e,t){if(e.map)return e.map(t);for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=t(e[r],r,e);return n},n.reduce=function(e,t,n){if(e.reduce)return e.reduce(t,n);var r,i=!1;2<arguments.length&&(r=n,i=!0);for(var o=0,s=e.length;s>o;++o)e.hasOwnProperty(o)&&(i?r=t(r,e[o],o,e):(r=e[o],i=!0));return r},n.substr="b"!=="ab".substr(-1)?function(e,t,n){return 0>t&&(t=e.length+t),e.substr(t,n)}:function(e,t,n){return e.substr(t,n)},n.trim=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},n.bind=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(t.bind)return t.bind.apply(t,e);var n=e.shift();return function(){t.apply(n,e.concat([Array.prototype.slice.call(arguments)]))}},n.create="function"==typeof Object.create?Object.create:i;var f="function"==typeof Object.keys?Object.keys:s,p="function"==typeof Object.getOwnPropertyNames?Object.getOwnPropertyNames:a;if((new Error).hasOwnProperty("description")){var d=function(e,t){return"[object Error]"===c.call(e)&&(t=n.filter(t,function(e){return"description"!==e&&"number"!==e&&"message"!==e})),t};n.keys=function(e){return d(e,f(e))},n.getOwnPropertyNames=function(e){return d(e,p(e))}}else n.keys=f,n.getOwnPropertyNames=p;if("function"==typeof Object.getOwnPropertyDescriptor)try{Object.getOwnPropertyDescriptor({a:1},"a"),n.getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor}catch(h){n.getOwnPropertyDescriptor=function(e,t){try{return Object.getOwnPropertyDescriptor(e,t)}catch(n){return u(e,t)}}}else n.getOwnPropertyDescriptor=u},{}],64:[function(e,t){function n(e,t){return p.isUndefined(t)?""+t:!p.isNumber(t)||!isNaN(t)&&isFinite(t)?p.isFunction(t)||p.isRegExp(t)?t.toString():t:t.toString()}function r(e,t){return p.isString(e)?e.length<t?e:e.slice(0,t):e}function i(e){return r(JSON.stringify(e.actual,n),128)+" "+e.operator+" "+r(JSON.stringify(e.expected,n),128)}function o(e,t,n,r,i){throw new m.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function s(e,t){e||o(e,!0,t,"==",m.ok)}function a(e,t){if(e===t)return!0;if(p.isBuffer(e)&&p.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return p.isDate(e)&&p.isDate(t)?e.getTime()===t.getTime():p.isRegExp(e)&&p.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:p.isObject(e)||p.isObject(t)?c(e,t):e==t}function u(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function c(e,t){if(p.isNullOrUndefined(e)||p.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(u(e))return u(t)?(e=h.call(e),t=h.call(t),a(e,t)):!1;try{var n,r,i=d.keys(e),o=d.keys(t)}catch(s){return!1}if(i.length!=o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!a(e[n],t[n]))return!1;return!0}function l(e,t){return e&&t?"[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t?!0:t.call({},e)===!0?!0:!1:!1}function f(e,t,n,r){var i;p.isString(n)&&(r=n,n=null);try{t()}catch(s){i=s}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&o(i,n,"Missing expected exception"+r),!e&&l(i,n)&&o(i,n,"Got unwanted exception"+r),e&&i&&n&&!l(i,n)||!e&&i)throw i}var p=e("util"),d=e("_shims"),h=Array.prototype.slice,m=t.exports=s;m.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,this.message=e.message||i(this)},p.inherits(m.AssertionError,Error),m.fail=o,m.ok=s,m.equal=function(e,t,n){e!=t&&o(e,t,n,"==",m.equal)},m.notEqual=function(e,t,n){e==t&&o(e,t,n,"!=",m.notEqual)},m.deepEqual=function(e,t,n){a(e,t)||o(e,t,n,"deepEqual",m.deepEqual)},m.notDeepEqual=function(e,t,n){a(e,t)&&o(e,t,n,"notDeepEqual",m.notDeepEqual)},m.strictEqual=function(e,t,n){e!==t&&o(e,t,n,"===",m.strictEqual)},m.notStrictEqual=function(e,t,n){e===t&&o(e,t,n,"!==",m.notStrictEqual)},m.throws=function(){f.apply(this,[!0].concat(h.call(arguments)))},m.doesNotThrow=function(){f.apply(this,[!1].concat(h.call(arguments)))},m.ifError=function(e){if(e)throw e}},{_shims:63,util:66}],65:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var r=e("util");t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!r.isNumber(e)||0>e)throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,o,s,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r.isObject(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(n=this._events[e],r.isUndefined(n))return!1;if(r.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,o=new Array(i-1),s=1;i>s;s++)o[s-1]=arguments[s];n.apply(this,o)}else if(r.isObject(n)){for(i=arguments.length,o=new Array(i-1),s=1;i>s;s++)o[s-1]=arguments[s];for(a=n.slice(),i=a.length,s=0;i>s;s++)a[s].apply(this,o)}return!0},n.prototype.addListener=function(e,t){var i;if(!r.isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r.isFunction(t.listener)?t.listener:t),this._events[e]?r.isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r.isObject(this._events[e])&&!this._events[e].warned){var i;i=r.isUndefined(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),t.apply(this,arguments)}if(!r.isFunction(t))throw TypeError("listener must be a function");return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,o,s;if(!r.isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,i=-1,n===t||r.isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r.isObject(n)){for(s=o;s-->0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r.isFunction(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r.isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r.isFunction(e._events[t])?1:e._events[t].length:0}},{util:66}],66:[function(e,t,n){function r(e,t){var r={seen:[],stylize:o};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(t)?r.showHidden=t:t&&n._extend(r,t),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),a(r,e,r.depth)}function i(e,t){var n=r.styles[t];return n?"["+r.colors[n][0]+"m"+e+"["+r.colors[n][1]+"m":e}function o(e){return e}function s(e){var t={};return T.forEach(e,function(e){t[e]=!0}),t}function a(e,t,r){if(e.customInspect&&t&&_(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r);return v(i)||(i=a(e,i,r)),i}var o=u(e,t);if(o)return o;var h=T.keys(t),m=s(h);if(e.showHidden&&(h=T.getOwnPropertyNames(t)),0===h.length){if(_(t)){var g=t.name?": "+t.name:"";return e.stylize("[Function"+g+"]","special")}if(w(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(j(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return c(t)}var b="",y=!1,x=["{","}"];if(d(t)&&(y=!0,x=["[","]"]),_(t)){var S=t.name?": "+t.name:"";b=" [Function"+S+"]"}if(w(t)&&(b=" "+RegExp.prototype.toString.call(t)),j(t)&&(b=" "+Date.prototype.toUTCString.call(t)),E(t)&&(b=" "+c(t)),0===h.length&&(!y||0==t.length))return x[0]+b+x[1];if(0>r)return w(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var A;return A=y?l(e,t,r,m,h):h.map(function(n){return f(e,t,r,m,n,y)}),e.seen.pop(),p(A,b,x)}function u(e,t){if(x(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,r,i){for(var o=[],s=0,a=t.length;a>s;++s)N(t,String(s))?o.push(f(e,t,n,r,String(s),!0)):o.push("");return T.forEach(i,function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))}),o}function f(e,t,n,r,i,o){var s,u,c;if(c=T.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),N(r,i)||(s="["+i+"]"),u||(T.indexOf(e.seen,c.value)<0?(u=m(n)?a(e,c.value,null):a(e,c.value,n-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),x(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function p(e,t,n){var r=0,i=T.reduce(e,function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function d(e){return T.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return null==e}function b(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return"symbol"==typeof e}function x(e){return void 0===e}function w(e){return S(e)&&"[object RegExp]"===C(e)}function S(e){return"object"==typeof e&&e}function j(e){return S(e)&&"[object Date]"===C(e)}function E(e){return S(e)&&"[object Error]"===C(e)}function _(e){return"function"==typeof e}function A(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function k(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.binarySlice}function C(e){return Object.prototype.toString.call(e)}function O(e){return 10>e?"0"+e.toString(10):e.toString(10)}function I(){var e=new Date,t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),q[e.getMonth()],t].join(" ")}function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var T=e("_shims"),M=/%[sdj%]/g;n.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(r(arguments[n]));return t.join(" ")}for(var n=1,i=arguments,o=i.length,s=String(e).replace(M,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return e}}),a=i[n];o>n;a=i[++n])s+=m(a)||!S(a)?" "+a:" "+r(a);return s},n.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=h,n.isNull=m,n.isNullOrUndefined=g,n.isNumber=b,n.isString=v,n.isSymbol=y,n.isUndefined=x,n.isRegExp=w,n.isObject=S,n.isDate=j,n.isError=E,n.isFunction=_,n.isPrimitive=A,n.isBuffer=k;var q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",I(),n.format.apply(n,arguments))},n.inherits=function(e,t){e.super_=t,e.prototype=T.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},n._extend=function(e,t){if(!t||!S(t))return e;for(var n=T.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}},{_shims:63}],67:[function(e,t,n){n.readIEEE754=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,f=n?0:i-1,p=n?1:-1,d=e[t+f];for(f+=p,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=p,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+f],f+=p,l-=8);if(0===o)o=1-c;else{if(o===u)return s?0/0:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},n.writeIEEE754=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?o-1:0,h=r?-1:1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+f>=1?p/u:p*Math.pow(2,1-f),t*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*u-1)*Math.pow(2,i),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=h,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+d]=255&s,d+=h,s/=256,c-=8);e[n+d-h]|=128*m}},{}],68:[function(e,t,n){function r(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function i(t,n,o){if(I||(I=e("assert")),!(this instanceof i))return new i(t,n,o);if(this.parent=this,this.offset=0,"base64"==n&&"string"==typeof t)for(t=r(t);0!=t.length%4;)t+="=";var a;if("number"==typeof o){this.length=s(n);for(var c=0;c<this.length;c++)this[c]=t.get(c+o)}else{switch(a=typeof t){case"number":this.length=s(t);break;case"string":this.length=i.byteLength(t,n);break;case"object":this.length=s(t.length);break;default:throw new Error("First argument needs to be a number, array or string.")}if(u(t))for(var c=0;c<this.length;c++)this[c]=t instanceof i?t.readUInt8(c):t[c];else if("string"==a)this.length=this.write(t,0,n);else if("number"===a)for(var c=0;c<this.length;c++)this[c]=0}}function o(e,t,n){return"number"!=typeof e?n:(e=~~e,e>=t?t:e>=0?e:(e+=t,e>=0?e:0))}function s(e){return e=~~Math.ceil(+e),0>e?0:e}function a(e){return(Array.isArray||function(e){return"[object Array]"=={}.toString.apply(e)})(e)}function u(e){return a(e)||i.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function c(e){return 16>e?"0"+e.toString(16):e.toString(16)}function l(e){for(var t=[],n=0;n<e.length;n++)if(e.charCodeAt(n)<=127)t.push(e.charCodeAt(n));else for(var r=encodeURIComponent(e.charAt(n)).substr(1).split("%"),i=0;i<r.length;i++)t.push(parseInt(r[i],16));return t}function f(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function p(t){return e("base64-js").toByteArray(t)}function d(e,t,n,r){for(var i=0;r>i&&!(i+n>=t.length||i>=e.length);)t[i+n]=e[i],i++;return i}function h(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function m(e,t,n,r){var i=0;return r||(I.ok("boolean"==typeof n,"missing or invalid endian"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t+1<e.length,"Trying to read beyond buffer length")),t>=e.length?0:(n?(i=e[t]<<8,t+1<e.length&&(i|=e[t+1])):(i=e[t],t+1<e.length&&(i|=e[t+1]<<8)),i)}function g(e,t,n,r){var i=0;return r||(I.ok("boolean"==typeof n,"missing or invalid endian"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t+3<e.length,"Trying to read beyond buffer length")),t>=e.length?0:(n?(t+1<e.length&&(i=e[t+1]<<16),t+2<e.length&&(i|=e[t+2]<<8),t+3<e.length&&(i|=e[t+3]),i+=e[t]<<24>>>0):(t+2<e.length&&(i=e[t+2]<<16),t+1<e.length&&(i|=e[t+1]<<8),i|=e[t],t+3<e.length&&(i+=e[t+3]<<24>>>0)),i)}function b(e,t,n,r){var i,o;return r||(I.ok("boolean"==typeof n,"missing or invalid endian"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t+1<e.length,"Trying to read beyond buffer length")),o=m(e,t,n,r),i=32768&o,i?-1*(65535-o+1):o}function v(e,t,n,r){var i,o;return r||(I.ok("boolean"==typeof n,"missing or invalid endian"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t+3<e.length,"Trying to read beyond buffer length")),o=g(e,t,n,r),i=2147483648&o,i?-1*(4294967295-o+1):o}function y(t,n,r,i){return i||(I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(n+3<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,r,23,4)}function x(t,n,r,i){return i||(I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(n+7<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,r,52,8)}function w(e,t){I.ok("number"==typeof e,"cannot write a non-number as a number"),I.ok(e>=0,"specified a negative value for writing an unsigned value"),I.ok(t>=e,"value is larger than maximum value for type"),I.ok(Math.floor(e)===e,"value has a fractional component")}function S(e,t,n,r,i){i||(I.ok(void 0!==t&&null!==t,"missing value"),I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(void 0!==n&&null!==n,"missing offset"),I.ok(n+1<e.length,"trying to write beyond buffer length"),w(t,65535));for(var o=0;o<Math.min(e.length-n,2);o++)e[n+o]=(t&255<<8*(r?1-o:o))>>>8*(r?1-o:o)}function j(e,t,n,r,i){i||(I.ok(void 0!==t&&null!==t,"missing value"),I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(void 0!==n&&null!==n,"missing offset"),I.ok(n+3<e.length,"trying to write beyond buffer length"),w(t,4294967295));for(var o=0;o<Math.min(e.length-n,4);o++)e[n+o]=255&t>>>8*(r?3-o:o)}function E(e,t,n){I.ok("number"==typeof e,"cannot write a non-number as a number"),I.ok(t>=e,"value larger than maximum allowed value"),I.ok(e>=n,"value smaller than minimum allowed value"),I.ok(Math.floor(e)===e,"value has a fractional component")}function _(e,t,n){I.ok("number"==typeof e,"cannot write a non-number as a number"),I.ok(t>=e,"value larger than maximum allowed value"),I.ok(e>=n,"value smaller than minimum allowed value")}function A(e,t,n,r,i){i||(I.ok(void 0!==t&&null!==t,"missing value"),I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(void 0!==n&&null!==n,"missing offset"),I.ok(n+1<e.length,"Trying to write beyond buffer length"),E(t,32767,-32768)),t>=0?S(e,t,n,r,i):S(e,65535+t+1,n,r,i)}function k(e,t,n,r,i){i||(I.ok(void 0!==t&&null!==t,"missing value"),I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(void 0!==n&&null!==n,"missing offset"),I.ok(n+3<e.length,"Trying to write beyond buffer length"),E(t,2147483647,-2147483648)),t>=0?j(e,t,n,r,i):j(e,4294967295+t+1,n,r,i)}function C(t,n,r,i,o){o||(I.ok(void 0!==n&&null!==n,"missing value"),I.ok("boolean"==typeof i,"missing or invalid endian"),I.ok(void 0!==r&&null!==r,"missing offset"),I.ok(r+3<t.length,"Trying to write beyond buffer length"),_(n,3.4028234663852886e38,-3.4028234663852886e38)),e("./buffer_ieee754").writeIEEE754(t,n,r,i,23,4)}function O(t,n,r,i,o){o||(I.ok(void 0!==n&&null!==n,"missing value"),I.ok("boolean"==typeof i,"missing or invalid endian"),I.ok(void 0!==r&&null!==r,"missing offset"),I.ok(r+7<t.length,"Trying to write beyond buffer length"),_(n,1.7976931348623157e308,-1.7976931348623157e308)),e("./buffer_ieee754").writeIEEE754(t,n,r,i,52,8)}var I;n.Buffer=i,n.SlowBuffer=i,i.poolSize=8192,n.INSPECT_MAX_BYTES=50,i.prototype.get=function(e){if(0>e||e>=this.length)throw new Error("oob");return this[e]},i.prototype.set=function(e,t){if(0>e||e>=this.length)throw new Error("oob");return this[e]=t},i.byteLength=function(e,t){switch(t||"utf8"){case"hex":return e.length/2;case"utf8":case"utf-8":return l(e).length;case"ascii":case"binary":return e.length;case"base64":return p(e).length;default:throw new Error("Unknown encoding")}},i.prototype.utf8Write=function(e,t,n){return i._charsWritten=d(l(e),this,t,n)},i.prototype.asciiWrite=function(e,t,n){return i._charsWritten=d(f(e),this,t,n)},i.prototype.binaryWrite=i.prototype.asciiWrite,i.prototype.base64Write=function(e,t,n){return i._charsWritten=d(p(e),this,t,n)},i.prototype.base64Slice=function(){var t=Array.prototype.slice.apply(this,arguments);return e("base64-js").fromByteArray(t)},i.prototype.utf8Slice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n="",r=0;r<e.length;)e[r]<=127?(t+=h(n)+String.fromCharCode(e[r]),n=""):n+="%"+e[r].toString(16),r++;return t+h(n)},i.prototype.asciiSlice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},i.prototype.binarySlice=i.prototype.asciiSlice,i.prototype.inspect=function(){for(var e=[],t=this.length,r=0;t>r;r++)if(e[r]=c(this[r]),r==n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},i.prototype.hexSlice=function(e,t){var n=this.length;(!e||0>e)&&(e=0),(!t||0>t||t>n)&&(t=n);for(var r="",i=e;t>i;i++)r+=c(this[i]);return r},i.prototype.toString=function(e,t,n){if(e=String(e||"utf8").toLowerCase(),t=+t||0,"undefined"==typeof n&&(n=this.length),+n==t)return"";switch(e){case"hex":return this.hexSlice(t,n);case"utf8":case"utf-8":return this.utf8Slice(t,n);case"ascii":return this.asciiSlice(t,n);case"binary":return this.binarySlice(t,n);case"base64":return this.base64Slice(t,n);case"ucs2":case"ucs-2":return this.ucs2Slice(t,n);default:throw new Error("Unknown encoding")}},i.prototype.hexWrite=function(e,t,n){t=+t||0;var r=this.length-t;n?(n=+n,n>r&&(n=r)):n=r;var o=e.length;if(o%2)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;n>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");this[t+s]=a}return i._charsWritten=2*s,s},i.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=void 0);else{var i=r;
r=t,t=n,n=i}t=+t||0;var o=this.length-t;switch(n?(n=+n,n>o&&(n=o)):n=o,r=String(r||"utf8").toLowerCase()){case"hex":return this.hexWrite(e,t,n);case"utf8":case"utf-8":return this.utf8Write(e,t,n);case"ascii":return this.asciiWrite(e,t,n);case"binary":return this.binaryWrite(e,t,n);case"base64":return this.base64Write(e,t,n);case"ucs2":case"ucs-2":return this.ucs2Write(e,t,n);default:throw new Error("Unknown encoding")}},i.prototype.slice=function(e,t){var n=this.length;return e=o(e,n,0),t=o(t,n,n),new i(this,t-e,+e)},i.prototype.copy=function(e,t,n,r){var i=this;if(n||(n=0),(void 0===r||isNaN(r))&&(r=this.length),t||(t=0),n>r)throw new Error("sourceEnd < sourceStart");if(r===n)return 0;if(0==e.length||0==i.length)return 0;if(0>t||t>=e.length)throw new Error("targetStart out of bounds");if(0>n||n>=i.length)throw new Error("sourceStart out of bounds");if(0>r||r>i.length)throw new Error("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);for(var o=[],s=n;r>s;s++)I.ok("undefined"!=typeof this[s],"copying undefined buffer bytes!"),o.push(this[s]);for(var s=t;s<t+o.length;s++)e[s]=o[s-t]},i.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),"number"!=typeof e||isNaN(e))throw new Error("value is not a number");if(t>n)throw new Error("end < start");if(n===t)return 0;if(0==this.length)return 0;if(0>t||t>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");for(var r=t;n>r;r++)this[r]=e},i.isBuffer=function(e){return e instanceof i||e instanceof i},i.concat=function(e,t){if(!a(e))throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.");if(0===e.length)return new i(0);if(1===e.length)return e[0];if("number"!=typeof t){t=0;for(var n=0;n<e.length;n++){var r=e[n];t+=r.length}}for(var o=new i(t),s=0,n=0;n<e.length;n++){var r=e[n];r.copy(o,s),s+=r.length}return o},i.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},i.prototype.readUInt8=function(e,t){var n=this;return t||(I.ok(void 0!==e&&null!==e,"missing offset"),I.ok(e<n.length,"Trying to read beyond buffer length")),e>=n.length?void 0:n[e]},i.prototype.readUInt16LE=function(e,t){return m(this,e,!1,t)},i.prototype.readUInt16BE=function(e,t){return m(this,e,!0,t)},i.prototype.readUInt32LE=function(e,t){return g(this,e,!1,t)},i.prototype.readUInt32BE=function(e,t){return g(this,e,!0,t)},i.prototype.readInt8=function(e,t){var n,r=this;return t||(I.ok(void 0!==e&&null!==e,"missing offset"),I.ok(e<r.length,"Trying to read beyond buffer length")),e>=r.length?void 0:(n=128&r[e],n?-1*(255-r[e]+1):r[e])},i.prototype.readInt16LE=function(e,t){return b(this,e,!1,t)},i.prototype.readInt16BE=function(e,t){return b(this,e,!0,t)},i.prototype.readInt32LE=function(e,t){return v(this,e,!1,t)},i.prototype.readInt32BE=function(e,t){return v(this,e,!0,t)},i.prototype.readFloatLE=function(e,t){return y(this,e,!1,t)},i.prototype.readFloatBE=function(e,t){return y(this,e,!0,t)},i.prototype.readDoubleLE=function(e,t){return x(this,e,!1,t)},i.prototype.readDoubleBE=function(e,t){return x(this,e,!0,t)},i.prototype.writeUInt8=function(e,t,n){var r=this;n||(I.ok(void 0!==e&&null!==e,"missing value"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t<r.length,"trying to write beyond buffer length"),w(e,255)),t<r.length&&(r[t]=e)},i.prototype.writeUInt16LE=function(e,t,n){S(this,e,t,!1,n)},i.prototype.writeUInt16BE=function(e,t,n){S(this,e,t,!0,n)},i.prototype.writeUInt32LE=function(e,t,n){j(this,e,t,!1,n)},i.prototype.writeUInt32BE=function(e,t,n){j(this,e,t,!0,n)},i.prototype.writeInt8=function(e,t,n){var r=this;n||(I.ok(void 0!==e&&null!==e,"missing value"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t<r.length,"Trying to write beyond buffer length"),E(e,127,-128)),e>=0?r.writeUInt8(e,t,n):r.writeUInt8(255+e+1,t,n)},i.prototype.writeInt16LE=function(e,t,n){A(this,e,t,!1,n)},i.prototype.writeInt16BE=function(e,t,n){A(this,e,t,!0,n)},i.prototype.writeInt32LE=function(e,t,n){k(this,e,t,!1,n)},i.prototype.writeInt32BE=function(e,t,n){k(this,e,t,!0,n)},i.prototype.writeFloatLE=function(e,t,n){C(this,e,t,!1,n)},i.prototype.writeFloatBE=function(e,t,n){C(this,e,t,!0,n)},i.prototype.writeDoubleLE=function(e,t,n){O(this,e,t,!1,n)},i.prototype.writeDoubleBE=function(e,t,n){O(this,e,t,!0,n)}},{"./buffer_ieee754":67,assert:64,"base64-js":69}],69:[function(e,t){!function(){"use strict";function e(e){var t,n,i,o,s,a;if(e.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(s=e.indexOf("="),s=s>0?e.length-s:0,a=[],i=s>0?e.length-4:e.length,t=0,n=0;i>t;t+=4,n+=3)o=r.indexOf(e[t])<<18|r.indexOf(e[t+1])<<12|r.indexOf(e[t+2])<<6|r.indexOf(e[t+3]),a.push((16711680&o)>>16),a.push((65280&o)>>8),a.push(255&o);return 2===s?(o=r.indexOf(e[t])<<2|r.indexOf(e[t+1])>>4,a.push(255&o)):1===s&&(o=r.indexOf(e[t])<<10|r.indexOf(e[t+1])<<4|r.indexOf(e[t+2])>>2,a.push(255&o>>8),a.push(255&o)),a}function n(e){function t(e){return r[63&e>>18]+r[63&e>>12]+r[63&e>>6]+r[63&e]}var n,i,o,s=e.length%3,a="";for(n=0,o=e.length-s;o>n;n+=3)i=(e[n]<<16)+(e[n+1]<<8)+e[n+2],a+=t(i);switch(s){case 1:i=e[e.length-1],a+=r[i>>2],a+=r[63&i<<4],a+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1],a+=r[i>>10],a+=r[63&i>>4],a+=r[63&i<<2],a+="="}return a}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports.toByteArray=e,t.exports.fromByteArray=n}()},{}],70:[function(e,t){e=function n(t,r,i){function o(a,u){if(!r[a]){if(!t[a]){var c="function"==typeof e&&e;if(!u&&c)return c(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return o(n?n:e)},l,l.exports,n,t,r,i)}return r[a].exports}for(var s="function"==typeof e&&e,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,n){n.readIEEE754=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,f=n?0:i-1,p=n?1:-1,d=e[t+f];for(f+=p,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=p,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+f],f+=p,l-=8);if(0===o)o=1-c;else{if(o===u)return s?0/0:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},n.writeIEEE754=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?o-1:0,h=r?-1:1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+f>=1?p/u:p*Math.pow(2,1-f),t*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*u-1)*Math.pow(2,i),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=h,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+d]=255&s,d+=h,s/=256,c-=8);e[n+d-h]|=128*m}},{}],q9TxCC:[function(e,t,n){function r(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function i(t,n,o){if(I||(I=e("assert")),!(this instanceof i))return new i(t,n,o);if(this.parent=this,this.offset=0,"base64"==n&&"string"==typeof t)for(t=r(t);0!=t.length%4;)t+="=";var a;if("number"==typeof o){this.length=s(n);for(var c=0;c<this.length;c++)this[c]=t.get(c+o)}else{switch(a=typeof t){case"number":this.length=s(t);break;case"string":this.length=i.byteLength(t,n);break;case"object":this.length=s(t.length);break;default:throw new Error("First argument needs to be a number, array or string.")}if(u(t))for(var c=0;c<this.length;c++)this[c]=t instanceof i?t.readUInt8(c):t[c];else if("string"==a)this.length=this.write(t,0,n);else if("number"===a)for(var c=0;c<this.length;c++)this[c]=0}}function o(e,t,n){return"number"!=typeof e?n:(e=~~e,e>=t?t:e>=0?e:(e+=t,e>=0?e:0))}function s(e){return e=~~Math.ceil(+e),0>e?0:e}function a(e){return(Array.isArray||function(e){return"[object Array]"=={}.toString.apply(e)})(e)}function u(e){return a(e)||i.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function c(e){return 16>e?"0"+e.toString(16):e.toString(16)}function l(e){for(var t=[],n=0;n<e.length;n++)if(e.charCodeAt(n)<=127)t.push(e.charCodeAt(n));else for(var r=encodeURIComponent(e.charAt(n)).substr(1).split("%"),i=0;i<r.length;i++)t.push(parseInt(r[i],16));return t}function f(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function p(t){return e("base64-js").toByteArray(t)}function d(e,t,n,r){for(var i=0;r>i&&!(i+n>=t.length||i>=e.length);)t[i+n]=e[i],i++;return i}function h(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function m(e,t,n,r){var i=0;return r||(I.ok("boolean"==typeof n,"missing or invalid endian"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t+1<e.length,"Trying to read beyond buffer length")),t>=e.length?0:(n?(i=e[t]<<8,t+1<e.length&&(i|=e[t+1])):(i=e[t],t+1<e.length&&(i|=e[t+1]<<8)),i)}function g(e,t,n,r){var i=0;return r||(I.ok("boolean"==typeof n,"missing or invalid endian"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t+3<e.length,"Trying to read beyond buffer length")),t>=e.length?0:(n?(t+1<e.length&&(i=e[t+1]<<16),t+2<e.length&&(i|=e[t+2]<<8),t+3<e.length&&(i|=e[t+3]),i+=e[t]<<24>>>0):(t+2<e.length&&(i=e[t+2]<<16),t+1<e.length&&(i|=e[t+1]<<8),i|=e[t],t+3<e.length&&(i+=e[t+3]<<24>>>0)),i)}function b(e,t,n,r){var i,o;return r||(I.ok("boolean"==typeof n,"missing or invalid endian"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t+1<e.length,"Trying to read beyond buffer length")),o=m(e,t,n,r),i=32768&o,i?-1*(65535-o+1):o}function v(e,t,n,r){var i,o;return r||(I.ok("boolean"==typeof n,"missing or invalid endian"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t+3<e.length,"Trying to read beyond buffer length")),o=g(e,t,n,r),i=2147483648&o,i?-1*(4294967295-o+1):o}function y(t,n,r,i){return i||(I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(n+3<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,r,23,4)}function x(t,n,r,i){return i||(I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(n+7<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,r,52,8)}function w(e,t){I.ok("number"==typeof e,"cannot write a non-number as a number"),I.ok(e>=0,"specified a negative value for writing an unsigned value"),I.ok(t>=e,"value is larger than maximum value for type"),I.ok(Math.floor(e)===e,"value has a fractional component")}function S(e,t,n,r,i){i||(I.ok(void 0!==t&&null!==t,"missing value"),I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(void 0!==n&&null!==n,"missing offset"),I.ok(n+1<e.length,"trying to write beyond buffer length"),w(t,65535));for(var o=0;o<Math.min(e.length-n,2);o++)e[n+o]=(t&255<<8*(r?1-o:o))>>>8*(r?1-o:o)}function j(e,t,n,r,i){i||(I.ok(void 0!==t&&null!==t,"missing value"),I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(void 0!==n&&null!==n,"missing offset"),I.ok(n+3<e.length,"trying to write beyond buffer length"),w(t,4294967295));for(var o=0;o<Math.min(e.length-n,4);o++)e[n+o]=255&t>>>8*(r?3-o:o)}function E(e,t,n){I.ok("number"==typeof e,"cannot write a non-number as a number"),I.ok(t>=e,"value larger than maximum allowed value"),I.ok(e>=n,"value smaller than minimum allowed value"),I.ok(Math.floor(e)===e,"value has a fractional component")}function _(e,t,n){I.ok("number"==typeof e,"cannot write a non-number as a number"),I.ok(t>=e,"value larger than maximum allowed value"),I.ok(e>=n,"value smaller than minimum allowed value")}function A(e,t,n,r,i){i||(I.ok(void 0!==t&&null!==t,"missing value"),I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(void 0!==n&&null!==n,"missing offset"),I.ok(n+1<e.length,"Trying to write beyond buffer length"),E(t,32767,-32768)),t>=0?S(e,t,n,r,i):S(e,65535+t+1,n,r,i)}function k(e,t,n,r,i){i||(I.ok(void 0!==t&&null!==t,"missing value"),I.ok("boolean"==typeof r,"missing or invalid endian"),I.ok(void 0!==n&&null!==n,"missing offset"),I.ok(n+3<e.length,"Trying to write beyond buffer length"),E(t,2147483647,-2147483648)),t>=0?j(e,t,n,r,i):j(e,4294967295+t+1,n,r,i)}function C(t,n,r,i,o){o||(I.ok(void 0!==n&&null!==n,"missing value"),I.ok("boolean"==typeof i,"missing or invalid endian"),I.ok(void 0!==r&&null!==r,"missing offset"),I.ok(r+3<t.length,"Trying to write beyond buffer length"),_(n,3.4028234663852886e38,-3.4028234663852886e38)),e("./buffer_ieee754").writeIEEE754(t,n,r,i,23,4)}function O(t,n,r,i,o){o||(I.ok(void 0!==n&&null!==n,"missing value"),I.ok("boolean"==typeof i,"missing or invalid endian"),I.ok(void 0!==r&&null!==r,"missing offset"),I.ok(r+7<t.length,"Trying to write beyond buffer length"),_(n,1.7976931348623157e308,-1.7976931348623157e308)),e("./buffer_ieee754").writeIEEE754(t,n,r,i,52,8)}var I;n.Buffer=i,n.SlowBuffer=i,i.poolSize=8192,n.INSPECT_MAX_BYTES=50,i.prototype.get=function(e){if(0>e||e>=this.length)throw new Error("oob");return this[e]},i.prototype.set=function(e,t){if(0>e||e>=this.length)throw new Error("oob");return this[e]=t},i.byteLength=function(e,t){switch(t||"utf8"){case"hex":return e.length/2;case"utf8":case"utf-8":return l(e).length;case"ascii":case"binary":return e.length;case"base64":return p(e).length;default:throw new Error("Unknown encoding")}},i.prototype.utf8Write=function(e,t,n){return i._charsWritten=d(l(e),this,t,n)},i.prototype.asciiWrite=function(e,t,n){return i._charsWritten=d(f(e),this,t,n)},i.prototype.binaryWrite=i.prototype.asciiWrite,i.prototype.base64Write=function(e,t,n){return i._charsWritten=d(p(e),this,t,n)},i.prototype.base64Slice=function(){var t=Array.prototype.slice.apply(this,arguments);return e("base64-js").fromByteArray(t)},i.prototype.utf8Slice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n="",r=0;r<e.length;)e[r]<=127?(t+=h(n)+String.fromCharCode(e[r]),n=""):n+="%"+e[r].toString(16),r++;return t+h(n)},i.prototype.asciiSlice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},i.prototype.binarySlice=i.prototype.asciiSlice,i.prototype.inspect=function(){for(var e=[],t=this.length,r=0;t>r;r++)if(e[r]=c(this[r]),r==n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},i.prototype.hexSlice=function(e,t){var n=this.length;(!e||0>e)&&(e=0),(!t||0>t||t>n)&&(t=n);for(var r="",i=e;t>i;i++)r+=c(this[i]);return r},i.prototype.toString=function(e,t,n){if(e=String(e||"utf8").toLowerCase(),t=+t||0,"undefined"==typeof n&&(n=this.length),+n==t)return"";switch(e){case"hex":return this.hexSlice(t,n);case"utf8":case"utf-8":return this.utf8Slice(t,n);case"ascii":return this.asciiSlice(t,n);case"binary":return this.binarySlice(t,n);case"base64":return this.base64Slice(t,n);case"ucs2":case"ucs-2":return this.ucs2Slice(t,n);default:throw new Error("Unknown encoding")}},i.prototype.hexWrite=function(e,t,n){t=+t||0;var r=this.length-t;n?(n=+n,n>r&&(n=r)):n=r;var o=e.length;if(o%2)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;n>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");this[t+s]=a}return i._charsWritten=2*s,s},i.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=void 0);else{var i=r;r=t,t=n,n=i}t=+t||0;var o=this.length-t;switch(n?(n=+n,n>o&&(n=o)):n=o,r=String(r||"utf8").toLowerCase()){case"hex":return this.hexWrite(e,t,n);case"utf8":case"utf-8":return this.utf8Write(e,t,n);case"ascii":return this.asciiWrite(e,t,n);case"binary":return this.binaryWrite(e,t,n);case"base64":return this.base64Write(e,t,n);case"ucs2":case"ucs-2":return this.ucs2Write(e,t,n);default:throw new Error("Unknown encoding")}},i.prototype.slice=function(e,t){var n=this.length;return e=o(e,n,0),t=o(t,n,n),new i(this,t-e,+e)},i.prototype.copy=function(e,t,n,r){var i=this;if(n||(n=0),(void 0===r||isNaN(r))&&(r=this.length),t||(t=0),n>r)throw new Error("sourceEnd < sourceStart");if(r===n)return 0;if(0==e.length||0==i.length)return 0;if(0>t||t>=e.length)throw new Error("targetStart out of bounds");if(0>n||n>=i.length)throw new Error("sourceStart out of bounds");if(0>r||r>i.length)throw new Error("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);for(var o=[],s=n;r>s;s++)I.ok("undefined"!=typeof this[s],"copying undefined buffer bytes!"),o.push(this[s]);for(var s=t;s<t+o.length;s++)e[s]=o[s-t]},i.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),"number"!=typeof e||isNaN(e))throw new Error("value is not a number");if(t>n)throw new Error("end < start");if(n===t)return 0;if(0==this.length)return 0;if(0>t||t>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");for(var r=t;n>r;r++)this[r]=e},i.isBuffer=function(e){return e instanceof i||e instanceof i},i.concat=function(e,t){if(!a(e))throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.");if(0===e.length)return new i(0);if(1===e.length)return e[0];if("number"!=typeof t){t=0;for(var n=0;n<e.length;n++){var r=e[n];t+=r.length}}for(var o=new i(t),s=0,n=0;n<e.length;n++){var r=e[n];r.copy(o,s),s+=r.length}return o},i.isEncoding=function(e){switch((e+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},i.prototype.readUInt8=function(e,t){var n=this;return t||(I.ok(void 0!==e&&null!==e,"missing offset"),I.ok(e<n.length,"Trying to read beyond buffer length")),e>=n.length?void 0:n[e]},i.prototype.readUInt16LE=function(e,t){return m(this,e,!1,t)},i.prototype.readUInt16BE=function(e,t){return m(this,e,!0,t)},i.prototype.readUInt32LE=function(e,t){return g(this,e,!1,t)},i.prototype.readUInt32BE=function(e,t){return g(this,e,!0,t)},i.prototype.readInt8=function(e,t){var n,r=this;return t||(I.ok(void 0!==e&&null!==e,"missing offset"),I.ok(e<r.length,"Trying to read beyond buffer length")),e>=r.length?void 0:(n=128&r[e],n?-1*(255-r[e]+1):r[e])},i.prototype.readInt16LE=function(e,t){return b(this,e,!1,t)},i.prototype.readInt16BE=function(e,t){return b(this,e,!0,t)},i.prototype.readInt32LE=function(e,t){return v(this,e,!1,t)},i.prototype.readInt32BE=function(e,t){return v(this,e,!0,t)},i.prototype.readFloatLE=function(e,t){return y(this,e,!1,t)},i.prototype.readFloatBE=function(e,t){return y(this,e,!0,t)},i.prototype.readDoubleLE=function(e,t){return x(this,e,!1,t)},i.prototype.readDoubleBE=function(e,t){return x(this,e,!0,t)},i.prototype.writeUInt8=function(e,t,n){var r=this;n||(I.ok(void 0!==e&&null!==e,"missing value"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t<r.length,"trying to write beyond buffer length"),w(e,255)),t<r.length&&(r[t]=e)},i.prototype.writeUInt16LE=function(e,t,n){S(this,e,t,!1,n)},i.prototype.writeUInt16BE=function(e,t,n){S(this,e,t,!0,n)},i.prototype.writeUInt32LE=function(e,t,n){j(this,e,t,!1,n)},i.prototype.writeUInt32BE=function(e,t,n){j(this,e,t,!0,n)},i.prototype.writeInt8=function(e,t,n){var r=this;n||(I.ok(void 0!==e&&null!==e,"missing value"),I.ok(void 0!==t&&null!==t,"missing offset"),I.ok(t<r.length,"Trying to write beyond buffer length"),E(e,127,-128)),e>=0?r.writeUInt8(e,t,n):r.writeUInt8(255+e+1,t,n)},i.prototype.writeInt16LE=function(e,t,n){A(this,e,t,!1,n)},i.prototype.writeInt16BE=function(e,t,n){A(this,e,t,!0,n)},i.prototype.writeInt32LE=function(e,t,n){k(this,e,t,!1,n)},i.prototype.writeInt32BE=function(e,t,n){k(this,e,t,!0,n)},i.prototype.writeFloatLE=function(e,t,n){C(this,e,t,!1,n)},i.prototype.writeFloatBE=function(e,t,n){C(this,e,t,!0,n)},i.prototype.writeDoubleLE=function(e,t,n){O(this,e,t,!1,n)},i.prototype.writeDoubleBE=function(e,t,n){O(this,e,t,!0,n)}},{"./buffer_ieee754":1,assert:6,"base64-js":4}],"buffer-browserify":[function(e,t){t.exports=e("q9TxCC")},{}],4:[function(e,t){!function(){"use strict";function e(e){var t,n,i,o,s,a;if(e.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(s=e.indexOf("="),s=s>0?e.length-s:0,a=[],i=s>0?e.length-4:e.length,t=0,n=0;i>t;t+=4,n+=3)o=r.indexOf(e[t])<<18|r.indexOf(e[t+1])<<12|r.indexOf(e[t+2])<<6|r.indexOf(e[t+3]),a.push((16711680&o)>>16),a.push((65280&o)>>8),a.push(255&o);return 2===s?(o=r.indexOf(e[t])<<2|r.indexOf(e[t+1])>>4,a.push(255&o)):1===s&&(o=r.indexOf(e[t])<<10|r.indexOf(e[t+1])<<4|r.indexOf(e[t+2])>>2,a.push(255&o>>8),a.push(255&o)),a}function n(e){function t(e){return r[63&e>>18]+r[63&e>>12]+r[63&e>>6]+r[63&e]}var n,i,o,s=e.length%3,a="";for(n=0,o=e.length-s;o>n;n+=3)i=(e[n]<<16)+(e[n+1]<<8)+e[n+2],a+=t(i);switch(s){case 1:i=e[e.length-1],a+=r[i>>2],a+=r[63&i<<4],a+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1],a+=r[i>>10],a+=r[63&i>>4],a+=r[63&i<<2],a+="="}return a}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports.toByteArray=e,t.exports.fromByteArray=n}()},{}],5:[function(e,t,n){function r(e){return"[object Array]"===c.call(e)}function i(e,t){var n;if(null===e)n={__proto__:null};else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var r=function(){};r.prototype=e,n=new r,n.__proto__=e}return"undefined"!=typeof t&&Object.defineProperties&&Object.defineProperties(n,t),n}function o(e){return"object"!=typeof e&&"function"!=typeof e||null===e}function s(e){if(o(e))throw new TypeError("Object.keys called on a non-object");var t=[];for(var n in e)l.call(e,n)&&t.push(n);return t}function a(e){if(o(e))throw new TypeError("Object.getOwnPropertyNames called on a non-object");var t=s(e);return n.isArray(e)&&-1===n.indexOf(e,"length")&&t.push("length"),t}function u(e,t){return{value:e[t]}}var c=Object.prototype.toString,l=Object.prototype.hasOwnProperty;n.isArray="function"==typeof Array.isArray?Array.isArray:r,n.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1},n.filter=function(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n},n.forEach=function(e,t,n){if(e.forEach)return e.forEach(t,n);for(var r=0;r<e.length;r++)t.call(n,e[r],r,e)},n.map=function(e,t){if(e.map)return e.map(t);for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=t(e[r],r,e);return n},n.reduce=function(e,t,n){if(e.reduce)return e.reduce(t,n);var r,i=!1;2<arguments.length&&(r=n,i=!0);for(var o=0,s=e.length;s>o;++o)e.hasOwnProperty(o)&&(i?r=t(r,e[o],o,e):(r=e[o],i=!0));return r},n.substr="b"!=="ab".substr(-1)?function(e,t,n){return 0>t&&(t=e.length+t),e.substr(t,n)}:function(e,t,n){return e.substr(t,n)},n.trim=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},n.bind=function(){var e=Array.prototype.slice.call(arguments),t=e.shift();if(t.bind)return t.bind.apply(t,e);var n=e.shift();return function(){t.apply(n,e.concat([Array.prototype.slice.call(arguments)]))}},n.create="function"==typeof Object.create?Object.create:i;var f="function"==typeof Object.keys?Object.keys:s,p="function"==typeof Object.getOwnPropertyNames?Object.getOwnPropertyNames:a;if((new Error).hasOwnProperty("description")){var d=function(e,t){return"[object Error]"===c.call(e)&&(t=n.filter(t,function(e){return"description"!==e&&"number"!==e&&"message"!==e})),t};n.keys=function(e){return d(e,f(e))},n.getOwnPropertyNames=function(e){return d(e,p(e))}}else n.keys=f,n.getOwnPropertyNames=p;if("function"==typeof Object.getOwnPropertyDescriptor)try{Object.getOwnPropertyDescriptor({a:1},"a"),n.getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor}catch(h){n.getOwnPropertyDescriptor=function(e,t){try{return Object.getOwnPropertyDescriptor(e,t)}catch(n){return u(e,t)}}}else n.getOwnPropertyDescriptor=u},{}],6:[function(e,t){function n(e,t){return p.isUndefined(t)?""+t:!p.isNumber(t)||!isNaN(t)&&isFinite(t)?p.isFunction(t)||p.isRegExp(t)?t.toString():t:t.toString()}function r(e,t){return p.isString(e)?e.length<t?e:e.slice(0,t):e}function i(e){return r(JSON.stringify(e.actual,n),128)+" "+e.operator+" "+r(JSON.stringify(e.expected,n),128)}function o(e,t,n,r,i){throw new m.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:i})}function s(e,t){e||o(e,!0,t,"==",m.ok)}function a(e,t){if(e===t)return!0;if(p.isBuffer(e)&&p.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return p.isDate(e)&&p.isDate(t)?e.getTime()===t.getTime():p.isRegExp(e)&&p.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:p.isObject(e)||p.isObject(t)?c(e,t):e==t}function u(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function c(e,t){if(p.isNullOrUndefined(e)||p.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(u(e))return u(t)?(e=h.call(e),t=h.call(t),a(e,t)):!1;try{var n,r,i=d.keys(e),o=d.keys(t)}catch(s){return!1}if(i.length!=o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!a(e[n],t[n]))return!1;return!0}function l(e,t){return e&&t?"[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t?!0:t.call({},e)===!0?!0:!1:!1}function f(e,t,n,r){var i;p.isString(n)&&(r=n,n=null);try{t()}catch(s){i=s}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!i&&o(i,n,"Missing expected exception"+r),!e&&l(i,n)&&o(i,n,"Got unwanted exception"+r),e&&i&&n&&!l(i,n)||!e&&i)throw i}var p=e("util"),d=e("_shims"),h=Array.prototype.slice,m=t.exports=s;m.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,this.message=e.message||i(this)},p.inherits(m.AssertionError,Error),m.fail=o,m.ok=s,m.equal=function(e,t,n){e!=t&&o(e,t,n,"==",m.equal)},m.notEqual=function(e,t,n){e==t&&o(e,t,n,"!=",m.notEqual)},m.deepEqual=function(e,t,n){a(e,t)||o(e,t,n,"deepEqual",m.deepEqual)},m.notDeepEqual=function(e,t,n){a(e,t)&&o(e,t,n,"notDeepEqual",m.notDeepEqual)},m.strictEqual=function(e,t,n){e!==t&&o(e,t,n,"===",m.strictEqual)},m.notStrictEqual=function(e,t,n){e===t&&o(e,t,n,"!==",m.notStrictEqual)},m.throws=function(){f.apply(this,[!0].concat(h.call(arguments)))},m.doesNotThrow=function(){f.apply(this,[!1].concat(h.call(arguments)))},m.ifError=function(e){if(e)throw e}},{_shims:5,util:7}],7:[function(e,t,n){function r(e,t){var r={seen:[],stylize:o};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(t)?r.showHidden=t:t&&n._extend(r,t),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),a(r,e,r.depth)}function i(e,t){var n=r.styles[t];return n?"["+r.colors[n][0]+"m"+e+"["+r.colors[n][1]+"m":e}function o(e){return e}function s(e){var t={};return T.forEach(e,function(e){t[e]=!0}),t}function a(e,t,r){if(e.customInspect&&t&&_(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r);return v(i)||(i=a(e,i,r)),i}var o=u(e,t);if(o)return o;var h=T.keys(t),m=s(h);if(e.showHidden&&(h=T.getOwnPropertyNames(t)),0===h.length){if(_(t)){var g=t.name?": "+t.name:"";return e.stylize("[Function"+g+"]","special")}if(w(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(j(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return c(t)}var b="",y=!1,x=["{","}"];if(d(t)&&(y=!0,x=["[","]"]),_(t)){var S=t.name?": "+t.name:"";b=" [Function"+S+"]"}if(w(t)&&(b=" "+RegExp.prototype.toString.call(t)),j(t)&&(b=" "+Date.prototype.toUTCString.call(t)),E(t)&&(b=" "+c(t)),0===h.length&&(!y||0==t.length))return x[0]+b+x[1];if(0>r)return w(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var A;return A=y?l(e,t,r,m,h):h.map(function(n){return f(e,t,r,m,n,y)}),e.seen.pop(),p(A,b,x)}function u(e,t){if(x(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,n,r,i){for(var o=[],s=0,a=t.length;a>s;++s)N(t,String(s))?o.push(f(e,t,n,r,String(s),!0)):o.push("");return T.forEach(i,function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))}),o}function f(e,t,n,r,i,o){var s,u,c;if(c=T.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),N(r,i)||(s="["+i+"]"),u||(T.indexOf(e.seen,c.value)<0?(u=m(n)?a(e,c.value,null):a(e,c.value,n-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),x(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function p(e,t,n){var r=0,i=T.reduce(e,function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function d(e){return T.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return null==e}function b(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return"symbol"==typeof e}function x(e){return void 0===e}function w(e){return S(e)&&"[object RegExp]"===C(e)}function S(e){return"object"==typeof e&&e}function j(e){return S(e)&&"[object Date]"===C(e)}function E(e){return S(e)&&"[object Error]"===C(e)}function _(e){return"function"==typeof e}function A(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function k(e){return e instanceof Buffer}function C(e){return Object.prototype.toString.call(e)}function O(e){return 10>e?"0"+e.toString(10):e.toString(10)}function I(){var e=new Date,t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),q[e.getMonth()],t].join(" ")}function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var T=e("_shims"),M=/%[sdj%]/g;n.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(r(arguments[n]));return t.join(" ")}for(var n=1,i=arguments,o=i.length,s=String(e).replace(M,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return e}}),a=i[n];o>n;a=i[++n])s+=m(a)||!S(a)?" "+a:" "+r(a);return s},n.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=h,n.isNull=m,n.isNullOrUndefined=g,n.isNumber=b,n.isString=v,n.isSymbol=y,n.isUndefined=x,n.isRegExp=w,n.isObject=S,n.isDate=j,n.isError=E,n.isFunction=_,n.isPrimitive=A,n.isBuffer=k;var q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",I(),n.format.apply(n,arguments))},n.inherits=function(e,t){e.super_=t,e.prototype=T.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},n._extend=function(e,t){if(!t||!S(t))return e;for(var n=T.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}},{_shims:5}]},{},[]),t.exports=e("buffer-browserify")},{}],71:[function(e,t){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;
if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){if(e.source===window&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var t=n.shift();t()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],72:[function(e,t,n){function r(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function i(e,t){for(var n in e)t(e[n],n)}var o=e("buffer").Buffer,s=e("./sha"),a=e("./sha256"),u=e("./rng"),c=e("./md5"),l={sha1:{hex:s.hex_sha1,base64:s.b64_sha1,binary:s.str_sha1},sha256:{hex:a.hex_sha256,base64:a.b64_sha256,binary:a.str_sha256},md5:{hex:c.hex_md5,base64:c.b64_md5,binary:c.bin_md5}},f={sha1:{hex:s.hex_hmac_sha1,base64:s.b64_hmac_sha1,binary:s.str_hmac_sha1},sha256:{hex:a.hex_hmac_sha256,base64:a.b64_hmac_sha256,binary:a.str_hmac_sha256},md5:{hex:c.hex_hmac_md5,base64:c.b64_hmac_md5,binary:c.bin_hmac_md5}};n.createHash=function(e){e=e||"sha1",l[e]||r("algorithm:",e,"is not yet supported");var t="",n=l[e];return{update:function(e){return t+=e,this},digest:function(i){i=i||"binary";var o;(o=n[i])||r("encoding:",i,"is not yet supported for algorithm",e);var s=o(t);return t=null,s}}},n.createHmac=function(e,t){f[e]||r("algorithm:",e,"is not yet supported"),"string"!=typeof t&&(t=t.toString("binary"));var n="",i=f[e];return{update:function(e){return n+=e,this},digest:function(o){o=o||"binary";var s;(s=i[o])||r("encoding:",o,"is not yet support for algorithm",e);var a=s(t,n);return n=null,a}}},n.randomBytes=function(e,t){if(!t||!t.call)return new o(u(e));try{t.call(this,void 0,new o(u(e)))}catch(n){t(n)}},i(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(e){n[e]=function(){r("sorry,",e,"is not implemented yet")}})},{"./md5":73,"./rng":74,"./sha":75,"./sha256":76,buffer:68}],73:[function(e,t,n){function r(e){return x(c(v(e),e.length*E))}function i(e){return w(c(v(e),e.length*E))}function o(e){return y(c(v(e),e.length*E))}function s(e,t){return x(m(e,t))}function a(e,t){return w(m(e,t))}function u(e,t){return y(m(e,t))}function c(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=n,u=r,c=i,l=o;n=f(n,r,i,o,e[s+0],7,-680876936),o=f(o,n,r,i,e[s+1],12,-389564586),i=f(i,o,n,r,e[s+2],17,606105819),r=f(r,i,o,n,e[s+3],22,-1044525330),n=f(n,r,i,o,e[s+4],7,-176418897),o=f(o,n,r,i,e[s+5],12,1200080426),i=f(i,o,n,r,e[s+6],17,-1473231341),r=f(r,i,o,n,e[s+7],22,-45705983),n=f(n,r,i,o,e[s+8],7,1770035416),o=f(o,n,r,i,e[s+9],12,-1958414417),i=f(i,o,n,r,e[s+10],17,-42063),r=f(r,i,o,n,e[s+11],22,-1990404162),n=f(n,r,i,o,e[s+12],7,1804603682),o=f(o,n,r,i,e[s+13],12,-40341101),i=f(i,o,n,r,e[s+14],17,-1502002290),r=f(r,i,o,n,e[s+15],22,1236535329),n=p(n,r,i,o,e[s+1],5,-165796510),o=p(o,n,r,i,e[s+6],9,-1069501632),i=p(i,o,n,r,e[s+11],14,643717713),r=p(r,i,o,n,e[s+0],20,-373897302),n=p(n,r,i,o,e[s+5],5,-701558691),o=p(o,n,r,i,e[s+10],9,38016083),i=p(i,o,n,r,e[s+15],14,-660478335),r=p(r,i,o,n,e[s+4],20,-405537848),n=p(n,r,i,o,e[s+9],5,568446438),o=p(o,n,r,i,e[s+14],9,-1019803690),i=p(i,o,n,r,e[s+3],14,-187363961),r=p(r,i,o,n,e[s+8],20,1163531501),n=p(n,r,i,o,e[s+13],5,-1444681467),o=p(o,n,r,i,e[s+2],9,-51403784),i=p(i,o,n,r,e[s+7],14,1735328473),r=p(r,i,o,n,e[s+12],20,-1926607734),n=d(n,r,i,o,e[s+5],4,-378558),o=d(o,n,r,i,e[s+8],11,-2022574463),i=d(i,o,n,r,e[s+11],16,1839030562),r=d(r,i,o,n,e[s+14],23,-35309556),n=d(n,r,i,o,e[s+1],4,-1530992060),o=d(o,n,r,i,e[s+4],11,1272893353),i=d(i,o,n,r,e[s+7],16,-155497632),r=d(r,i,o,n,e[s+10],23,-1094730640),n=d(n,r,i,o,e[s+13],4,681279174),o=d(o,n,r,i,e[s+0],11,-358537222),i=d(i,o,n,r,e[s+3],16,-722521979),r=d(r,i,o,n,e[s+6],23,76029189),n=d(n,r,i,o,e[s+9],4,-640364487),o=d(o,n,r,i,e[s+12],11,-421815835),i=d(i,o,n,r,e[s+15],16,530742520),r=d(r,i,o,n,e[s+2],23,-995338651),n=h(n,r,i,o,e[s+0],6,-198630844),o=h(o,n,r,i,e[s+7],10,1126891415),i=h(i,o,n,r,e[s+14],15,-1416354905),r=h(r,i,o,n,e[s+5],21,-57434055),n=h(n,r,i,o,e[s+12],6,1700485571),o=h(o,n,r,i,e[s+3],10,-1894986606),i=h(i,o,n,r,e[s+10],15,-1051523),r=h(r,i,o,n,e[s+1],21,-2054922799),n=h(n,r,i,o,e[s+8],6,1873313359),o=h(o,n,r,i,e[s+15],10,-30611744),i=h(i,o,n,r,e[s+6],15,-1560198380),r=h(r,i,o,n,e[s+13],21,1309151649),n=h(n,r,i,o,e[s+4],6,-145523070),o=h(o,n,r,i,e[s+11],10,-1120210379),i=h(i,o,n,r,e[s+2],15,718787259),r=h(r,i,o,n,e[s+9],21,-343485551),n=g(n,a),r=g(r,u),i=g(i,c),o=g(o,l)}return Array(n,r,i,o)}function l(e,t,n,r,i,o){return g(b(g(g(t,e),g(r,o)),i),n)}function f(e,t,n,r,i,o,s){return l(t&n|~t&r,e,t,i,o,s)}function p(e,t,n,r,i,o,s){return l(t&r|n&~r,e,t,i,o,s)}function d(e,t,n,r,i,o,s){return l(t^n^r,e,t,i,o,s)}function h(e,t,n,r,i,o,s){return l(n^(t|~r),e,t,i,o,s)}function m(e,t){var n=v(e);n.length>16&&(n=c(n,e.length*E));for(var r=Array(16),i=Array(16),o=0;16>o;o++)r[o]=909522486^n[o],i[o]=1549556828^n[o];var s=c(r.concat(v(t)),512+t.length*E);return c(i.concat(s),640)}function g(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function b(e,t){return e<<t|e>>>32-t}function v(e){for(var t=Array(),n=(1<<E)-1,r=0;r<e.length*E;r+=E)t[r>>5]|=(e.charCodeAt(r/E)&n)<<r%32;return t}function y(e){for(var t="",n=(1<<E)-1,r=0;r<32*e.length;r+=E)t+=String.fromCharCode(e[r>>5]>>>r%32&n);return t}function x(e){for(var t=S?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<4*e.length;r++)n+=t.charAt(15&e[r>>2]>>8*(r%4)+4)+t.charAt(15&e[r>>2]>>8*(r%4));return n}function w(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",r=0;r<4*e.length;r+=3)for(var i=(255&e[r>>2]>>8*(r%4))<<16|(255&e[r+1>>2]>>8*((r+1)%4))<<8|255&e[r+2>>2]>>8*((r+2)%4),o=0;4>o;o++)n+=8*r+6*o>32*e.length?j:t.charAt(63&i>>6*(3-o));return n}var S=0,j="=",E=8;n.hex_md5=r,n.b64_md5=i,n.bin_md5=o,n.hex_hmac_md5=s,n.b64_hmac_md5=a,n.bin_hmac_md5=u},{}],74:[function(e,t){!function(){var e,n,r=this;if(e=function(e){for(var t,t,n=new Array(e),r=0;e>r;r++)0==(3&r)&&(t=4294967296*Math.random()),n[r]=255&t>>>((3&r)<<3);return n},r.crypto&&crypto.getRandomValues){var i=new Uint32Array(4);n=function(e){var t=new Array(e);crypto.getRandomValues(i);for(var n=0;e>n;n++)t[n]=255&i[n>>2]>>>8*(3&n);return t}}t.exports=n||e}()},{}],75:[function(e,t,n){function r(e){return b(c(m(e),e.length*w))}function i(e){return v(c(m(e),e.length*w))}function o(e){return g(c(m(e),e.length*w))}function s(e,t){return b(p(e,t))}function a(e,t){return v(p(e,t))}function u(e,t){return g(p(e,t))}function c(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var n=Array(80),r=1732584193,i=-271733879,o=-1732584194,s=271733878,a=-1009589776,u=0;u<e.length;u+=16){for(var c=r,p=i,m=o,g=s,b=a,v=0;80>v;v++){n[v]=16>v?e[u+v]:h(n[v-3]^n[v-8]^n[v-14]^n[v-16],1);var y=d(d(h(r,5),l(v,i,o,s)),d(d(a,n[v]),f(v)));a=s,s=o,o=h(i,30),i=r,r=y}r=d(r,c),i=d(i,p),o=d(o,m),s=d(s,g),a=d(a,b)}return Array(r,i,o,s,a)}function l(e,t,n,r){return 20>e?t&n|~t&r:40>e?t^n^r:60>e?t&n|t&r|n&r:t^n^r}function f(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function p(e,t){var n=m(e);n.length>16&&(n=c(n,e.length*w));for(var r=Array(16),i=Array(16),o=0;16>o;o++)r[o]=909522486^n[o],i[o]=1549556828^n[o];var s=c(r.concat(m(t)),512+t.length*w);return c(i.concat(s),672)}function d(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function h(e,t){return e<<t|e>>>32-t}function m(e){for(var t=Array(),n=(1<<w)-1,r=0;r<e.length*w;r+=w)t[r>>5]|=(e.charCodeAt(r/w)&n)<<32-w-r%32;return t}function g(e){for(var t="",n=(1<<w)-1,r=0;r<32*e.length;r+=w)t+=String.fromCharCode(e[r>>5]>>>32-w-r%32&n);return t}function b(e){for(var t=y?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<4*e.length;r++)n+=t.charAt(15&e[r>>2]>>8*(3-r%4)+4)+t.charAt(15&e[r>>2]>>8*(3-r%4));return n}function v(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",r=0;r<4*e.length;r+=3)for(var i=(255&e[r>>2]>>8*(3-r%4))<<16|(255&e[r+1>>2]>>8*(3-(r+1)%4))<<8|255&e[r+2>>2]>>8*(3-(r+2)%4),o=0;4>o;o++)n+=8*r+6*o>32*e.length?x:t.charAt(63&i>>6*(3-o));return n}n.hex_sha1=r,n.b64_sha1=i,n.str_sha1=o,n.hex_hmac_sha1=s,n.b64_hmac_sha1=a,n.str_hmac_sha1=u;var y=0,x="=",w=8},{}],76:[function(e,t,n){function r(e){return j(w(S(e),e.length*f))}function i(e){return E(w(S(e),e.length*f))}function o(e){return c(w(S(e),e.length*f))}function s(e,t){return j(_(e,t))}function a(e,t){return E(_(e,t))}function u(e,t){return c(_(e,t))}function c(e){for(var t="",n=(1<<f)-1,r=0;r<32*e.length;r+=f)t+=String.fromCharCode(e[r>>5]>>>32-f-r%32&n);return t}n.hex_sha256=r,n.b64_sha256=i,n.str_sha256=o,n.hex_hmac_sha256=s,n.b64_hmac_sha256=a,n.str_hmac_sha256=u;var l=0,f=8,p=function(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n},d=function(e,t){return e>>>t|e<<32-t},h=function(e,t){return e>>>t},m=function(e,t,n){return e&t^~e&n},g=function(e,t,n){return e&t^e&n^t&n},b=function(e){return d(e,2)^d(e,13)^d(e,22)},v=function(e){return d(e,6)^d(e,11)^d(e,25)},y=function(e){return d(e,7)^d(e,18)^h(e,3)},x=function(e){return d(e,17)^d(e,19)^h(e,10)},w=function(e,t){var n,r,i,o,s,a,u,c,l,f,d,h,w=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),S=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),j=new Array(64);e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var l=0;l<e.length;l+=16){n=S[0],r=S[1],i=S[2],o=S[3],s=S[4],a=S[5],u=S[6],c=S[7];for(var f=0;64>f;f++)j[f]=16>f?e[f+l]:p(p(p(x(j[f-2]),j[f-7]),y(j[f-15])),j[f-16]),d=p(p(p(p(c,v(s)),m(s,a,u)),w[f]),j[f]),h=p(b(n),g(n,r,i)),c=u,u=a,a=s,s=p(o,d),o=i,i=r,r=n,n=p(d,h);S[0]=p(n,S[0]),S[1]=p(r,S[1]),S[2]=p(i,S[2]),S[3]=p(o,S[3]),S[4]=p(s,S[4]),S[5]=p(a,S[5]),S[6]=p(u,S[6]),S[7]=p(c,S[7])}return S},S=function(e){for(var t=Array(),n=(1<<f)-1,r=0;r<e.length*f;r+=f)t[r>>5]|=(e.charCodeAt(r/f)&n)<<24-r%32;return t},j=function(e){for(var t=l?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<4*e.length;r++)n+=t.charAt(15&e[r>>2]>>8*(3-r%4)+4)+t.charAt(15&e[r>>2]>>8*(3-r%4));return n},E=function(e){var t,n,r,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",s=4*e.length,a="=";for(t=0;s>t;t+=3)for(r=(255&e[t>>2]>>8*(3-t%4))<<16|(255&e[t+1>>2]>>8*(3-(t+1)%4))<<8|255&e[t+2>>2]>>8*(3-(t+2)%4),n=0;4>n;n+=1)o+=8*t+6*n<=32*e.length?i.charAt(63&r>>6*(3-n)):a;return o},_=function(e,t){var n=S(e);n.length>16&&(n=w(n,e.length*f));for(var r=Array(16),i=Array(16),o=0;16>o;o++)r[o]=909522486^n[o],i[o]=1549556828^n[o];var s=w(r.concat(S(t)),512+t.length*f);return w(i.concat(s),768)}},{}],77:[function(e,t){"use strict";var n=e("underscore"),r=e("async"),i=e("request"),o=e("jxt"),s=e("./lib/xrd");t.exports=function(e,t){if(t){"string"==typeof e&&(e={host:e}),e=n.extend({ssl:!0,json:!0,xrd:!0},e);var a=e.ssl?"https://":"http://";r.parallel({json:function(t){return e.json?(i.get(a+e.host+"/.well-known/host-meta.json",function(e,n){if(e)return t(null,{});var r,i;try{i=JSON.parse(n.body),r=!0}catch(o){r=!1,i={}}t(r,i)}),void 0):t(null,{})},xrd:function(t){if(!e.xrd)return t(null,{});var n,r;i.get(a+e.host+"/.well-known/host-meta",function(e,i){if(e)return t(null,{});try{var a=o.parse(s,i.body,"application/xml");r=a.toJSON(),n=!0}catch(u){n=!1,r={}}t(n,r)})}},function(e,n){if(e){if(n.json&&Object.keys(n.json).length)return t(!1,n.json);if(n.xrd&&Object.keys(n.xrd).length)return t(!1,n.xrd)}else t("no-host-meta",{})})}}},{"./lib/xrd":78,async:62,jxt:98,request:79,underscore:119}],78:[function(e,t){"use strict";var n=e("underscore"),r=e("jxt"),i="http://docs.oasis-open.org/ns/xri/xrd-1.0",o={get:function(){var e={},t=r.find(this.xml,i,"Property");return n.each(t,function(t){var n=r.getAttribute(t,"type");e[n]=t.textContent}),e}},s=t.exports=r.define({name:"xrd",namespace:i,element:"XRD",fields:{subject:r.subText(i,"Subject"),expires:r.dateSub(i,"Expires"),aliases:r.multiSubText(i,"Alias"),properties:o}}),a=r.define({name:"xrdlink",namespace:i,element:"Link",fields:{rel:r.attribute("rel"),href:r.attribute("href"),type:r.attribute("type"),template:r.attribute("template"),titles:r.subLangText(i,"Title","default"),properties:o}});r.extend(s,a,"links")},{jxt:98,underscore:119}],79:[function(e,t){function n(e,t){if("function"!=typeof t)throw new Error("Bad callback given: "+t);if(!e)throw new Error("No options given");var s=e.onResponse;if(e="string"==typeof e?{uri:e}:JSON.parse(JSON.stringify(e)),e.onResponse=s,e.verbose&&(n.log=o()),e.url&&(e.uri=e.url,delete e.url),!e.uri&&""!==e.uri)throw new Error("options.uri is a required argument");if("string"!=typeof e.uri)throw new Error("options.uri must be a string");for(var a=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],c=0;c<a.length;c++)if(e[a[c]])throw new Error("options."+a[c]+" is not supported");if(e.callback=t,e.method=e.method||"GET",e.headers=e.headers||{},e.body=e.body||null,e.timeout=e.timeout||n.DEFAULT_TIMEOUT,e.headers.host)throw new Error("Options.headers.host is not supported");return e.json&&(e.headers.accept=e.headers.accept||"application/json","GET"!==e.method&&(e.headers["content-type"]="application/json"),"boolean"!=typeof e.json?e.body=JSON.stringify(e.json):"string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.onResponse=e.onResponse||i,e.onResponse===!0&&(e.onResponse=t,e.callback=i),!e.headers.authorization&&e.auth&&(e.headers.authorization="Basic "+u(e.auth.username+":"+e.auth.password)),r(e)}function r(e){function t(){l=!0;var t=new Error("ETIMEDOUT");return t.code="ETIMEDOUT",t.duration=e.timeout,n.log.error("Timeout",{id:u._id,milliseconds:e.timeout}),e.callback(t,u)}function r(){if(l)return n.log.debug("Ignoring timed out state change",{state:u.readyState,id:u.id});if(n.log.debug("State change",{state:u.readyState,id:u.id,timed_out:l}),u.readyState===c.OPENED){n.log.debug("Request started",{id:u.id});for(var t in e.headers)u.setRequestHeader(t,e.headers[t])}else u.readyState===c.HEADERS_RECEIVED?i():u.readyState===c.LOADING?(i(),o()):u.readyState===c.DONE&&(i(),o(),s())}function i(){if(!m.response){if(m.response=!0,n.log.debug("Got response",{id:u.id,status:u.status}),clearTimeout(u.timeoutTimer),u.statusCode=u.status,p&&0==u.statusCode){var t=new Error("CORS request rejected: "+e.uri);return t.cors="rejected",m.loading=!0,m.end=!0,e.callback(t,u)}e.onResponse(null,u)}}function o(){m.loading||(m.loading=!0,n.log.debug("Response body loading",{id:u.id}))}function s(){if(!m.end){if(m.end=!0,n.log.debug("Request done",{id:u.id}),u.body=u.responseText,e.json)try{u.body=JSON.parse(u.responseText)}catch(t){return e.callback(t,u)}e.callback(null,u,u.body)}}var u=new c,l=!1,p=a(e.uri),d="withCredentials"in u;if(f+=1,u.seq_id=f,u.id=f+": "+e.method+" "+e.uri,u._id=u.id,p&&!d){var h=new Error("Browser does not support cross-origin request: "+e.uri);return h.cors="unsupported",e.callback(h,u)}u.timeoutTimer=setTimeout(t,e.timeout);var m={response:!1,loading:!1,end:!1};return u.onreadystatechange=r,u.open(e.method,e.uri,!0),p&&(u.withCredentials=!!e.withCredentials),u.send(e.body),u}function i(){}function o(){var e,t,n={},r=["trace","debug","info","warn","error"];for(t=0;t<r.length;t++)e=r[t],n[e]=i,"undefined"!=typeof console&&console&&console[e]&&(n[e]=s(console,e));return n}function s(e,t){function n(n,r){return"object"==typeof r&&(n+=" "+JSON.stringify(r)),e[t].call(e,n)}return n}function a(e){var t,n=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{t=location.href}catch(r){t=document.createElement("a"),t.href="",t=t.href}var i=n.exec(t.toLowerCase())||[],o=n.exec(e.toLowerCase()),s=!(!o||o[1]==i[1]&&o[2]==i[2]&&(o[3]||("http:"===o[1]?80:443))==(i[3]||("http:"===i[1]?80:443)));return s}function u(e){var t,n,r,i,o,s,a,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,f=0,p="",d=[];if(!e)return e;do t=e.charCodeAt(l++),n=e.charCodeAt(l++),r=e.charCodeAt(l++),u=t<<16|n<<8|r,i=63&u>>18,o=63&u>>12,s=63&u>>6,a=63&u,d[f++]=c.charAt(i)+c.charAt(o)+c.charAt(s)+c.charAt(a);while(l<e.length);switch(p=d.join(""),e.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p}var c=XMLHttpRequest;if(!c)throw new Error("missing XMLHttpRequest");t.exports=n,n.log={trace:i,debug:i,info:i,warn:i,error:i};var l=18e4,f=0;n.withCredentials=!1,n.DEFAULT_TIMEOUT=l,n.defaults=function(e){var t=function(t){var n=function(n,r){n="string"==typeof n?{uri:n}:JSON.parse(JSON.stringify(n));for(var i in e)void 0===n[i]&&(n[i]=e[i]);return t(n,r)};return n},r=t(n);return r.get=t(n.get),r.post=t(n.post),r.put=t(n.put),r.head=t(n.head),r};var p=["get","put","post","head"];p.forEach(function(e){var t=e.toUpperCase(),r=e.toLowerCase();n[r]=function(e){"string"==typeof e?e={method:t,uri:e}:(e=JSON.parse(JSON.stringify(e)),e.method=t);var r=[e].concat(Array.prototype.slice.apply(arguments,[1]));return n.apply(this,r)}}),n.couch=function(e,t){function r(e,n,r){if(e)return t(e,n,r);if((n.statusCode<200||n.statusCode>299)&&r.error){e=new Error("CouchDB error: "+(r.error.reason||r.error.error));for(var i in r)e[i]=r[i];return t(e,n,r)}return t(e,n,r)}"string"==typeof e&&(e={uri:e}),e.json=!0,e.body&&(e.json=e.body),delete e.body,t=t||i;var o=n(e,r);return o}},{}],80:[function(e,t){t.exports=e("./lib/sessionManager")},{"./lib/sessionManager":83}],81:[function(e,t){function n(e){var t=e.split("-");return"on"+t[0][0].toUpperCase()+t[0].substr(1)+t[1][0].toUpperCase()+t[1].substr(1)}function r(e){var t=this;this.sid=e.sid||Date.now().toString(),this.peer=e.peer,this.isInitiator=e.initiator||!1,this.state="starting",this.parent=e.parent,this.processingQueue=o.queue(function(e,n){var r=e.action,i=e.changes,o=e.cb;a(t.sid+": "+r),t[r](i,function(e){o(e),n()})})}var i=e("bows"),o=e("async"),s=e("wildemitter");e("jingle-rtcpeerconnection"),e("sdp-jingle-json");var a=i("JingleSession");r.prototype=Object.create(s.prototype,{constructor:{value:r}}),r.prototype.process=function(e,t,r){var i=n(e);this.processingQueue.push({action:i,changes:t,cb:r})},r.prototype.send=function(e,t){t=t||{},t.sid=this.sid,t.action=e,this.parent.emit("send",{to:this.peer,type:"set",jingle:t})},Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(e){var t={starting:!0,pending:!0,active:!0,ended:!0};if(!t[e])throw new Error("Invalid Jingle Session State: "+e);this._state!==e&&(this._state=e,a(this.sid+": State changed to "+e))}}),Object.defineProperty(r.prototype,"starting",{get:function(){return"starting"==this._state}}),Object.defineProperty(r.prototype,"pending",{get:function(){return"pending"==this._state}}),Object.defineProperty(r.prototype,"active",{get:function(){return"active"==this._state}}),Object.defineProperty(r.prototype,"ended",{get:function(){return"ended"==this._state}}),r.prototype.start=function(){this.state="pending",a(this.sid+": Can not start generic session")},r.prototype.end=function(e,t){this.parent.peers[this.peer].splice(this.parent.peers[this.peer].indexOf(this),1),delete this.parent.sessions[this.sid],this.state="ended",e=e||{},t||this.send("session-terminate",{reason:e}),this.parent.emit("terminated",this,e)};var u=["content-accept","content-add","content-modify","conent-reject","content-remove","description-info","session-accept","session-info","session-initiate","session-terminate","transport-accept","transport-info","transport-reject","transport-replace"];u.forEach(function(e){var t=n(e);r.prototype[t]=function(t,n){a(this.sid+": Unsupported action "+e),n()}}),t.exports=r},{async:62,bows:84,"jingle-rtcpeerconnection":88,"sdp-jingle-json":93,wildemitter:120}],82:[function(e,t){function n(e){o.call(this,e);var t=this;this.pc=new s(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints),this.pc.on("ice",this.onIceCandidate.bind(this)),this.pc.on("addStream",this.onStreamAdded.bind(this)),this.pc.on("removeStream",this.onStreamRemoved.bind(this)),this.pendingAnswer=null,this.parent.localStream?(this.pc.addStream(this.parent.localStream),this.localStream=this.parent.localStream):this.parent.once("localStream",function(e){t.pc.addStream(e),this.localStream=e}),this.stream=null}var r=e("underscore"),i=e("bows"),o=e("./genericSession"),s=e("jingle-rtcpeerconnection"),a=i("JingleMedia");n.prototype=Object.create(o.prototype,{constructor:{value:n}}),n.prototype=r.extend(n.prototype,{start:function(){var e=this;this.state="pending",this.pc.isInitiator=!0,this.pc.offer(function(t,n){e.send("session-initiate",n.json)})},end:function(e){this.pc.close(),this.onStreamRemoved(),o.prototype.end.call(this,e)},accept:function(){a(this.sid+": Accepted incoming session"),this.state="active",this.send("session-accept",this.pendingAnswer)},ring:function(){a(this.sid+": Ringing on incoming session"),this.send("session-info",{ringing:!0})},mute:function(e,t){a(this.sid+": Muting"),this.send("session-info",{mute:{creator:e,name:t}})},unmute:function(e,t){a(this.sid+": Unmuting"),this.send("session-info",{unmute:{creator:e,name:t}})},hold:function(){a(this.sid+": Placing on hold"),this.send("session-info",{hold:!0})},resume:function(){a(this.sid+": Resuing from hold"),this.send("session-info",{active:!0})},onSessionInitiate:function(e,t){a(this.sid+": Initiating incoming session");var n=this;this.state="pending",this.pc.isInitiator=!1,this.pc.answer({type:"offer",json:e},function(e,r){return e?(a(n.sid+": Could not create WebRTC answer",e),t({condition:"general-error"})):(n.pendingAnswer=r.json,t(),void 0)})},onSessionAccept:function(e,t){var n=this;a(this.sid+": Activating accepted outbound session"),this.state="active",this.pc.handleAnswer({type:"answer",json:e},function(e){return e?(a(n.sid+": Could not process WebRTC answer",e),t({condition:"general-error"})):(n.parent.emit("accepted",n),t(),void 0)})},onSessionTerminate:function(e,t){a(this.sid+": Terminating session"),this.pc.close(),this.onStreamRemoved(),o.prototype.end.call(this,e.reason,!0),t()},onTransportInfo:function(e,t){var n=this;a(this.sid+": Adding ICE candidate"),this.pc.processIce(e,function(e){e&&a(n.sid+": Could not process ICE candidate",e),t()})},onSessionInfo:function(e,t){a(e),e.ringing&&(a(this.sid+": Ringing on remote stream"),this.parent.emit("ringing",this)),e.hold&&(a(this.sid+": On hold"),this.parent.emit("hold",this)),e.active&&(a(this.sid+": Resumed from hold"),this.parent.emit("resumed",this)),e.mute&&(a(this.sid+": Muted",e.mute),this.parent.emit("mute",this,e.mute)),e.unmute&&(a(this.sid+": Unmuted",e.unmute),this.parent.emit("unmute",this,e.unmute)),t()},onIceCandidate:function(e){a(this.sid+": Discovered new ICE candidate",e),this.send("transport-info",e)},onStreamAdded:function(e){this.stream?a(this.sid+": Received remote stream, but one already exists"):(a(this.sid+": Remote media stream added"),this.stream=e.stream,this.parent.emit("peerStreamAdded",this))},onStreamRemoved:function(){a(this.sid+": Remote media stream removed"),this.parent.emit("peerStreamRemoved",this)}}),t.exports=n},{"./genericSession":81,bows:84,"jingle-rtcpeerconnection":88,underscore:119}],83:[function(e,t){function n(e){e=e||{};var t=this.config={debug:!1,peerConnectionConfig:{iceServers:[{url:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[{DtlsSrtpKeyAgreement:!0},{RtpDataChannels:!1}]},autoAdjustMic:!1,media:{audio:!0,video:!0}};this.MediaSession=f,this.jid=e.jid,this.sessions={},this.peers={},this.screenSharingSupport=s.screenSharing;for(var n in e)t[n]=e[n];this.capabilities=["urn:xmpp:jingle:1"],s.support?this.capabilities=["urn:xmpp:jingle:1","urn:xmpp:jingle:apps:rtp:1","urn:xmpp:jingle:apps:rtp:audio","urn:xmpp:jingle:apps:rtp:video","urn:xmpp:jingle:apps:rtp:rtcb-fb:0","urn:xmpp:jingle:apps:dtls:0","urn:xmpp:jingle:transports:ice-udp:1","urn:ietf:rfc:3264"]:p("WebRTC not supported"),u.call(this),this.config.debug&&this.on("*",function(e,t,n){p(e,t,n)})}var r=e("underscore"),i=e("bows"),o=e("hark"),s=e("webrtcsupport");e("mockconsole");var a=e("getusermedia");e("jingle-rtcpeerconnection");var u=e("wildemitter"),c=e("mediastream-gain"),l=e("./genericSession"),f=e("./mediaSession"),p=i("Jingle");n.prototype=Object.create(u.prototype,{constructor:{value:n}}),n.prototype.startLocalMedia=function(e,t){var n=this,r=e||{video:!0,audio:!0};a(r,function(e,i){e?p("Could not start local media"):(r.audio&&n.config.detectSpeakingEvents&&n.setupAudioMonitor(i),n.localStream=i,n.config.autoAdjustMic&&(n.gainController=new c(i),n.setMicIfEnabled(.5)),p("Local media stream started"),n.emit("localStream",i)),t&&t(e,i)})},n.prototype.stopLocalMedia=function(){this.localStream&&(this.localStream.stop(),this.emit("localStreamStopped"))},n.prototype.setupAudioMonitor=function(e){p("Setup audio");var t,n=o(e),r=this;n.on("speaking",function(){r.hardMuted||(r.setMicIfEnabled(1),r.emit("speaking"))}),n.on("stopped_speaking",function(){r.hardMuted||(t&&clearTimeout(t),t=setTimeout(function(){r.setMicIfEnabled(.5),r.emit("stoppedSpeaking")},1e3))})},n.prototype.setMicIfEnabled=function(e){this.config.autoAdjustMic&&this.gainController.setGain(e)},n.prototype.sendError=function(e,t,n){n.type="cancel",this.emit("send",{to:e,id:t,type:"error",error:n})},n.prototype.process=function(e){var t=this;if("error"===e.type)return this.emit("error",e);if("result"!==e.type){var n,i,o,s=e.jingle.sid,a=e.jingle.action,u=e.jingle.contents||[],c=r.map(u,function(e){return(e.description||{}).descType}),d=this.sessions[s]||null,h=e.from.full||e.from,m=e.id;if("session-initiate"!==a){if(!d)return p("Unknown session",s),this.sendError(h,m,{condition:"item-not-found",jingleCondition:"unknown-session"});if(d.peer!==h||d.ended)return p("Session has ended, or action has wrong sender"),this.sendError(h,m,{condition:"item-not-found",jingleCondition:"unknown-session"});if("session-accept"===a&&!d.pending)return p("Tried to accept session twice",s),this.sendError(h,m,{condition:"unexpected-request",jingleCondition:"out-of-order"});if("session-terminate"!==a&&d.pendingAction&&(p("Tie break during pending request"),d.isInitiator))return this.sendError(h,m,{condition:"conflict",jingleCondition:"tie-break"})}else{if(d)return d.peer!==h?(p("Duplicate sid from new sender"),this.sendError(h,m,{condition:"service-unavailable"})):d.pending&&this.jid>d.peer?(p("Tie break new session because of duplicate sids"),this.sendError(h,m,{condition:"conflict",jingleCondition:"tie-break"})):(p("Someone is doing this wrong"),this.sendError(h,m,{condition:"unexpected-request",jingleCondition:"out-of-order"}));if(Object.keys(this.peers[h]||{}).length){n=Object.keys(this.peers[h]);for(var g=0;g<n.length;g++)if(i=n[g],o=this.sessions[i],o.pending&&r.intersection(c,o.contentTypes).length&&i>s)return p("Tie break"),this.sendError(h,m,{condition:"conflict",jingleCondition:"tie-break"})}}if("session-initiate"===a){var b={sid:s,peer:h,initiator:!1,parent:this};d=c.indexOf("rtp")>=0?new f(b):new l(b),this.sessions[s]=d,this.peers[h]||(this.peers[h]=[]),this.peers[h].push(d)}d.process(a,e.jingle,function(n){n?(p("Could not process request",e,n),t.sendError(h,m,n)):(t.emit("send",{to:h,id:m,type:"result"}),"session-initiate"===a&&(p("Incoming session request from ",h,d),t.emit("incoming",d)))})}},n.prototype.createMediaSession=function(e,t){var n=new f({sid:t,peer:e,initiator:!0,parent:this});return t=n.sid,this.sessions[t]=n,this.peers[e]||(this.peers[e]=[]),this.peers[e].push(n),p("Outgoing session",n.sid,n),this.emit("outgoing",n),n},n.prototype.endPeerSessions=function(e){p("Ending all sessions with",e);var t=this.peers[e]||[];t.forEach(function(e){e.end()})},t.exports=n},{"./genericSession":81,"./mediaSession":82,bows:84,getusermedia:86,hark:87,"jingle-rtcpeerconnection":88,"mediastream-gain":90,mockconsole:92,underscore:119,webrtcsupport:97,wildemitter:120}],84:[function(e,t){!function(){var n,r,i,o="undefined"==typeof window,s=!o&&window.localStorage,a=s.debug,u=e("andlog"),c=.618033988749895,l=0,f=15,p=function(){};n=function(){return l+=c,l%=1,360*l};var i=a&&"/"===a[0]&&new RegExp(a.substring(1,a.length-1));r=function(e){var t;return t="%c"+e.slice(0,f),t+=Array(f+3-t.length).join(" ")+"|",i&&!e.match(i)?p:window.chrome?u.log.bind(u,t,"color: hsl("+n()+",99%,40%); font-weight: bold"):u.log.bind(u,t)},r.config=function(e){return e.padLength?f=e.padLength:void 0},"undefined"!=typeof t?t.exports=r:window.bows=r}.call()},{andlog:85}],85:[function(e,t,n){!function(){var e="undefined"==typeof window,r=!e&&window.localStorage,i={};if(e)return t.exports=console,void 0;if(r&&r.debug&&window.console)i=window.console;else for(var o="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),s=o.length,a=function(){};s--;)i[o[s]]=a;"undefined"!=typeof n?t.exports=i:window.console=i}()},{}],86:[function(e,t){var n=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;t.exports=function(e,t){var r,i=2===arguments.length,o={video:!0,audio:!0},s="PERMISSION_DENIED",a="CONSTRAINT_NOT_SATISFIED";return i||(t=e,e=o),n?(n.call(navigator,e,function(e){t(null,e)},function(e){var n;"string"==typeof e?(n=new Error("NavigatorUserMediaError"),n.name=e===s?s:a):(n=e,n.name||(e.name=n[s]?s:a)),t(n)}),void 0):(r=new Error("NavigatorUserMediaError"),r.name="NOT_SUPPORTED_ERROR",t(r))}},{}],87:[function(e,t){function n(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=0,i=t.length;i>r;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}var r=e("wildemitter");t.exports=function(e,t){var i=new r;if(!window.webkitAudioContext)return i;var o,s,a,t=t||{},u=t.smoothing||.5,c=t.interval||100,l=t.threshold,f=t.play,p=new webkitAudioContext;a=p.createAnalyser(),a.fftSize=512,a.smoothingTimeConstant=u,s=new Float32Array(a.fftSize),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement?(o=p.createMediaElementSource(e),"undefined"==typeof f&&(f=!0),l=l||-65):(o=p.createMediaStreamSource(e),l=l||-45),o.connect(a),f&&a.connect(p.destination),i.speaking=!1,i.setThreshold=function(e){l=e},i.setInterval=function(e){c=e};var d=function(){setTimeout(function(){var e=n(a,s);i.emit("volume_change",e,l),e>l?i.speaking||(i.speaking=!0,i.emit("speaking")):i.speaking&&(i.speaking=!1,i.emit("stopped_speaking")),d()},c)};return d(),i}},{wildemitter:120}],88:[function(e,t){function n(e,t){this.sid="",this.sdpSessId=Date.now(),this.isInitiator=!0,this.localDescription={contents:[]},this.remoteDescription={contents:[]},o.call(this,e,t)}var r=e("underscore"),i=e("webrtcsupport"),o=e("rtcpeerconnection"),s=e("sdp-jingle-json");n.prototype=Object.create(o.prototype,{constructor:{value:n}}),n.prototype.offer=function(e,t){var n=this,r=2===arguments.length,i=r?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},o=r?t:e;this.pc.createOffer(function(e){e.sdp=n._applySdpHack(e.sdp),n.pc.setLocalDescription(e);var t=s.toSessionJSON(e.sdp,n.isInitiator?"initiator":"responder");t.sid=this.sid,n.localDescription=t;var r={type:"offer",sdp:e.sdp,json:t};n.emit("offer",r),o&&o(null,r)
},function(e){n.emit("error",e),o&&o(e)},i)},o.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.sdp=s.toSessionSDP(e.json,this.sdpSessId),n.remoteDescription=e.json,this.pc.setRemoteDescription(new i.SessionDescription(e),function(){t(null)},function(e){t(e)})},n.prototype._answer=function(e,t,n){n=n||function(){};var r=this;e.sdp=s.toSessionSDP(e.json,r.sdpSessId),r.remoteDescription=e.json,this.pc.setRemoteDescription(new i.SessionDescription(e),function(){r.pc.createAnswer(function(e){e.sdp=r._applySdpHack(e.sdp),r.pc.setLocalDescription(e);var t=s.toSessionJSON(e.sdp);t.sid=r.sid,r.localDescription=t;var i={type:"answer",sdp:e.sdp,json:t};r.emit("answer",i),n&&n(null,i)},function(e){r.emit("error",e),n&&n(e)},t)},function(e){n(e)})},n.prototype.processIce=function(e,t){t=t||function(){};var n=this,o=r.map(this.remoteDescription.contents,function(e){return e.name}),a=e.contents||[];a.forEach(function(e){var t=e.transport||{},r=t.candidates||[],a=o.indexOf(e.name),u=e.name;r.forEach(function(e){var t=s.toCandidateSDP(e)+"\r\n",r={candidate:t,sdpMLineIndex:a,sdpMid:u};n.pc.addIceCandidate(new i.IceCandidate(r))})}),t()},n.prototype._onIce=function(e){var t=this;if(e.candidate){var n=e.candidate;this.emit("ice",{contents:[{name:n.sdpMid,creator:t.isInitiator?"initiator":"responder",transport:{transType:"iceUdp",candidates:[s.toCandidateJSON(n.candidate)]}}]})}else this.emit("endOfCandidates")},t.exports=n},{rtcpeerconnection:89,"sdp-jingle-json":93,underscore:119,webrtcsupport:97}],89:[function(e,t){function n(e,t){var n;this.pc=new i.PeerConnection(e,t),r.call(this),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onaddstream=this._onAddStream.bind(this),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.config={debug:!1,sdpHack:!0};for(n in e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){var t=e.logger||console;t.log("PeerConnection event:",arguments)})}var r=e("wildemitter"),i=e("webrtcsupport");n.prototype=Object.create(r.prototype,{constructor:{value:n}}),n.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},n.prototype.processIce=function(e){this.pc.addIceCandidate(new i.IceCandidate(e))},n.prototype.offer=function(e,t){var n=this,r=2===arguments.length,i=r?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},o=r?t:e;this.pc.createOffer(function(e){e.sdp=n._applySdpHack(e.sdp),n.pc.setLocalDescription(e),n.emit("offer",e),o&&o(null,e)},function(e){n.emit("error",e),o&&o(e)},i)},n.prototype.answerAudioOnly=function(e,t){var n={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};this._answer(e,n,t)},n.prototype.answerBroadcastOnly=function(e,t){var n={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};this._answer(e,n,t)},n.prototype.answer=function(e,t,n){var r=3===arguments.length,i=r?n:t,o=r?t:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(e,o,i)},n.prototype.handleAnswer=function(e){this.pc.setRemoteDescription(new i.SessionDescription(e))},n.prototype.close=function(){this.pc.close(),this.emit("close")},n.prototype._answer=function(e,t,n){var r=this;this.pc.setRemoteDescription(new i.SessionDescription(e)),this.pc.createAnswer(function(e){e.sdp=r._applySdpHack(e.sdp),r.pc.setLocalDescription(e),r.emit("answer",e),n&&n(null,e)},function(e){r.emit("error",e),n&&n(e)},t)},n.prototype._onIce=function(e){e.candidate?this.emit("ice",e.candidate):this.emit("endOfCandidates")},n.prototype._onDataChannel=function(e){this.emit("addChannel",e.channel)},n.prototype._onAddStream=function(e){this.remoteStream=e.stream,this.emit("addStream",e)},n.prototype._applySdpHack=function(e){if(!this.config.sdpHack)return e;var t=e.split("b=AS:30");return 2===t.length?t[0]+"b=AS:102400"+t[1]:e},n.prototype.createDataChannel=function(e,t){t||(t={});var n,r,o=!!t.reliable,s=t.protocol||"text/plain",a=!(!t.negotiated&&!t.preset);return"moz"===i.prefix?(n=o?{protocol:s,preset:a,stream:e}:{},r=this.pc.createDataChannel(e,n),r.binaryType="blob"):(n=o?{reliable:!0}:{reliable:!1},r=this.pc.createDataChannel(e,n)),r},t.exports=n},{webrtcsupport:97,wildemitter:120}],90:[function(e,t){function n(e){if(this.support=r.webAudio&&r.mediaStream,this.gain=1,this.support){var t=this.context=new r.AudioContext;this.microphone=t.createMediaStreamSource(e),this.gainFilter=t.createGain(),this.destination=t.createMediaStreamDestination(),this.outputStream=this.destination.stream,this.microphone.connect(this.gainFilter),this.gainFilter.connect(this.destination),e.removeTrack(e.getAudioTracks()[0]),e.addTrack(this.outputStream.getAudioTracks()[0])}this.stream=e}var r=e("webrtcsupport");n.prototype.setGain=function(e){this.support&&(this.gainFilter.gain.value=e,this.gain=e)},n.prototype.getGain=function(){return this.gain},n.prototype.off=function(){return this.setGain(0)},n.prototype.on=function(){this.setGain(1)},t.exports=n},{webrtcsupport:91}],91:[function(e,t){var n=window.mozRTCPeerConnection||window.webkitRTCPeerConnection||window.RTCPeerConnection,r=window.mozRTCIceCandidate||window.RTCIceCandidate,i=window.mozRTCSessionDescription||window.RTCSessionDescription,o=function(){return window.mozRTCPeerConnection?"moz":window.webkitRTCPeerConnection?"webkit":void 0}(),s=window.webkitMediaStream||window.MediaStream,a=navigator.userAgent.match("Chrome")&&parseInt(navigator.userAgent.match(/Chrome\/(.*) /)[1],10)>=26,u=window.webkitAudioContext||window.AudioContext;t.exports={support:!!n,dataChannel:!!(n&&n.prototype&&n.prototype.createDataChannel),prefix:o,webAudio:!(!u||!u.prototype.createMediaStreamSource),mediaStream:!(!s||!s.prototype.removeTrack),screenSharing:a,AudioContext:u,PeerConnection:n,SessionDescription:i,IceCandidate:r}},{}],92:[function(e,t){for(var n="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),r=n.length,i=function(){},o={};r--;)o[n[r]]=i;t.exports=o},{}],93:[function(e,t,n){var r=e("./lib/tosdp"),i=e("./lib/tojson");n.toSessionSDP=r.toSessionSDP,n.toMediaSDP=r.toMediaSDP,n.toCandidateSDP=r.toCandidateSDP,n.toSessionJSON=i.toSessionJSON,n.toMediaJSON=i.toMediaJSON,n.toCandidateJSON=i.toCandidateJSON},{"./lib/tojson":95,"./lib/tosdp":96}],94:[function(e,t,n){n.lines=function(e){return e.split("\r\n").filter(function(e){return e.length>0})},n.findLine=function(e,t,n){for(var r=e.length,i=0;i<t.length;i++)if(t[i].substr(0,r)===e)return t[i];if(!n)return!1;for(var o=0;o<n.length;o++)if(n[o].substr(0,r)===e)return n[o];return!1},n.findLines=function(e,t,n){for(var r=[],i=e.length,o=0;o<t.length;o++)t[o].substr(0,i)===e&&r.push(t[o]);if(r.length||!n)return r;for(var s=0;s<n.length;s++)n[s].substr(0,i)===e&&r.push(n[s]);return r},n.mline=function(e){for(var t=e.substr(2).split(" "),n={media:t[0],port:t[1],proto:t[2],formats:[]},r=3;r<t.length;r++)t[r]&&n.formats.push(t[r]);return n},n.rtpmap=function(e){var t=e.substr(9).split(" "),n={id:t.shift()};return t=t[0].split("/"),n.name=t[0],n.clockrate=t[1],n.channels=3==t.length?t[2]:"1",n},n.fmtp=function(e){for(var t,n,r,i=e.substr(e.indexOf(" ")+1).split(";"),o=[],s=0;s<i.length;s++)t=i[s].split("="),n=t[0].trim(),r=t[1],n&&r?o.push({key:n,value:r}):n&&o.push({key:"",value:n});return o},n.crypto=function(e){var t=e.substr(9).split(" "),n={tag:t[0],cipherSuite:t[1],keyParams:t[2],sessionParams:t.slice(3).join(" ")};return n},n.fingerprint=function(e){var t=e.substr(14).split(" ");return{hash:t[0],value:t[1]}},n.extmap=function(e){var t=e.substr(9).split(" "),n={},r=t.shift(),i=r.indexOf("/");return i>=0?(n.id=r.substr(0,i),n.senders=r.substr(i)):(n.id=r,n.senders="sendrecv"),n.uri=t.shift(),n},n.rtcpfb=function(e){var t=e.substr(10).split(" "),n={};return n.id=t.shift(),n.type=t.shift(),"trr-int"===n.type?n.value=t.shift():n.subtype=t.shift(),n.parameters=t,n},n.candidate=function(e){for(var t=e.substring(12).split(" "),n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:t[3],ip:t[4],port:t[5],type:t[7]},r=8;r<t.length;r+=2)"raddr"===t[r]?n.relAddr=t[r+1]:"rport"===t[r]?n.relPort=t[r+1]:"generation"===t[r]&&(n.generation=t[r+1]);return n.network="1",n},n.ssrc=function(e){for(var t,n,r=[],i={},o=0;o<e.length;o++){t=e[o].substr(7).split(" "),n=t.shift(),t=t.join(" ").split(":");var s=t.shift(),a=t.join(":")||null;i[n]||(i[n]={}),i[n][s]=a}for(n in i){var u=i[n];u.ssrc=n,r.push(u)}return r},n.grouping=function(e){for(var t,n=[],r=0;r<e.length;r++)t=e[r].substr(8).split(" "),n.push({semantics:t.shift(),contents:t});return n}},{}],95:[function(e,t,n){var r=e("./parsers"),i=Math.random();n.toSessionJSON=function(e,t){for(var i=e.split("\r\nm="),o=1;o<i.length;o++)i[o]="m="+i[o],o!==i.length-1&&(i[o]+="\r\n");var s=i.shift()+"\r\n",a=r.lines(s),u={},c=[];i.forEach(function(e){c.push(n.toMediaJSON(e,s,t))}),u.contents=c;var l=r.findLines("a=group:",a);return l.length&&(u.groupings=r.grouping(l)),u},n.toMediaJSON=function(e,t,i){var o=r.lines(e),s=r.lines(t),a=r.mline(o[0]),u={creator:i,name:a.media,description:{descType:"rtp",media:a.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transType:"iceUdp",candidates:[],fingerprints:[]}},c=u.description,l=u.transport,f=r.findLine("a=ssrc:",o);f&&(c.ssrc=f.substr(7).split(" ")[0]);var p=r.findLine("a=mid:",o);p&&(u.name=p.substr(6)),r.findLine("a=sendrecv",o,s)?u.senders="both":r.findLine("a=sendonly",o,s)?u.senders="initiator":r.findLine("a=recvonly",o,s)?u.senders="responder":r.findLine("a=inactive",o,s)&&(u.senders="none");var d=r.findLines("a=rtpmap:",o);d.forEach(function(e){var t=r.rtpmap(e);t.feedback=[];var n=r.findLines("a=fmtp:"+t.id,o);n.forEach(function(e){t.parameters=r.fmtp(e)});var i=r.findLines("a=rtcp-fb:"+t.id,o);i.forEach(function(e){t.feedback.push(r.rtcpfb(e))}),c.payloads.push(t)});var h=r.findLines("a=crypto:",o,s);h.forEach(function(e){c.encryption.push(r.crypto(e))}),r.findLine("a=rtcp-mux",o)&&(c.mux=!0);var m=r.findLines("a=rtcp-fb:*",o);m.forEach(function(e){c.feedback.push(r.rtcpfb(e))});var g=r.findLines("a=extmap:",o);g.forEach(function(e){var t=r.extmap(e),n={sendonly:"responder",recvonly:"initiator",sendrecv:"both",inactive:"none"};t.senders=n[t.senders],c.headerExtensions.push(t)});var b=r.findLines("a=ssrc:",o);b.length&&(c.ssrcs=r.ssrc(b));var v=r.findLines("a=fingerprint:",o,s);v.forEach(function(e){l.fingerprints.push(r.fingerprint(e))});var y=r.findLine("a=ice-ufrag:",o,s),x=r.findLine("a=ice-pwd:",o,s);if(y&&x){l.ufrag=y.substr(12),l.pwd=x.substr(10),l.candidates=[];var w=r.findLines("a=candidate:",o,s);w.forEach(function(e){l.candidates.push(n.toCandidateJSON(e))})}return u},n.toCandidateJSON=function(e){var t=r.candidate(e.split("\r\n")[0]);return t.id=(i++).toString(36).substr(0,12),t}},{"./parsers":94}],96:[function(e,t,n){var r={initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",sendonly:"initator",recvonly:"responder",sendrecv:"both",inactive:"none"};n.toSessionSDP=function(e,t){var r=["v=0","o=- "+(t||e.sid||Date.now())+" "+Date.now()+" IN IP4 0.0.0.0","s=-","t=0 0"],i=e.groupings||[];i.forEach(function(e){r.push("a=group:"+e.semantics+" "+e.contents.join(" "))});var o=e.contents||[];return o.forEach(function(e){r.push(n.toMediaSDP(e))}),r.join("\r\n")+"\r\n"},n.toMediaSDP=function(e){var t=[],i=e.description,o=e.transport,s=i.payloads||[],a=o&&o.fingerprints||[],u=[i.media,"1"];i.encryption&&i.encryption.length>0||a.length>0?u.push("RTP/SAVPF"):u.push("RTP/AVPF"),s.forEach(function(e){u.push(e.id)}),t.push("m="+u.join(" ")),t.push("c=IN IP4 0.0.0.0"),t.push("a=rtcp:1 IN IP4 0.0.0.0"),o&&(o.ufrag&&t.push("a=ice-ufrag:"+o.ufrag),o.pwd&&t.push("a=ice-pwd:"+o.pwd),a.forEach(function(e){t.push("a=fingerprint:"+e.hash+" "+e.value)})),t.push("a="+(r[e.senders]||"sendrecv")),t.push("a=mid:"+e.name),i.mux&&t.push("a=rtcp-mux");var c=i.encryption||[];c.forEach(function(e){t.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))}),s.forEach(function(e){var n="a=rtpmap:"+e.id+" "+e.name+"/"+e.clockrate;if(e.channels&&"1"!=e.channels&&(n+="/"+e.channels),t.push(n),e.parameters&&e.parameters.length){var r=["a=fmtp:"+e.id];e.parameters.forEach(function(e){r.push((e.key?e.key+"=":"")+e.value)}),t.push(r.join(" "))}e.feedback&&e.feedback.forEach(function(n){"trr-int"===n.type?t.push("a=rtcp-fb:"+e.id+" trr-int "+n.value?n.value:"0"):t.push("a=rtcp-fb:"+e.id+" "+n.type+(n.subtype?" "+n.subtype:""))})}),i.feedback&&i.feedback.forEach(function(e){"trr-int"===e.type?t.push(e.value):t.push("a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))});var l=i.headerExtensions||[];l.forEach(function(e){t.push("a=extmap:"+e.id+(e.senders?"/"+r[e.senders]:"")+" "+e.uri)});var f=i.ssrcs||[];f.forEach(function(e){for(var n in e)"ssrc"!=n&&t.push("a=ssrc:"+(e.ssrc||i.ssrc)+" "+n+(e[n]?":"+e[n]:""))});var p=o.candidates||[];return p.forEach(function(e){t.push(n.toCandidateSDP(e))}),t.join("\r\n")},n.toCandidateSDP=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),("srflx"===n||"prflx"===n||"relay"===n)&&e.relAddr&&e.relPort&&(t.push("raddr"),t.push(e.relAddr),t.push("rport"),t.push(e.relPort)),t.push("generation"),t.push(e.generation||"0"),"a=candidate:"+t.join(" ")}},{}],97:[function(e,t){var n,r=!1,i=!1,o=navigator.userAgent.toLowerCase();-1!==o.indexOf("firefox")?(n="moz",i=!0):-1!==o.indexOf("chrome")&&(n="webkit",r=!0);var s=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,a=window.mozRTCIceCandidate||window.RTCIceCandidate,u=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.webkitMediaStream||window.MediaStream,l=navigator.userAgent.match("Chrome")&&parseInt(navigator.userAgent.match(/Chrome\/(.*) /)[1],10)>=26,f=window.webkitAudioContext||window.AudioContext;t.exports={support:!!s,dataChannel:r||i||s.prototype&&s.prototype.createDataChannel,prefix:n,webAudio:!(!f||!f.prototype.createMediaStreamSource),mediaStream:!(!c||!c.prototype.removeTrack),screenSharing:!!l,AudioContext:f,PeerConnection:s,SessionDescription:u,IceCandidate:a}},{}],98:[function(e,t){"use strict";var n=e("underscore"),r=e("./lib/core"),i=e("./lib/helpers"),o=e("./lib/types");t.exports=n.extend({},r,i,o)},{"./lib/core":99,"./lib/helpers":100,"./lib/types":101,underscore:119}],99:[function(e,t,n){"use strict";function r(e){var t=e.prototype._NS+"|"+e.prototype._EL;l[t]=e,p[t]=e}function i(e){return a.serializeToString(e)}function o(e){var t,n={},r={constructor:!0,_EL:!0,_NS:!0,_extensions:!0,_name:!0,parent:!0,prototype:!0,toJSON:!0,toString:!0,xml:!0};for(t in e._extensions)e._extensions[t].toJSON&&"_"!==t[0]&&(n[t]=e._extensions[t].toJSON());for(t in e)if(!r[t]&&!(f[e._NS+"|"+e._EL]||{})[t]&&!e._extensions[t]&&"_"!==t[0]){var i=e[t];if("function"==typeof i)continue;var o=Object.prototype.toString.call(i);o.indexOf("Object")>=0?Object.keys(i).length>0&&(n[t]=i):o.indexOf("Array")>=0?i.length>0&&(n[t]=i):i&&(n[t]=i)}return n}var s=e("underscore");new(e("xmlshim").DOMParser);var a=new(e("xmlshim").XMLSerializer),u=e("./helpers"),c=e("./types");u.find;var l={},f={},p={};n.build=function(e){var t=p[e.namespaceURI+"|"+e.localName];return t?new t(null,e):void 0},n.extend=function(e,t,r){var i=e.prototype._NS+"|"+e.prototype._EL,o=t.prototype._name,s=t.prototype._NS+"|"+t.prototype._EL;l[s]=t,f[s]||(f[s]={}),f[i]||(f[i]={}),f[i][o]=t,n.add(e,o,c.extension(t)),r&&n.add(e,r,c.multiExtension(t))},n.add=function(e,t,n){n.enumerable=!0,Object.defineProperty(e.prototype,t,n)},n.define=function(e){var t=function(t,n,r){var i=this,o=(n||{}).parentNode||(r||{}).xml,a=(o||{}).namespaceURI;return i.xml=n||u.createElement(i._NS,i._EL,a),i._extensions={},s.each(i.xml.childNodes,function(e){var t=e.namespaceURI+"|"+e.localName,n=l[t];if(void 0!==n){var r=n.prototype._name;i._extensions[r]=new n(null,e),i._extensions[r].parent=i}}),s.extend(i,t),e.init&&e.init(t),i};t.prototype={constructor:{value:t},_name:e.name,_eventname:e.eventName,_NS:e.namespace,_EL:e.element,toString:function(){return i(this.xml)},toJSON:function(){return o(this)}};var a=Object.keys(e.fields||{});return a.forEach(function(r){n.add(t,r,e.fields[r])}),e.topLevel&&r(t),t}},{"./helpers":100,"./types":101,underscore:119,xmlshim:104}],100:[function(e,t,n){"use strict";var r=e("underscore"),i=e("xmlshim"),o=n.XML_NS="http://www.w3.org/XML/1998/namespace",s=new i.XMLSerializer,a=new i.DOMParser,u=i.implementation.createDocument("","",null);n.parse=function(e,t){for(var n=a.parseFromString(t,"application/xml").childNodes,r=0;r<n.length;r++)if(1===n[r].nodeType)return new e({},n[r]);throw new Error("Could not parse: "+t)},n.getParser=function(){return a},n.getSerializer=function(){return s},n.createElement=function(e,t,r){var i=u.createElementNS(e,t);return r&&r===e||n.setAttribute(i,"xmlns",e),i};var c=n.find=function(e,t,n){var i=e.getElementsByTagName(n);return r.filter(i,function(n){return n.namespaceURI===t&&n.parentNode==e})};n.findOrCreate=function(e,t,r){var i=n.find(e,t,r);if(i.length)return i[0];var o=n.createElement(t,r,e.namespaceURI);return e.appendChild(o),o},n.getAttribute=function(e,t,n){return e.getAttribute(t)||n||""},n.setAttribute=function(e,t,n,r){n||r?e.setAttribute(t,n):e.removeAttribute(t)},n.getBoolAttribute=function(e,t,n){var r=e.getAttribute(t)||n||"";return"true"===r||"1"===r},n.setBoolAttribute=function(e,t,n){n?e.setAttribute(t,"1"):e.removeAttribute(t)},n.getSubAttribute=function(e,t,n,r,i){var o=c(e,t,n);if(!o)return"";for(var s=0;s<o.length;s++)return o[s].getAttribute(r)||i||"";return""},n.setSubAttribute=function(e,t,r,i,o){var s=c(e,t,r);if(s.length)for(var a=0;a<s.length;a++){if(o)return s[a].setAttribute(i,o),void 0;s[a].removeAttribute(i)}else o&&(r=n.createElement(t,r,e.namespaceURI),r.setAttribute(i,o),e.appendChild(r))},n.getBoolSubAttribute=function(e,t,n,r,i){var o=e.getSubAttribute(t,n,r)||i||"";return"true"===o||"1"===o},n.setBoolSubAttribute=function(e,t,r,i,o){o=o?"1":"",n.setSubAttribute(e,t,r,i,o)},n.getText=function(e){return e.textContent},n.setText=function(e,t){e.textContent=t},n.getSubText=function(e,t,n,r){var i=c(e,t,n);return r=r||"",i.length?i[0].textContent||r:r},n.setSubText=function(e,t,r,i){var o=c(e,t,r);if(o.length)for(var s=0;s<o.length;s++){if(i)return o[s].textContent=i,void 0;e.removeChild(o[s])}else if(i){var a=n.createElement(t,r,e.namespaceURI);a.textContent=i,e.appendChild(a)}},n.getMultiSubText=function(e,t,n,r){var i=c(e,t,n),o=[];r=r||function(e){return e.textContent||""};for(var s=0;s<i.length;s++)o.push(r(i[s]));return o},n.setMultiSubText=function(e,t,i,o,s){var a=c(e,t,i),u=[];s=s||function(r){var o=n.createElement(t,i,e.namespaceURI);o.textContent=r,e.appendChild(o)},u="string"==typeof o?(o||"").split("\n"):o,r.forEach(a,function(t){e.removeChild(t)}),r.forEach(u,function(e){e&&s(e)})},n.getSubLangText=function(e,t,n,r){var i=c(e,t,n);if(!i.length)return{};for(var s,a,u={},l=[],f=0;f<i.length;f++)a=i[f],s=a.getAttributeNS(o,"lang")||r,l.push(s),u[s]=a.textContent||"";return u},n.setSubLangText=function(e,t,r,i,s){var a,u,l=c(e,t,r);if(l.length)for(var f=0;f<l.length;f++)e.removeChild(l[f]);if("string"==typeof i)a=n.createElement(t,r,e.namespaceURI),a.textContent=i,e.appendChild(a);else if("object"==typeof i)for(u in i)i.hasOwnProperty(u)&&(a=n.createElement(t,r,e.namespaceURI),u!==s&&a.setAttributeNS(o,"lang",u),a.textContent=i[u],e.appendChild(a))},n.getBoolSub=function(e,t,n){var r=c(e,t,n);return!!r.length},n.setBoolSub=function(e,t,r,i){var o=c(e,t,r);if(o.length)for(var s=0;s<o.length;s++){if(i)return;e.removeChild(o[s])}else if(i){var a=n.createElement(t,r,e.namespaceURI);e.appendChild(a)}}},{underscore:119,xmlshim:104}],101:[function(e,t,n){"use strict";var r=e("underscore"),i=e("atob"),o=e("btoa"),s=e("./helpers"),a=s.find,u=n.field=function(e,t){return function(){var n=r.toArray(arguments);return{get:function(){return e.apply(null,[this.xml].concat(n))},set:function(e){t.apply(null,[this.xml].concat(n).concat([e]))}}}};n.field=u,n.boolAttribute=u(s.getBoolAttribute,s.setBoolAttribute),n.subAttribute=u(s.getSubAttribute,s.setSubAttribute),n.boolSubAttribute=u(s.getSubBoolAttribute,s.setSubBoolAttribute),n.text=u(s.getText,s.setText),n.subText=u(s.getSubText,s.setSubText),n.multiSubText=u(s.getMultiSubText,s.setMultiSubText),n.subLangText=u(s.getSubLangText,s.setSubLangText),n.boolSub=u(s.getBoolSub,s.setBoolSub),n.langAttribute=u(function(e){return e.getAttributeNS(s.XML_NS,"lang")||""},function(e,t){e.setAttributeNS(s.XML_NS,"lang",t)}),n.b64Text=u(function(e){return e.textContent&&"="!=e.textContent?i(e.textContent):""},function(e,t){e.textContent=o(t)||"="}),n.dateAttribute=function(e,t){return{get:function(){var n=s.getAttribute(this.xml,e);return n?new Date(n):t?new Date(Date.now()):void 0},set:function(t){t&&("string"!=typeof t&&(t=t.toISOString()),s.setAttribute(this.xml,e,t))}}},n.dateSub=function(e,t,n){return{get:function(){var r=s.getSubText(this.xml,e,t);return r?new Date(r):n?new Date(Date.now()):void 0},set:function(n){n&&("string"!=typeof n&&(n=n.toISOString()),s.setSubText(this.xml,e,t,n))}}},n.dateSubAttribute=function(e,t,n,r){return{get:function(){var i=s.getSubAttribute(this.xml,e,t,n);return i?new Date(i):r?new Date(Date.now()):void 0},set:function(r){r&&("string"!=typeof r&&(r=r.toISOString()),s.setSubAttribute(this.xml,e,t,n,r))}}},n.numberAttribute=u(function(e,t){return parseInt(s.getAttribute(e,t,"0"),10)},function(e,t,n){s.setAttribute(e,t,n.toString())}),n.numberSub=u(function(e,t,n){return parseInt(s.getSubText(e,t,n,"0"),10)},function(e,t,n,r){s.setSubText(e,t,n,r.toString())}),n.attribute=function(e,t){return{get:function(){return s.getAttribute(this.xml,e,t)},set:function(t){s.setAttribute(this.xml,e,t)}}},n.extension=function(e){return{get:function(){var t=this,n=e.prototype._name;if(!this._extensions[n]){var r=a(this.xml,e.prototype._NS,e.prototype._EL);r.length?this._extensions[n]=new e(null,r[0],t):(this._extensions[n]=new e({},null,t),this.xml.appendChild(this._extensions[n].xml)),this._extensions[n].parent=this}return this._extensions[n]},set:function(t){var n=this[e.prototype._name];r.extend(n,t)}}},n.multiExtension=function(e){return{get:function(){var t=this,n=a(this.xml,e.prototype._NS,e.prototype._EL),i=[];return r.forEach(n,function(n){i.push(new e({},n,t).toJSON())}),i},set:function(t){var n=this,i=a(this.xml,e.prototype._NS,e.prototype._EL);r.forEach(i,function(e){n.xml.removeChild(e)}),r.forEach(t,function(t){var r=new e(t,null,n);n.xml.appendChild(r.xml)})}}}},{"./helpers":100,atob:102,btoa:103,underscore:119}],102:[function(e,t){var n=e("__browserify_Buffer").Buffer;!function(){"use strict";function e(e){return new n(e,"base64").toString("binary")}t.exports=e}()},{__browserify_Buffer:70}],103:[function(e,t){var n=e("__browserify_Buffer").Buffer;!function(){"use strict";function e(e){var t;return t=e instanceof n?e:new n(e.toString(),"binary"),t.toString("base64")}t.exports=e}()},{__browserify_Buffer:70}],104:[function(e,t,n){n.XMLSerializer=XMLSerializer,n.DOMParser=DOMParser,n.implementation=document.implementation},{}],105:[function(t,n){var r=t("__browserify_Buffer").Buffer;!function(){function i(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>i&&(t[r+i++]=g[e])});16>i;)t[r+i++]=0;return t}function o(e,t){var n=t||0,r=m;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function s(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var s=null!=e.clockseq?e.clockseq:x,a=null!=e.msecs?e.msecs:(new Date).getTime(),u=null!=e.nsecs?e.nsecs:S+1,c=a-w+(u-S)/1e4;if(0>c&&null==e.clockseq&&(s=16383&s+1),(0>c||a>w)&&null==e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");w=a,S=u,x=s,a+=122192928e5;var l=(1e4*(268435455&a)+u)%4294967296;i[r++]=255&l>>>24,i[r++]=255&l>>>16,i[r++]=255&l>>>8,i[r++]=255&l;var f=268435455&1e4*(a/4294967296);i[r++]=255&f>>>8,i[r++]=255&f,i[r++]=16|15&f>>>24,i[r++]=255&f>>>16,i[r++]=128|s>>>8,i[r++]=255&s;for(var p=e.node||y,d=0;6>d;d++)i[r+d]=p[d];return t?t:o(i)}function a(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new h(16):null,e=null),e=e||{};var i=e.random||(e.rng||u)();if(i[6]=64|15&i[6],i[8]=128|63&i[8],t)for(var s=0;16>s;s++)t[r+s]=i[s];return t||o(i)}var u,c=this;if("function"==typeof t)try{var l=t("crypto").randomBytes;u=l&&function(){return l(16)}}catch(f){}if(!u&&c.crypto&&crypto.getRandomValues){var p=new Uint8Array(16);u=function(){return crypto.getRandomValues(p),p}}if(!u){var d=new Array(16);u=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),d[t]=255&e>>>((3&t)<<3);return d}}for(var h="function"==typeof r?r:Array,m=[],g={},b=0;256>b;b++)m[b]=(b+256).toString(16).substr(1),g[m[b]]=b;var v=u(),y=[1|v[0],v[1],v[2],v[3],v[4],v[5]],x=16383&(v[6]<<8|v[7]),w=0,S=0,j=a;if(j.v1=s,j.v4=a,j.parse=i,j.unparse=o,j.BufferClass=h,c.define&&e.amd)e(function(){return j});else if("undefined"!=typeof n&&n.exports)n.exports=j;else{var E=c.uuid;j.noConflict=function(){return c.uuid=E,j},c.uuid=j}}()},{__browserify_Buffer:70,crypto:72}],106:[function(e,t,n){function r(e){c.call(this),this.registry=new Object,this.insureids=0,this.freq=void 0===e?5:e,this.run=!1,this.start()}function i(e,t,n,r){void 0===r&&(++this.insureids,this.insureids%=65e3,r=this.insureids),expiretime=Date.now()+1e3*t;var i=this,o={paddle:i,error_callback:e,args:n,id:r,timeout:expiretime,done:!1,check_in:function(){return this.paddle.check_in(this.id)}};return this.registry[r]=o,o}function o(e){return void 0!==e.id&&(e=e.id),e in this.registry?(this.emit("check_in",this.registry[e]),this.registry[e].done=!0,delete this.registry[e],!0):!1}function s(){var e=Date.now();for(var t in this.registry)e>this.registry[t].timeout&&(this.registry[t].error_callback.apply(this,this.registry[t].args),this.emit("timeout",this.registry[t]),delete this.registry[t]);this.run&&setTimeout(function(){this.checkEnsures()}.bind(this),1e3*this.freq)}function a(e){return void 0!==e&&(this.freq=e),this.run?!1:(this.run=!0,setTimeout(function(){this.checkEnsures()}.bind(this),1e3*this.freq),!0)}function u(){return this.run?(this.run=!1,!0):!0}var c=e("events").EventEmitter;r.super_=c,r.prototype=Object.create(c.prototype,{constructor:{value:r,enumerable:!1}}),r.prototype.insure=i,r.prototype.check_in=o,r.prototype.checkEnsures=s,r.prototype.start=a,r.prototype.stop=u,n.Paddle=r},{events:65}],107:[function(t,n,r){!function(t,i){"object"==typeof r?i(r,n):"function"==typeof e&&e.amd&&e(["exports","module"],i)}(this,function(e,t){function n(){}n.prototype.name="ANONYMOUS",n.prototype.clientFirst=!0,n.prototype.response=function(e){return e.trace||""},n.prototype.challenge=function(){},e=t.exports=n})},{}],108:[function(t,n,r){!function(i,o){"object"==typeof r?o(r,n,t("./lib/mechanism")):"function"==typeof e&&e.amd&&e(["exports","module","./lib/mechanism"],o)}(this,function(e,t,n){e=t.exports=n,e.Mechanism=n})},{"./lib/mechanism":107}],109:[function(t,n,r){!function(i,o){"object"==typeof r?o(r,n,t("crypto")):"function"==typeof e&&e.amd&&e(["exports","module","crypto"],o)}(this,function(e,t,n){function r(e){e=e||{},this._genNonce=e.genNonce||o(32)}function i(e){for(var t={},n=e.split(/,(?=(?:[^"]|"[^"]*")*$)/),r=0,i=n.length;i>r;r++){var o=/(\w+)=["]?([^"]+)["]?$/.exec(n[r]);o&&(t[o[1]]=o[2])}return t}function o(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length;return function(){for(var r=[],i=0;e>i;++i)r.push(t[0|Math.random()*n]);return r.join("")}}function s(e,t){return n.createHash("md5").update(e).digest(t||"hex")}r.prototype.name="DIGEST-MD5",r.prototype.clientFirst=!1,r.prototype.response=function(e){var t=e.serviceType+"/"+e.host;e.serviceName&&e.host!==e.serviceName&&(t+="/"+serviceName);var n,r,i,o=e.realm||this._realm||"",a=this._genNonce(),u="00000001",c="auth",l="";return l+='username="'+e.username+'"',o&&(l+=',realm="'+o+'"'),l+=',nonce="'+this._nonce+'"',l+=',cnonce="'+a+'"',l+=",nc="+u,l+=",qop="+c,l+=',digest-uri="'+t+'"',n=e.authzid?s(s(e.username+":"+o+":"+e.password,"binary")+":"+this._nonce+":"+a+":"+e.authzid):s(s(e.username+":"+o+":"+e.password,"binary")+":"+this._nonce+":"+a),"auth"==c?r=s("AUTHENTICATE:"+t):("auth-int"==c||"auth-conf"==c)&&(r=s("AUTHENTICATE:"+t+":00000000000000000000000000000000")),i=s(n+":"+this._nonce+":"+u+":"+a+":"+c+":"+r),l+=",response="+i,"utf-8"==this._charset&&(l+=",charset=utf-8"),e.authzid&&(l+='authzid="'+e.authzid+'"'),l},r.prototype.challenge=function(e){var t=i(e);return this._realm=t.realm,this._nonce=t.nonce,this._qop=(t.qop||"auth").split(","),this._stale=t.stale,this._maxbuf=parseInt(t.maxbuf)||65536,this._charset=t.charset,this._algo=t.algorithm,this._cipher=t.cipher,this._cipher&&this._cipher.split(","),this},e=t.exports=r})},{crypto:72}],110:[function(e,t,n){arguments[4][108][0].apply(n,arguments)},{"./lib/mechanism":109}],111:[function(t,n,r){!function(t,i){"object"==typeof r?i(r,n):"function"==typeof e&&e.amd&&e(["exports","module"],i)}(this,function(e,t){function n(){}n.prototype.name="EXTERNAL",n.prototype.clientFirst=!0,n.prototype.response=function(e){return e.authzid||""},n.prototype.challenge=function(){},e=t.exports=n})},{}],112:[function(e,t,n){arguments[4][108][0].apply(n,arguments)},{"./lib/mechanism":111}],113:[function(t,n,r){!function(t,i){"object"==typeof r?i(r,n):"function"==typeof e&&e.amd&&e(["exports","module"],i)}(this,function(e,t){function n(){}n.prototype.name="PLAIN",n.prototype.clientFirst=!0,n.prototype.response=function(e){var t="";return t+=e.authzid||"",t+="\0",t+=e.username,t+="\0",t+=e.password},n.prototype.challenge=function(){return this},e=t.exports=n})},{}],114:[function(e,t,n){arguments[4][108][0].apply(n,arguments)},{"./lib/mechanism":113}],115:[function(t,n,r){!function(i,o){"object"==typeof r?o(r,n,t("crypto"),t("buffer")):"function"==typeof e&&e.amd&&e(["exports","module","crypto","buffer"],o)}(this,function(e,t,n,r){function i(e){e=e||{},this._genNonce=e.genNonce||f(32),this._stage=0}function o(e,t){return n.createHmac("sha1",e).update(t).digest("binary")}function s(e,t,n){for(var r=o(e,t+"\0\0\0"),i=r,s=0;n-1>s;s++)r=o(e,r),i=u(i,r);return i}function a(e){return n.createHash("sha1").update(e).digest("binary")}function u(e,t){e=new p(e,"binary"),t=new p(t,"binary");var n=Math.min(e.length,t.length);result=[];for(var r=0;n>r;r++)result.push(e[r]^t[r]);return result=new p(result,"binary"),result.toString("binary")}function c(e){for(var t=[],n="",r=0;r<e.length;r++)n=e[r],","===n?t.push("=2C"):"="===n?t.push("=3D"):t.push(n);return t.join("")}function l(e){for(var t={},n=e.split(/,(?=(?:[^"]|"[^"]*")*$)/),r=0,i=n.length;i>r;r++){var o=/(\w+)=["]?([^"]+)["]?$/.exec(n[r]);o&&(t[o[1]]=o[2])}return t}function f(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length;return function(){for(var r=[],i=0;e>i;++i)r.push(t[0|Math.random()*n]);return r.join("")}}var p=r.Buffer;i.prototype.name="SCRAM-SHA-1",i.prototype.clientFirst=!0,i.prototype.response=function(e){return d[this._stage](this,e)},i.prototype.challenge=function(e){var t=l(e);return this._salt=new p(t.s||"","base64").toString("binary"),this._iterationCount=parseInt(t.i,10),this._nonce=t.r,this._verifier=t.v,this._error=t.e,this._challenge=e,this};var d={};d[0]=function(e,t){e._cnonce=e._genNonce();var n="";t.authzid&&(n="a="+c(t.authzid)),e._gs2Header="n,"+n+",";var r="r="+e._cnonce,i="n="+c(t.username);e._clientFirstMessageBare=i+","+r;var o=e._gs2Header+e._clientFirstMessageBare;return e._stage=1,o
},d[1]=function(e,t){var n=new p(e._gs2Header).toString("base64");e._clientFinalMessageWithoutProof="c="+n+",r="+e._nonce;var r,i,c;t.clientKey&&t.serverKey?(i=t.clientKey,c=t.serverKey):(r=t.saltedPassword||s(t.password,e._salt,e._iterationCount),i=o(r,"Client Key"),c=o(r,"Server Key"));var l=a(i),f=e._clientFirstMessageBare+","+e._challenge+","+e._clientFinalMessageWithoutProof,d=o(l,f),h=u(i,d),m=new p(h,"binary").toString("base64");e._serverSignature=o(c,f);var g=e._clientFinalMessageWithoutProof+",p="+m;return e._stage=2,e.cache={saltedPassword:r,clientKey:i,serverKey:c},g},d[2]=function(){return""},e=t.exports=i})},{buffer:68,crypto:72}],116:[function(e,t,n){arguments[4][108][0].apply(n,arguments)},{"./lib/mechanism":115}],117:[function(t,n,r){!function(t,i){"object"==typeof r?i(r,n):"function"==typeof e&&e.amd&&e(["exports","module"],i)}(this,function(e,t){function n(){this._mechs=[]}n.prototype.use=function(e,t){return t||(t=e,e=t.prototype.name),this._mechs.push({name:e,mech:t}),this},n.prototype.create=function(e){for(var t=0,n=this._mechs.length;n>t;t++)for(var r=0,i=e.length;i>r;r++){var o=this._mechs[t];if(o.name==e[r])return new o.mech}return null},e=t.exports=n})},{}],118:[function(t,n,r){!function(i,o){"object"==typeof r?o(r,n,t("./lib/factory")):"function"==typeof e&&e.amd&&e(["exports","module","./lib/factory"],o)}(this,function(e,t,n){e=t.exports=n,e.Factory=n})},{"./lib/factory":117}],119:[function(e,t,n){!function(){var e=this,r=e._,i={},o=Array.prototype,s=Object.prototype,a=Function.prototype,u=o.push,c=o.slice,l=o.concat,f=s.toString,p=s.hasOwnProperty,d=o.forEach,h=o.map,m=o.reduce,g=o.reduceRight,b=o.filter,v=o.every,y=o.some,x=o.indexOf,w=o.lastIndexOf,S=Array.isArray,j=Object.keys,E=a.bind,_=function(e){return e instanceof _?e:this instanceof _?(this._wrapped=e,void 0):new _(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=_),n._=_):e._=_,_.VERSION="1.5.2";var A=_.each=_.forEach=function(e,t,n){if(null!=e)if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,o=e.length;o>r;r++)if(t.call(n,e[r],r,e)===i)return}else for(var s=_.keys(e),r=0,o=s.length;o>r;r++)if(t.call(n,e[s[r]],s[r],e)===i)return};_.map=_.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(A(e,function(e,i,o){r.push(t.call(n,e,i,o))}),r)};var k="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),m&&e.reduce===m)return r&&(t=_.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(A(e,function(e,o,s){i?n=t.call(r,n,e,o,s):(n=e,i=!0)}),!i)throw new TypeError(k);return n},_.reduceRight=_.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),g&&e.reduceRight===g)return r&&(t=_.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var o=e.length;if(o!==+o){var s=_.keys(e);o=s.length}if(A(e,function(a,u,c){u=s?s[--o]:--o,i?n=t.call(r,n,e[u],u,c):(n=e[u],i=!0)}),!i)throw new TypeError(k);return n},_.find=_.detect=function(e,t,n){var r;return C(e,function(e,i,o){return t.call(n,e,i,o)?(r=e,!0):void 0}),r},_.filter=_.select=function(e,t,n){var r=[];return null==e?r:b&&e.filter===b?e.filter(t,n):(A(e,function(e,i,o){t.call(n,e,i,o)&&r.push(e)}),r)},_.reject=function(e,t,n){return _.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},_.every=_.all=function(e,t,n){t||(t=_.identity);var r=!0;return null==e?r:v&&e.every===v?e.every(t,n):(A(e,function(e,o,s){return(r=r&&t.call(n,e,o,s))?void 0:i}),!!r)};var C=_.some=_.any=function(e,t,n){t||(t=_.identity);var r=!1;return null==e?r:y&&e.some===y?e.some(t,n):(A(e,function(e,o,s){return r||(r=t.call(n,e,o,s))?i:void 0}),!!r)};_.contains=_.include=function(e,t){return null==e?!1:x&&e.indexOf===x?-1!=e.indexOf(t):C(e,function(e){return e===t})},_.invoke=function(e,t){var n=c.call(arguments,2),r=_.isFunction(t);return _.map(e,function(e){return(r?t:e[t]).apply(e,n)})},_.pluck=function(e,t){return _.map(e,function(e){return e[t]})},_.where=function(e,t,n){return _.isEmpty(t)?n?void 0:[]:_[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},_.findWhere=function(e,t){return _.where(e,t,!0)},_.max=function(e,t,n){if(!t&&_.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&_.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return A(e,function(e,i,o){var s=t?t.call(n,e,i,o):e;s>r.computed&&(r={value:e,computed:s})}),r.value},_.min=function(e,t,n){if(!t&&_.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&_.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return A(e,function(e,i,o){var s=t?t.call(n,e,i,o):e;s<r.computed&&(r={value:e,computed:s})}),r.value},_.shuffle=function(e){var t,n=0,r=[];return A(e,function(e){t=_.random(n++),r[n-1]=r[t],r[t]=e}),r},_.sample=function(e,t,n){return arguments.length<2||n?e[_.random(e.length-1)]:_.shuffle(e).slice(0,Math.max(0,t))};var O=function(e){return _.isFunction(e)?e:function(t){return t[e]}};_.sortBy=function(e,t,n){var r=O(t);return _.pluck(_.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var I=function(e){return function(t,n,r){var i={},o=null==n?_.identity:O(n);return A(t,function(n,s){var a=o.call(r,n,s,t);e(i,a,n)}),i}};_.groupBy=I(function(e,t,n){(_.has(e,t)?e[t]:e[t]=[]).push(n)}),_.indexBy=I(function(e,t,n){e[t]=n}),_.countBy=I(function(e,t){_.has(e,t)?e[t]++:e[t]=1}),_.sortedIndex=function(e,t,n,r){n=null==n?_.identity:O(n);for(var i=n.call(r,t),o=0,s=e.length;s>o;){var a=o+s>>>1;n.call(r,e[a])<i?o=a+1:s=a}return o},_.toArray=function(e){return e?_.isArray(e)?c.call(e):e.length===+e.length?_.map(e,_.identity):_.values(e):[]},_.size=function(e){return null==e?0:e.length===+e.length?e.length:_.keys(e).length},_.first=_.head=_.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:c.call(e,0,t)},_.initial=function(e,t,n){return c.call(e,0,e.length-(null==t||n?1:t))},_.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:c.call(e,Math.max(e.length-t,0))},_.rest=_.tail=_.drop=function(e,t,n){return c.call(e,null==t||n?1:t)},_.compact=function(e){return _.filter(e,_.identity)};var N=function(e,t,n){return t&&_.every(e,_.isArray)?l.apply(n,e):(A(e,function(e){_.isArray(e)||_.isArguments(e)?t?u.apply(n,e):N(e,t,n):n.push(e)}),n)};_.flatten=function(e,t){return N(e,t,[])},_.without=function(e){return _.difference(e,c.call(arguments,1))},_.uniq=_.unique=function(e,t,n,r){_.isFunction(t)&&(r=n,n=t,t=!1);var i=n?_.map(e,n,r):e,o=[],s=[];return A(i,function(n,r){(t?r&&s[s.length-1]===n:_.contains(s,n))||(s.push(n),o.push(e[r]))}),o},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(e){var t=c.call(arguments,1);return _.filter(_.uniq(e),function(e){return _.every(t,function(t){return _.indexOf(t,e)>=0})})},_.difference=function(e){var t=l.apply(o,c.call(arguments,1));return _.filter(e,function(e){return!_.contains(t,e)})},_.zip=function(){for(var e=_.max(_.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=_.pluck(arguments,""+n);return t},_.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},_.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=_.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(x&&e.indexOf===x)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},_.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},_.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,o=new Array(r);r>i;)o[i++]=e,e+=n;return o};var T=function(){};_.bind=function(e,t){var n,r;if(E&&e.bind===E)return E.apply(e,c.call(arguments,1));if(!_.isFunction(e))throw new TypeError;return n=c.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(t,n.concat(c.call(arguments)));T.prototype=e.prototype;var i=new T;T.prototype=null;var o=e.apply(i,n.concat(c.call(arguments)));return Object(o)===o?o:i}},_.partial=function(e){var t=c.call(arguments,1);return function(){return e.apply(this,t.concat(c.call(arguments)))}},_.bindAll=function(e){var t=c.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){e[t]=_.bind(e[t],e)}),e},_.memoize=function(e,t){var n={};return t||(t=_.identity),function(){var r=t.apply(this,arguments);return _.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},_.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},_.defer=function(e){return _.delay.apply(_,[e,1].concat(c.call(arguments,1)))},_.throttle=function(e,t,n){var r,i,o,s=null,a=0;n||(n={});var u=function(){a=n.leading===!1?0:new Date,s=null,o=e.apply(r,i)};return function(){var c=new Date;a||n.leading!==!1||(a=c);var l=t-(c-a);return r=this,i=arguments,0>=l?(clearTimeout(s),s=null,a=c,o=e.apply(r,i)):s||n.trailing===!1||(s=setTimeout(u,l)),o}},_.debounce=function(e,t,n){var r,i,o,s,a;return function(){o=this,i=arguments,s=new Date;var u=function(){var c=new Date-s;t>c?r=setTimeout(u,t-c):(r=null,n||(a=e.apply(o,i)))},c=n&&!r;return r||(r=setTimeout(u,t)),c&&(a=e.apply(o,i)),a}},_.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},_.wrap=function(e,t){return function(){var n=[e];return u.apply(n,arguments),t.apply(this,n)}},_.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},_.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},_.keys=j||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)_.has(e,n)&&t.push(n);return t},_.values=function(e){for(var t=_.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=e[t[i]];return r},_.pairs=function(e){for(var t=_.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=[t[i],e[t[i]]];return r},_.invert=function(e){for(var t={},n=_.keys(e),r=0,i=n.length;i>r;r++)t[e[n[r]]]=n[r];return t},_.functions=_.methods=function(e){var t=[];for(var n in e)_.isFunction(e[n])&&t.push(n);return t.sort()},_.extend=function(e){return A(c.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},_.pick=function(e){var t={},n=l.apply(o,c.call(arguments,1));return A(n,function(n){n in e&&(t[n]=e[n])}),t},_.omit=function(e){var t={},n=l.apply(o,c.call(arguments,1));for(var r in e)_.contains(n,r)||(t[r]=e[r]);return t},_.defaults=function(e){return A(c.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},_.clone=function(e){return _.isObject(e)?_.isArray(e)?e.slice():_.extend({},e):e},_.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof _&&(e=e._wrapped),t instanceof _&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return r[o]==t;var s=e.constructor,a=t.constructor;if(s!==a&&!(_.isFunction(s)&&s instanceof s&&_.isFunction(a)&&a instanceof a))return!1;n.push(e),r.push(t);var u=0,c=!0;if("[object Array]"==i){if(u=e.length,c=u==t.length)for(;u--&&(c=M(e[u],t[u],n,r)););}else{for(var l in e)if(_.has(e,l)&&(u++,!(c=_.has(t,l)&&M(e[l],t[l],n,r))))break;if(c){for(l in t)if(_.has(t,l)&&!u--)break;c=!u}}return n.pop(),r.pop(),c};_.isEqual=function(e,t){return M(e,t,[],[])},_.isEmpty=function(e){if(null==e)return!0;if(_.isArray(e)||_.isString(e))return 0===e.length;for(var t in e)if(_.has(e,t))return!1;return!0},_.isElement=function(e){return!(!e||1!==e.nodeType)},_.isArray=S||function(e){return"[object Array]"==f.call(e)},_.isObject=function(e){return e===Object(e)},A(["Arguments","Function","String","Number","Date","RegExp"],function(e){_["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),_.isArguments(arguments)||(_.isArguments=function(e){return!(!e||!_.has(e,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(e){return"function"==typeof e}),_.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},_.isNaN=function(e){return _.isNumber(e)&&e!=+e},_.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},_.isNull=function(e){return null===e},_.isUndefined=function(e){return void 0===e},_.has=function(e,t){return p.call(e,t)},_.noConflict=function(){return e._=r,this},_.identity=function(e){return e},_.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;e>i;i++)r[i]=t.call(n,i);return r},_.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var q={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};q.unescape=_.invert(q.escape);var R={escape:new RegExp("["+_.keys(q.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(q.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(e){_[e]=function(t){return null==t?"":(""+t).replace(R[e],function(t){return q[e][t]})}}),_.result=function(e,t){if(null==e)return void 0;var n=e[t];return _.isFunction(n)?n.call(e):n},_.mixin=function(e){A(_.functions(e),function(t){var n=_[t]=e[t];_.prototype[t]=function(){var e=[this._wrapped];return u.apply(e,arguments),F.call(this,n.apply(_,e))}})};var P=0;_.uniqueId=function(e){var t=++P+"";return e?e+t:t},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},z=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(e,t,n){var r;n=_.defaults({},n,_.templateSettings);var i=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g"),o=0,s="__p+='";e.replace(i,function(t,n,r,i,a){return s+=e.slice(o,a).replace(z,function(e){return"\\"+L[e]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(s+="';\n"+i+"\n__p+='"),o=a+t.length,t}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(n.variable||"obj","_",s)}catch(a){throw a.source=s,a}if(t)return r(t,_);var u=function(e){return r.call(this,e,_)};return u.source="function("+(n.variable||"obj")+"){\n"+s+"}",u},_.chain=function(e){return _(e).chain()};var F=function(e){return this._chain?_(e).chain():e};_.mixin(_),A(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];_.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),A(["concat","join","slice"],function(e){var t=o[e];_.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this)},{}],120:[function(e,t){function n(){this.callbacks={}}t.exports=n,n.prototype.on=function(e){var t=3===arguments.length,n=t?arguments[1]:void 0,r=t?arguments[2]:arguments[1];return r._groupName=n,(this.callbacks[e]=this.callbacks[e]||[]).push(r),this},n.prototype.once=function(e){function t(){n.off(e,t),o.apply(this,arguments)}var n=this,r=3===arguments.length,i=r?arguments[1]:void 0,o=r?arguments[2]:arguments[1];return this.on(e,i,t),this},n.prototype.releaseGroup=function(e){var t,n,r,i;for(t in this.callbacks)for(i=this.callbacks[t],n=0,r=i.length;r>n;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},n.prototype.off=function(e,t){var n,r=this.callbacks[e];return r?1===arguments.length?(delete this.callbacks[e],this):(n=r.indexOf(t),r.splice(n,1),this):this},n.prototype.emit=function(e){var t,n,r=[].slice.call(arguments,1),i=this.callbacks[e],o=this.getWildcardCallbacks(e);if(i)for(t=0,n=i.length;n>t&&i[t];++t)i[t].apply(this,r);if(o)for(t=0,n=o.length;n>t&&o[t];++t)o[t].apply(this,[e].concat(r));return this},n.prototype.getWildcardCallbacks=function(e){var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[1].length)===n[1])&&(r=r.concat(this.callbacks[t]));return r}},{}]},{},[1])(1)});